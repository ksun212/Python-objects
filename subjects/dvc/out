/home/user/thefuck-master/pre_run_biend.py:3771: DeprecationWarning: invalid escape sequence \s
  f.write('$t1 \sim_n t_2$ & ' + ' & '.join(M6C) + '\\\\ \\hline' +'\n')
/home/user/thefuck-master/pre_run_biend.py:3781: DeprecationWarning: invalid escape sequence \s
  f.write('$t1 \sim_n t_2$ & ' + ' & '.join(O6C) + '\\\\ \\hline' +'\n')
/home/user/thefuck-master/pre_run_biend.py:3805: DeprecationWarning: invalid escape sequence \ 
  f.write('$extenion\ set$ & ' + ' & '.join(EXT_SET) + '\\\\ \\hline' +'\n')
/home/user/thefuck-master/pre_run_biend.py:3806: DeprecationWarning: invalid escape sequence \ 
  f.write('$extenion\ event$ & ' + ' & '.join(EXT_EVENT) + '\\\\ \\hline' +'\n')
/home/user/thefuck-master/pre_run_biend.py:3933: DeprecationWarning: invalid escape sequence \_
  d_ = d.replace('_', '\_')
/home/user/thefuck-master/pre_run_biend.py:3944: DeprecationWarning: invalid escape sequence \s
  f.write('$t1 \sim_n t_2$ & ' + ' & '.join(M6[:10]) + '\\\\ \\hline' +'\n')
/home/user/thefuck-master/pre_run_biend.py:3954: DeprecationWarning: invalid escape sequence \s
  f.write('$t1 \sim_n t_2$ & ' + ' & '.join(M6[10:]) + '\\\\ \\hline' +'\n')
/home/user/thefuck-master/pre_run_biend.py:3966: DeprecationWarning: invalid escape sequence \s
  f.write('$t1 \sim_n t_2$ & ' + ' & '.join(M6ov[:10]) + '\\\\ \\hline' +'\n')
/home/user/thefuck-master/pre_run_biend.py:3978: DeprecationWarning: invalid escape sequence \s
  f.write('$t1 \sim_n t_2$ & ' + ' & '.join(M6ov[10:]) + '\\\\ \\hline' +'\n')
/home/user/thefuck-master/pre_run_biend.py:4100: DeprecationWarning: invalid escape sequence \_
  d_ = d.replace('_', '\_')
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dash/testing/plugin.py:92: PytestDeprecationWarning: The hookimpl pytest_addhooks uses old-style configuration options (marks or attributes).
Please use the pytest.hookimpl(tryfirst=True) decorator instead
 to configure the hooks.
 See https://docs.pytest.org/en/latest/deprecations.html#configuring-hook-specs-impls-using-markers
  @pytest.mark.tryfirst
============================= test session starts ==============================
platform linux -- Python 3.9.15+, pytest-7.2.0, pluggy-1.0.0
rootdir: /home/user/dvc, configfile: pyproject.toml
plugins: mock-3.10.0, hypothesis-6.56.4, httpbin-1.0.2, cov-4.0.0, time-machine-2.9.0, html-3.2.0, Faker-15.3.4, anyio-3.6.2, flaky-3.7.0, hydra-core-1.3.2, xdist-3.2.1, test-utils-0.0.8, lazy-fixture-0.6.3, docker-1.0.1, xonsh-0.13.4, pylama-8.4.1, dash-2.9.1
collected 2373 items

tests/func/test_add.py ss...................................s..........x [  2%]
.....................................                                    [  3%]
tests/func/test_analytics.py ......                                      [  3%]
tests/func/test_check_ignore.py .....................                    [  4%]
tests/func/test_checkout.py ..............................x............. [  6%]
........                                                                 [  6%]
tests/func/test_cli.py ...............                                   [  7%]
tests/func/test_commit.py ................                               [  8%]
tests/func/test_config.py ...................................            [  9%]
tests/func/test_data_cloud.py .XXX........F...................           [ 11%]
tests/func/test_data_ls.py .                                             [ 11%]
tests/func/test_data_status.py ...FF..F...F.....FFFFF..                  [ 12%]
tests/func/test_diff.py .........F.F.............FFFFF                   [ 13%]
tests/func/test_dvcfile.py .......................                       [ 14%]
tests/func/test_external_repo.py ..........                              [ 14%]
tests/func/test_fs.py ..                                                 [ 14%]
tests/func/test_gc.py ....................                               [ 15%]
tests/func/test_get.py ..F.................F.......F.FF                  [ 17%]
tests/func/test_get_url.py ............                                  [ 17%]
tests/func/test_ignore.py ...........................                    [ 18%]
tests/func/test_import.py ......FFF.......FFF.............F.F..F.F.FFF.. [ 20%]
.                                                                        [ 20%]
tests/func/test_import_url.py ......................                     [ 21%]
tests/func/test_init.py ............                                     [ 22%]
tests/func/test_install.py ........                                      [ 22%]
tests/func/test_lock.py ....                                             [ 22%]
tests/func/test_lockfile.py .........                                    [ 23%]
tests/func/test_ls.py ...F.F....................F.FFF.                   [ 24%]
tests/func/test_ls_url.py ......                                         [ 24%]
tests/func/test_merge_driver.py ................                         [ 25%]
tests/func/test_move.py ................                                 [ 25%]
tests/func/test_odb.py ............                                      [ 26%]
tests/func/test_remote.py ........................                       [ 27%]
tests/func/test_remove.py ........                                       [ 27%]
tests/func/test_repo.py ..                                               [ 27%]
tests/func/test_repo_index.py .......F.......                            [ 28%]
tests/func/test_repro.py ............................................... [ 30%]
.................................                                        [ 31%]
tests/func/test_repro_multistage.py .................                    [ 32%]
tests/func/test_root.py ..                                               [ 32%]
tests/func/test_run_cache.py ..........                                  [ 33%]
tests/func/test_run_multistage.py .............................          [ 34%]
tests/func/test_run_single_stage.py .................................... [ 35%]
..............                                                           [ 36%]
tests/func/test_scm.py ....                                              [ 36%]
tests/func/test_scm_context.py ......                                    [ 36%]
tests/func/test_stage.py .........................                       [ 37%]
tests/func/test_stage_load.py ............................               [ 39%]
tests/func/test_state.py ....                                            [ 39%]
tests/func/test_status.py ........                                       [ 39%]
tests/func/test_unprotect.py .                                           [ 39%]
tests/func/test_update.py F...................                           [ 40%]
tests/func/test_used_objs.py .............                               [ 41%]
tests/func/test_utils.py ...                                             [ 41%]
tests/func/test_version.py ..                                            [ 41%]
tests/func/machine/test_machine_config.py ..................             [ 42%]
tests/func/machine/test_machine_status.py .                              [ 42%]
tests/func/parsing/test_errors.py ................................       [ 43%]
tests/func/parsing/test_foreach.py ........................              [ 44%]
tests/func/parsing/test_interpolated_entry.py ...................        [ 45%]
tests/func/parsing/test_resolver.py ........................             [ 46%]
tests/func/plots/test_diff.py ..                                         [ 46%]
tests/func/plots/test_modify.py ....F                                    [ 46%]
tests/func/plots/test_show.py ..........F..........                      [ 47%]
tests/func/utils/test_hydra.py .s..s..s..............s.................. [ 49%]
..................                                                       [ 49%]
tests/func/utils/test_strict_yaml.py ....................                [ 50%]
tests/integration/test_studio_live_experiments.py ..                     [ 50%]
tests/integration/plots/test_plots.py .....                              [ 51%]
tests/integration/plots/test_repo_plots_api.py ..                        [ 51%]
tests/unit/test_analytics.py ..................                          [ 51%]
tests/unit/test_api.py ..                                                [ 51%]
tests/unit/test_collect.py .                                             [ 52%]
tests/unit/test_compare.py ..............................                [ 53%]
tests/unit/test_config.py .........                                      [ 53%]
tests/unit/test_context.py ....................                          [ 54%]
tests/unit/test_daemon.py ..                                             [ 54%]
tests/unit/test_dvcfile.py ......................                        [ 55%]
tests/unit/test_external_repo.py ...                                     [ 55%]
tests/unit/test_hashinfo.py .                                            [ 55%]
tests/unit/test_ignore.py .............................................. [ 57%]
.........                                                                [ 57%]
tests/unit/test_imports.py .                                             [ 58%]
tests/unit/test_info.py ...........                                      [ 58%]
tests/unit/test_interpolate.py ...................................       [ 59%]
tests/unit/test_lockfile.py .............                                [ 60%]
tests/unit/test_logger.py ................                               [ 61%]
tests/unit/test_metrics.py .                                             [ 61%]
tests/unit/test_params.py ..                                             [ 61%]
tests/unit/test_pathspec_math.py ........................                [ 62%]
tests/unit/test_progress.py ....                                         [ 62%]
tests/unit/test_prompt.py .                                              [ 62%]
tests/unit/test_run.py .......                                           [ 62%]
tests/unit/test_rwlock.py .......                                        [ 63%]
tests/unit/test_scm.py .                                                 [ 63%]
tests/unit/test_tabular_data.py .......................                  [ 64%]
tests/unit/test_updater.py .......................                       [ 65%]
tests/unit/cli/test_main.py .....                                        [ 65%]
tests/unit/command/test_add.py ....                                      [ 65%]
tests/unit/command/test_annotations_flags.py ...                         [ 65%]
tests/unit/command/test_cache.py .                                       [ 65%]
tests/unit/command/test_checkout.py ..                                   [ 65%]
tests/unit/command/test_compat_flag.py ......................            [ 66%]
tests/unit/command/test_config.py ....                                   [ 66%]
tests/unit/command/test_dag.py ................                          [ 67%]
tests/unit/command/test_data_ls.py ...                                   [ 67%]
tests/unit/command/test_data_status.py ............                      [ 68%]
tests/unit/command/test_data_sync.py ...                                 [ 68%]
tests/unit/command/test_diff.py ..........................               [ 69%]
tests/unit/command/test_experiments.py ................................. [ 70%]
.                                                                        [ 70%]
tests/unit/command/test_gc.py .                                          [ 70%]
tests/unit/command/test_get.py ..                                        [ 70%]
tests/unit/command/test_get_url.py .                                     [ 70%]
tests/unit/command/test_git_hook.py ...                                  [ 71%]
tests/unit/command/test_imp.py ...                                       [ 71%]
tests/unit/command/test_imp_url.py ........                              [ 71%]
tests/unit/command/test_ls_url.py ..                                     [ 71%]
tests/unit/command/test_machine.py ....................                  [ 72%]
tests/unit/command/test_metrics.py ....                                  [ 72%]
tests/unit/command/test_params.py ...                                    [ 72%]
tests/unit/command/test_plots.py ....................                    [ 73%]
tests/unit/command/test_queue.py ...........                             [ 74%]
tests/unit/command/test_repro.py ..                                      [ 74%]
tests/unit/command/test_run.py ...                                       [ 74%]
tests/unit/command/test_stage.py ....                                    [ 74%]
tests/unit/command/test_status.py ...........                            [ 74%]
tests/unit/command/test_update.py ..                                     [ 75%]
tests/unit/command/ls/test_ls.py ........                                [ 75%]
tests/unit/command/ls/test_ls_colors.py .........                        [ 75%]
tests/unit/data/db/test_local.py ...........                             [ 76%]
tests/unit/dependency/test_dependency.py .                               [ 76%]
tests/unit/dependency/test_params.py .......................             [ 77%]
tests/unit/fs/test_azure.py ....                                         [ 77%]
tests/unit/fs/test_base.py .                                             [ 77%]
tests/unit/fs/test_data.py ..............F.....F.F                       [ 78%]
tests/unit/fs/test_dvc.py ......F...FF...FF....FF..FFF                   [ 79%]
tests/unit/fs/test_dvc_info.py ......FFFF......FF.                       [ 80%]
tests/unit/fs/test_fs.py .................                               [ 81%]
tests/unit/fs/test_path.py ..............                                [ 81%]
tests/unit/fs/test_s3.py .........                                       [ 82%]
tests/unit/fs/test_tree.py ..                                            [ 82%]
tests/unit/machine/test_machine.py .....                                 [ 82%]
tests/unit/output/test_annotations.py ...                                [ 82%]
tests/unit/output/test_load.py ............                              [ 82%]
tests/unit/output/test_local.py .......                                  [ 83%]
tests/unit/output/test_output.py .......................                 [ 84%]
tests/unit/remote/test_oss.py .                                          [ 84%]
tests/unit/remote/test_remote.py ......                                  [ 84%]
tests/unit/remote/test_webdav.py ..........                              [ 84%]
tests/unit/remote/test_webhdfs.py ..                                     [ 85%]
tests/unit/render/test_convert.py ...                                    [ 85%]
tests/unit/render/test_image_converter.py ...                            [ 85%]
tests/unit/render/test_match.py ....                                     [ 85%]
tests/unit/render/test_vega_converter.py .................               [ 86%]
tests/unit/repo/test_repo.py ...........                                 [ 86%]
tests/unit/repo/test_reproduce.py ...                                    [ 86%]
tests/unit/repo/test_run.py .                                            [ 86%]
tests/unit/repo/test_scm_context.py ............................         [ 87%]
tests/unit/repo/experiments/test_executor_status.py .......              [ 88%]
tests/unit/repo/experiments/test_remove.py .                             [ 88%]
tests/unit/repo/experiments/test_show.py ....                            [ 88%]
tests/unit/repo/experiments/test_utils.py ................               [ 89%]
tests/unit/repo/experiments/queue/test_celery.py ...........             [ 89%]
tests/unit/repo/experiments/queue/test_remove.py ..                      [ 89%]
tests/unit/repo/plots/test_diff.py ........                              [ 90%]
tests/unit/scm/test_scm.py .                                             [ 90%]
tests/unit/stage/test_cache.py .........                                 [ 90%]
tests/unit/stage/test_loader_pipeline_file.py ..................         [ 91%]
tests/unit/stage/test_run.py ..                                          [ 91%]
tests/unit/stage/test_serialize_pipeline_file.py ....................    [ 92%]
tests/unit/stage/test_serialize_pipeline_lock.py ......................  [ 93%]
tests/unit/stage/test_stage.py ..........                                [ 93%]
tests/unit/stage/test_utils.py .                                         [ 93%]
tests/unit/ui/test_console.py ....                                       [ 93%]
tests/unit/ui/test_pager.py .............                                [ 94%]
tests/unit/ui/test_prompt.py ..............                              [ 94%]
tests/unit/ui/test_table.py ..............                               [ 95%]
tests/unit/utils/test_cli_parse.py ......                                [ 95%]
tests/unit/utils/test_collections.py ..................                  [ 96%]
tests/unit/utils/test_executors.py .....                                 [ 96%]
tests/unit/utils/test_fs.py .......s......s..                            [ 97%]
tests/unit/utils/test_humanize.py ....                                   [ 97%]
tests/unit/utils/test_studio.py ...                                      [ 97%]
tests/unit/utils/test_utils.py .....s...............................     [ 99%]
tests/unit/utils/serialize/test_python.py .............                  [ 99%]
tests/unit/utils/serialize/test_toml.py ...                              [ 99%]
tests/unit/utils/serialize/test_yaml.py ..                               [100%]

=================================== FAILURES ===================================
________________________ test_pull_external_dvc_imports ________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0'
scm = Git: '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.git'
erepo_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/erepo2')

    def test_pull_external_dvc_imports(tmp_dir, dvc, scm, erepo_dir):
        with erepo_dir.chdir():
            erepo_dir.dvc_gen({"dir": {"bar": "bar"}}, commit="second")
            erepo_dir.dvc_gen("foo", "foo", commit="first")
    
            os.remove("foo")
            shutil.rmtree("dir")
    
        dvc.imp(os.fspath(erepo_dir), "foo")
>       dvc.imp(os.fspath(erepo_dir), "dir", out="new_dir", rev="HEAD~")

/home/user/dvc/tests/func/test_data_cloud.py:252: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/imp.py:6: in imp
    return self.imp_url(path, out=out, fname=fname, erepo=erepo, frozen=True, **kwargs)
/home/user/dvc/dvc/repo/__init__.py:65: in wrapper
    return f(repo, *args, **kwargs)
/home/user/dvc/dvc/repo/scm_context.py:151: in run
    return method(repo, *args, **kw)
/home/user/dvc/dvc/repo/imp_url.py:91: in imp_url
    stage.run(jobs=jobs, no_download=no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:577: in run
    self._sync_import(dry, force, kwargs.get("jobs", None), no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:611: in _sync_import
    sync_import(self, dry, force, jobs, no_download)
/home/user/dvc/dvc/stage/imports.py:61: in sync_import
    stage.deps[0].download(
/home/user/dvc/dvc/dependency/repo.py:84: in download
    for odb, objs in self.get_used_objs().items():
/home/user/dvc/dvc/dependency/repo.py:111: in get_used_objs
    used, _, _ = self._get_used_and_obj(**kwargs)
/home/user/dvc/dvc/dependency/repo.py:148: in _get_used_and_obj
    object_store, meta, obj = build(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:244: in build
    meta, obj = _build_tree(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:126: in _build_tree
    for root, _, fnames in walk_iter:
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:282: in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:391: in ls
    return self.fs.ls(path, detail=detail, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14aea953d820>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:01:30,087 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo2/dir' to gitignore file.
2023-05-15 22:01:30,363 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-15 22:01:30,378 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:01:30,689 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-15 22:01:30,711 DEBUG: Preparing to transfer data from 'memory://dvc-staging/d413b6e0f50a0aea66d83049e69cd89d20fb3fac3523af02c5274bc2697b8a14' to '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache'
2023-05-15 22:01:30,727 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache'
2023-05-15 22:01:30,761 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache'
2023-05-15 22:01:30,895 DEBUG: Preparing to collect status from 'memory://dvc-staging/d413b6e0f50a0aea66d83049e69cd89d20fb3fac3523af02c5274bc2697b8a14'
2023-05-15 22:01:31,677 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-15 22:01:31,769 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:01:31,793 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo2/.CWZnZxXt2xEwTVdDb6ETWD.tmp'
2023-05-15 22:01:31,844 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo2/.CWZnZxXt2xEwTVdDb6ETWD.tmp'
2023-05-15 22:01:31,859 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache/.5BSoVqfS8tNAR2WMkYBAJ8.tmp'
2023-05-15 22:01:31,884 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo2/dir/bar'
2023-05-15 22:01:32,093 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:01:34,140 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo2/foo' to gitignore file.
2023-05-15 22:01:34,258 DEBUG: Computed stage: 'foo.dvc' md5: 'None'
2023-05-15 22:01:34,403 DEBUG: Preparing to transfer data from 'memory://dvc-staging/d413b6e0f50a0aea66d83049e69cd89d20fb3fac3523af02c5274bc2697b8a14' to '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache'
2023-05-15 22:01:34,417 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache'
2023-05-15 22:01:34,432 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache'
2023-05-15 22:01:34,550 DEBUG: Preparing to collect status from 'memory://dvc-staging/d413b6e0f50a0aea66d83049e69cd89d20fb3fac3523af02c5274bc2697b8a14'
2023-05-15 22:01:34,829 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:01:34,844 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo2/.c2KMcbKPbsDcqLfPwTthEW.tmp'
2023-05-15 22:01:34,891 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo2/.c2KMcbKPbsDcqLfPwTthEW.tmp'
2023-05-15 22:01:34,907 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache/.aYfb2rn3JfTGM3wZKDmBuj.tmp'
2023-05-15 22:01:34,931 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo2/foo'
2023-05-15 22:01:35,107 DEBUG: Saving information to 'foo.dvc'.

To track the changes with git, run:

	git add .gitignore foo.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:01:36,571 DEBUG: Removing output 'foo' of stage: 'foo.dvc'.
2023-05-15 22:01:36,599 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/foo'
Importing 'foo (/tmp/pytest-of-user/pytest-384/erepo2)' -> 'foo'
2023-05-15 22:01:36,789 DEBUG: Computed stage: 'foo.dvc' md5: '80d68eda2cd5376cc765d09cc02b7eee'
2023-05-15 22:01:36,803 DEBUG: 'md5' of stage: 'foo.dvc' changed.
2023-05-15 22:01:36,826 DEBUG: Creating external repo /tmp/pytest-of-user/pytest-384/erepo2@None
2023-05-15 22:01:36,879 DEBUG: erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo2' to a temporary dir
2023-05-15 22:01:39,161 DEBUG: Checking if stage '/foo' is in 'dvc.yaml'
2023-05-15 22:01:39,876 DEBUG: Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache' to '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache'
2023-05-15 22:01:39,888 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache'
2023-05-15 22:01:39,900 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache'
2023-05-15 22:01:39,991 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache'
2023-05-15 22:01:40,003 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache'
2023-05-15 22:01:40,550 DEBUG: Preparing to transfer data from 'memory://dvc-staging/d6ce690424b2385706bd7a51d291c0f47ff8f657511a73eb43339275550b7699' to '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache'
2023-05-15 22:01:40,566 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache'
2023-05-15 22:01:40,580 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache'
2023-05-15 22:01:40,688 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:01:40,704 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.Q6UMazWPMoeSLtsircsCno.tmp'
2023-05-15 22:01:40,748 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.Q6UMazWPMoeSLtsircsCno.tmp'
2023-05-15 22:01:40,758 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache/.gasr9uwoQCs4bAWy4JseUy.tmp'
2023-05-15 22:01:40,974 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/foo' to gitignore file.
2023-05-15 22:01:41,080 DEBUG: Computed stage: 'foo.dvc' md5: '0719981da1d2e4b6e51d3e7ce8663b6c'
2023-05-15 22:01:41,240 DEBUG: Preparing to transfer data from 'memory://dvc-staging/d6ce690424b2385706bd7a51d291c0f47ff8f657511a73eb43339275550b7699' to '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache'
2023-05-15 22:01:41,256 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache'
2023-05-15 22:01:41,269 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache'
2023-05-15 22:01:41,427 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:01:41,444 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.Gd6QyDy7CgvXa4GUDRm5ft.tmp'
2023-05-15 22:01:41,497 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.Gd6QyDy7CgvXa4GUDRm5ft.tmp'
2023-05-15 22:01:41,511 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache/.9BhBAVuhvdCeXs5yL4oN4r.tmp'
2023-05-15 22:01:41,531 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/foo'
2023-05-15 22:01:41,765 DEBUG: Saving information to 'foo.dvc'.

To track the changes with git, run:

	git add .gitignore foo.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:01:43,248 DEBUG: Removing output 'new_dir' of stage: 'new_dir.dvc'.
2023-05-15 22:01:43,277 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/new_dir'
Importing 'dir (/tmp/pytest-of-user/pytest-384/erepo2)' -> 'new_dir'
2023-05-15 22:01:43,453 DEBUG: Computed stage: 'new_dir.dvc' md5: '67ddb9d79b0f7f1203942ef4921e27c1'
2023-05-15 22:01:43,463 DEBUG: 'md5' of stage: 'new_dir.dvc' changed.
2023-05-15 22:01:43,481 DEBUG: Creating external repo /tmp/pytest-of-user/pytest-384/erepo2@HEAD~
2023-05-15 22:01:43,524 DEBUG: erepo: git pull '/tmp/pytest-of-user/pytest-384/erepo2'
2023-05-15 22:01:45,256 DEBUG: Checking if stage '/dir' is in 'dvc.yaml'
2023-05-15 22:01:45,573 DEBUG: Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache' to '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache'
2023-05-15 22:01:45,584 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache'
2023-05-15 22:01:45,599 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache'
2023-05-15 22:01:45,698 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache'
2023-05-15 22:01:45,711 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache'
2023-05-15 22:01:45,788 DEBUG: Querying 1 oids via object_exists
2023-05-15 22:01:45,882 DEBUG: Indexing new .dir '91aaa9bb58b657d623ef143b195a67e4.dir' with '1' nested files
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  4.37file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.41file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.41file/s][A

![A[A

  0%|          |memory://.UJBA4H97LmdrocuHchVoRZ.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.UJBA4H97LmdrocuHchVoRZ0.00/63.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  5.91file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.29s/file]100% Adding...|██████████|1/1 [00:02,  2.32s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.71file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
                                                                                [A100% Adding...|██████████|1/1 [00:01<00:00,  1.20s/file]100% Adding...|██████████|1/1 [00:01,  1.23s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Cloning erepo2|          |0.00/? [00:00,      ?obj/s]                                                     !  0% |          |0/? [00:00<?,    ?files/s]                                           !  0% |          |0/? [00:00<?,    ?files/s]                                           !  0% Transferring|          |0/? [00:00<?,     ?file/s]  0% Transferring|          |0/1 [00:00<?,     ?file/s]
![A
  0%|          |/tmp/pytest-of-user/pytest-384/erep0.00/? [00:00<?,        ?B/s][A
  0%|          |/tmp/pytest-of-user/pytest-384/e0.00/3.00 [00:00<?,        ?B/s][A
                                                                                [A100% Transferring|██████████|1/1 [00:00<00:00,  2.78file/s]                                                           !  0% |          |0/? [00:00<?,    ?files/s]                                           !  0% |          |0/? [00:00<?,    ?files/s]                                           !If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !  0% |          |0/? [00:00<?,    ?files/s]                                           !  0% Querying remote cache|          |0/1 [00:00<?,    ?files/s]                                                                !  0% Transferring|          |0/? [00:00<?,     ?file/s]  0% Transferring|          |0/1 [00:00<?,     ?file/s]
![A
  0%|          |/tmp/pytest-of-user/pytest-384/erep0.00/? [00:00<?,        ?B/s][A
  0%|          |/tmp/pytest-of-user/pytest-384/e0.00/63.0 [00:00<?,        ?B/s][A
                                                                                [A100% Transferring|██████████|1/1 [00:00<00:00,  4.64file/s]                                                           !Building data objects from dir          |0.00 [00:00,      ?obj/s]                                                                  
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo2/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/d413b6e0f50a0aea66d83049e69cd89d20fb3fac3523af02c5274bc2697b8a14' to '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/d413b6e0f50a0aea66d83049e69cd89d20fb3fac3523af02c5274bc2697b8a14'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo2/.CWZnZxXt2xEwTVdDb6ETWD.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo2/.CWZnZxXt2xEwTVdDb6ETWD.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache/.5BSoVqfS8tNAR2WMkYBAJ8.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo2/dir/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo2/foo' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'foo.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/d413b6e0f50a0aea66d83049e69cd89d20fb3fac3523af02c5274bc2697b8a14' to '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/d413b6e0f50a0aea66d83049e69cd89d20fb3fac3523af02c5274bc2697b8a14'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo2/.c2KMcbKPbsDcqLfPwTthEW.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo2/.c2KMcbKPbsDcqLfPwTthEW.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache/.aYfb2rn3JfTGM3wZKDmBuj.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo2/foo'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'foo.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore foo.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.stage:__init__.py:387 Removing output 'foo' of stage: 'foo.dvc'.
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/foo'
INFO     dvc.stage.imports:imports.py:49 Importing 'foo (/tmp/pytest-of-user/pytest-384/erepo2)' -> 'foo'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'foo.dvc' md5: '80d68eda2cd5376cc765d09cc02b7eee'
DEBUG    dvc.stage:__init__.py:363 'md5' of stage: 'foo.dvc' changed.
DEBUG    dvc.external_repo:external_repo.py:33 Creating external repo /tmp/pytest-of-user/pytest-384/erepo2@None
DEBUG    dvc.external_repo:external_repo.py:195 erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo2' to a temporary dir
DEBUG    scmrepo.git.backend.pygit2:pygit2.py:505 fetch_refspecs: []
DEBUG    dvc.repo.stage:stage.py:80 Checking if stage '/foo' is in 'dvc.yaml'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache' to '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/d6ce690424b2385706bd7a51d291c0f47ff8f657511a73eb43339275550b7699' to '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.Q6UMazWPMoeSLtsircsCno.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.Q6UMazWPMoeSLtsircsCno.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache/.gasr9uwoQCs4bAWy4JseUy.tmp'
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/foo' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'foo.dvc' md5: '0719981da1d2e4b6e51d3e7ce8663b6c'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/d6ce690424b2385706bd7a51d291c0f47ff8f657511a73eb43339275550b7699' to '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.Gd6QyDy7CgvXa4GUDRm5ft.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.Gd6QyDy7CgvXa4GUDRm5ft.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache/.9BhBAVuhvdCeXs5yL4oN4r.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/foo'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'foo.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore foo.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.stage:__init__.py:387 Removing output 'new_dir' of stage: 'new_dir.dvc'.
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/new_dir'
INFO     dvc.stage.imports:imports.py:49 Importing 'dir (/tmp/pytest-of-user/pytest-384/erepo2)' -> 'new_dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'new_dir.dvc' md5: '67ddb9d79b0f7f1203942ef4921e27c1'
DEBUG    dvc.stage:__init__.py:363 'md5' of stage: 'new_dir.dvc' changed.
DEBUG    dvc.external_repo:external_repo.py:33 Creating external repo /tmp/pytest-of-user/pytest-384/erepo2@HEAD~
DEBUG    dvc.external_repo:external_repo.py:190 erepo: git pull '/tmp/pytest-of-user/pytest-384/erepo2'
DEBUG    scmrepo.git.backend.pygit2:pygit2.py:505 fetch_refspecs: []
DEBUG    dvc.repo.stage:stage.py:80 Checking if stage '/dir' is in 'dvc.yaml'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache' to '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_pull_external_dvc_imports0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo2/.dvc/cache'
DEBUG    dvc_objects.db:db.py:349 Querying 1 oids via object_exists
DEBUG    dvc_data.hashfile.status:status.py:73 Indexing new .dir '91aaa9bb58b657d623ef143b195a67e4.dir' with '1' nested files
________________________________ test_directory ________________________________

M = <class 'pytest_test_utils.matchers.Matcher'>
tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_directory0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_directory0'
scm = Git: '/tmp/pytest-of-user/pytest-384/test_directory0/.git'

    def test_directory(M, tmp_dir, dvc, scm):
        tmp_dir.dvc_gen({"dir": {"foo": "foo"}}, commit="add dir")
        tmp_dir.dvc_gen({"dir": {"foo": "foo", "bar": "bar", "foobar": "foobar"}})
        remove(tmp_dir / "dir")
        (tmp_dir / "dir").gen({"foo": "foo", "bar": "barr", "baz": "baz"})
        tmp_dir.gen("untracked", "untracked")
    
        assert dvc.data_status() == {
            **EMPTY_STATUS,
            "committed": {"modified": [join("dir", "")]},
            "uncommitted": {"modified": [join("dir", "")]},
            "git": M.dict(),
        }
    
>       assert dvc.data_status(granular=True, untracked_files="all") == {
            **EMPTY_STATUS,
            "committed": {
                "added": M.unordered(
                    join("dir", "bar"),
                    join("dir", "foobar"),
                ),
                "modified": [join("dir", "")],
            },
            "uncommitted": {
                "added": [join("dir", "baz")],
                "modified": M.unordered(join("dir", ""), join("dir", "bar")),
                "deleted": [join("dir", "foobar")],
            },
            "git": M.dict(),
            "not_in_cache": [],
            "unchanged": [join("dir", "foo")],
            "untracked": ["untracked"],
        }

/home/user/dvc/tests/func/test_data_status.py:84: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/data.py:229: in status
    uncommitted_diff = _diff_index_to_wtree(
/home/user/dvc/dvc/repo/data.py:171: in _diff_index_to_wtree
    return _diff(
/home/user/dvc/dvc/repo/data.py:77: in _diff
    for change in diff(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:288: in diff
    yield from changes
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:165: in _diff
    old_items, old_unknown = _get_items(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:140: in _get_items
    items = dict(index.ls(key, detail=True))
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ae22ad9dc0>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:08:08,211 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_directory0/dir' to gitignore file.
2023-05-15 22:08:08,482 DEBUG: built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
2023-05-15 22:08:08,495 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:08:08,802 DEBUG: built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
2023-05-15 22:08:08,820 DEBUG: Preparing to transfer data from 'memory://dvc-staging/489f2f04f922809e381f3c1e07ee5aea9505abb931bf3da36a230547c32a9ff8' to '/tmp/pytest-of-user/pytest-384/test_directory0/.dvc/cache'
2023-05-15 22:08:08,832 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_directory0/.dvc/cache'
2023-05-15 22:08:08,866 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_directory0/.dvc/cache'
2023-05-15 22:08:09,022 DEBUG: Preparing to collect status from 'memory://dvc-staging/489f2f04f922809e381f3c1e07ee5aea9505abb931bf3da36a230547c32a9ff8'
2023-05-15 22:08:09,774 DEBUG: built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
2023-05-15 22:08:09,820 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:08:09,836 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directory0/.9tztVEJ7SFgbhJE7rmtoq3.tmp'
2023-05-15 22:08:09,882 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directory0/.9tztVEJ7SFgbhJE7rmtoq3.tmp'
2023-05-15 22:08:09,898 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directory0/.dvc/cache/.S4tqGBynaSFwUvZMosGSFo.tmp'
2023-05-15 22:08:09,920 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directory0/dir/foo'
2023-05-15 22:08:10,118 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:08:12,813 DEBUG: built tree 'object a5beca056acbef9e0013347efdc2b751.dir'
2023-05-15 22:08:12,827 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:08:13,219 DEBUG: built tree 'object a5beca056acbef9e0013347efdc2b751.dir'
2023-05-15 22:08:13,233 DEBUG: Preparing to transfer data from 'memory://dvc-staging/489f2f04f922809e381f3c1e07ee5aea9505abb931bf3da36a230547c32a9ff8' to '/tmp/pytest-of-user/pytest-384/test_directory0/.dvc/cache'
2023-05-15 22:08:13,245 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_directory0/.dvc/cache'
2023-05-15 22:08:13,290 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_directory0/.dvc/cache'
2023-05-15 22:08:13,455 DEBUG: Preparing to collect status from 'memory://dvc-staging/489f2f04f922809e381f3c1e07ee5aea9505abb931bf3da36a230547c32a9ff8'
2023-05-15 22:08:14,864 DEBUG: built tree 'object a5beca056acbef9e0013347efdc2b751.dir'
2023-05-15 22:08:14,936 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:08:14,952 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directory0/.TZSiLsFDojxbxpiMz3qNhr.tmp'
2023-05-15 22:08:15,008 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directory0/.TZSiLsFDojxbxpiMz3qNhr.tmp'
2023-05-15 22:08:15,023 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directory0/.dvc/cache/.8wyEdmuKWbZRr6ueK7EzRr.tmp'
2023-05-15 22:08:15,055 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directory0/dir/foo'
2023-05-15 22:08:15,133 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directory0/dir/bar'
2023-05-15 22:08:15,216 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directory0/dir/foobar'
2023-05-15 22:08:15,423 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:08:15,942 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directory0/dir'
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.65file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.71file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.71file/s][A

![A[A

  0%|          |memory://.8YkPhXjqF56rLKvVhrZ8M6.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.8YkPhXjqF56rLKvVhrZ8M60.00/63.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  6.13file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.16s/file]100% Adding...|██████████|1/1 [00:02,  2.19s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  2.75file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |2.00 [00:00,   15.6obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/2 [00:00<?,     ?file/s][A
 50%|█████     |Transferring                      1/2 [00:00<00:00,  8.56file/s][A
  0%|          |Transferring                      2/? [00:00<00:00,  9.22file/s][A
  0%|          |Transferring                      2/? [00:00<00:00,  9.22file/s][A

![A[A

  0%|          |memory://.EwN6tFWaHWWcCZCaNBRAiX.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.EwN6tFWaHWWcCZCaNBRAiX.0.00/192 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      3/? [00:00<00:00,  6.17file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:03<00:00,  3.75s/file]100% Adding...|██████████|1/1 [00:03,  3.78s/file]      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_directory0/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/489f2f04f922809e381f3c1e07ee5aea9505abb931bf3da36a230547c32a9ff8' to '/tmp/pytest-of-user/pytest-384/test_directory0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_directory0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_directory0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/489f2f04f922809e381f3c1e07ee5aea9505abb931bf3da36a230547c32a9ff8'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directory0/.9tztVEJ7SFgbhJE7rmtoq3.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directory0/.9tztVEJ7SFgbhJE7rmtoq3.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directory0/.dvc/cache/.S4tqGBynaSFwUvZMosGSFo.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directory0/dir/foo'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object a5beca056acbef9e0013347efdc2b751.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object a5beca056acbef9e0013347efdc2b751.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/489f2f04f922809e381f3c1e07ee5aea9505abb931bf3da36a230547c32a9ff8' to '/tmp/pytest-of-user/pytest-384/test_directory0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_directory0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_directory0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/489f2f04f922809e381f3c1e07ee5aea9505abb931bf3da36a230547c32a9ff8'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object a5beca056acbef9e0013347efdc2b751.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directory0/.TZSiLsFDojxbxpiMz3qNhr.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directory0/.TZSiLsFDojxbxpiMz3qNhr.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directory0/.dvc/cache/.8wyEdmuKWbZRr6ueK7EzRr.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directory0/dir/foo'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directory0/dir/bar'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directory0/dir/foobar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.utils.fs:fs.py:63 Removing '/tmp/pytest-of-user/pytest-384/test_directory0/dir'
_________________________ test_tracked_directory_deep __________________________

M = <class 'pytest_test_utils.matchers.Matcher'>
tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0'
scm = Git: '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/.git'

    def test_tracked_directory_deep(M, tmp_dir, dvc, scm):
        """Test for a directory not in cwd, but nested inside other directories."""
        (tmp_dir / "sub").gen({"dir": {"foo": "foo"}})
        dvc.add(fspath(tmp_dir / "sub" / "dir"))
        scm.add_commit(["sub/dir.dvc", "sub/.gitignore"], message="add sub/dir")
    
        (tmp_dir / "sub" / "dir").gen("bar", "bar")
        dvc.commit(None, force=True)
        (tmp_dir / "sub" / "dir").gen("foobar", "foobar")
    
        assert dvc.data_status() == {
            **EMPTY_STATUS,
            "committed": {"modified": [join("sub", "dir", "")]},
            "uncommitted": {"modified": [join("sub", "dir", "")]},
            "git": M.dict(),
        }
>       assert dvc.data_status(granular=True, untracked_files="all") == {
            **EMPTY_STATUS,
            "committed": {
                "added": [join("sub", "dir", "bar")],
                "modified": [join("sub", "dir", "")],
            },
            "uncommitted": {
                "added": [join("sub", "dir", "foobar")],
                "modified": [join("sub", "dir", "")],
            },
            "git": M.dict(),
            "unchanged": [join("sub", "dir", "foo")],
        }

/home/user/dvc/tests/func/test_data_status.py:121: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/data.py:229: in status
    uncommitted_diff = _diff_index_to_wtree(
/home/user/dvc/dvc/repo/data.py:171: in _diff_index_to_wtree
    return _diff(
/home/user/dvc/dvc/repo/data.py:77: in _diff
    for change in diff(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:288: in diff
    yield from changes
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:165: in _diff
    old_items, old_unknown = _get_items(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:140: in _get_items
    items = dict(index.ls(key, detail=True))
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ae23cba4b0>
key = ('sub', 'dir')

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:08:24,437 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/sub/dir' to gitignore file.
2023-05-15 22:08:24,701 DEBUG: built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
2023-05-15 22:08:24,715 DEBUG: Computed stage: 'sub/dir.dvc' md5: 'None'
2023-05-15 22:08:25,032 DEBUG: built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
2023-05-15 22:08:25,047 DEBUG: Preparing to transfer data from 'memory://dvc-staging/b5b2ae91244e1d9e815171d8f9107eecf8d4bde7665d8ea2c440195a4107c7ca' to '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/.dvc/cache'
2023-05-15 22:08:25,057 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/.dvc/cache'
2023-05-15 22:08:25,091 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/.dvc/cache'
2023-05-15 22:08:25,264 DEBUG: Preparing to collect status from 'memory://dvc-staging/b5b2ae91244e1d9e815171d8f9107eecf8d4bde7665d8ea2c440195a4107c7ca'
2023-05-15 22:08:25,996 DEBUG: built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
2023-05-15 22:08:26,040 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:08:26,052 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/sub/.MkTXc3ooeJixg2rqDpZ8i6.tmp'
2023-05-15 22:08:26,095 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/sub/.MkTXc3ooeJixg2rqDpZ8i6.tmp'
2023-05-15 22:08:26,110 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/.dvc/cache/.7GQodEyRJZgRa6BTg5N7jE.tmp'
2023-05-15 22:08:26,127 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/sub/dir/foo'
2023-05-15 22:08:26,335 DEBUG: Saving information to 'sub/dir.dvc'.

To track the changes with git, run:

	git add sub/dir.dvc sub/.gitignore

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:08:28,616 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-15 22:08:28,636 DEBUG: Computed stage: 'sub/dir.dvc' md5: 'None'
2023-05-15 22:08:28,999 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-15 22:08:29,017 DEBUG: Preparing to transfer data from 'memory://dvc-staging/b5b2ae91244e1d9e815171d8f9107eecf8d4bde7665d8ea2c440195a4107c7ca' to '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/.dvc/cache'
2023-05-15 22:08:29,028 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/.dvc/cache'
2023-05-15 22:08:29,080 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/.dvc/cache'
2023-05-15 22:08:29,228 DEBUG: Preparing to collect status from 'memory://dvc-staging/b5b2ae91244e1d9e815171d8f9107eecf8d4bde7665d8ea2c440195a4107c7ca'
2023-05-15 22:08:29,990 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-15 22:08:30,044 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:08:30,056 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/sub/.gTf7j3SuonXPU2QSpyvSvF.tmp'
2023-05-15 22:08:30,107 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/sub/.gTf7j3SuonXPU2QSpyvSvF.tmp'
2023-05-15 22:08:30,121 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/.dvc/cache/.3KpTEj5VSRvuuUMx2e7DZw.tmp'
2023-05-15 22:08:30,142 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/sub/dir/foo'
2023-05-15 22:08:30,218 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/sub/dir/bar'
2023-05-15 22:08:30,425 DEBUG: Saving information to 'sub/dir.dvc'.
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  2.53file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from sub/dir          |0.00 [00:00,      ?obj/s][A
                                                                      [A
![A
Building data objects from sub/dir          |0.00 [00:00,      ?obj/s][A
                                                                      [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.61file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.61file/s][A

![A[A

  0%|          |memory://.7RAtyCmhMui4dy3fABsVma.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.7RAtyCmhMui4dy3fABsVma0.00/63.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  6.69file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from sub/dir          |0.00 [00:00,      ?obj/s][A
                                                                      [A100% Adding...|██████████|1/1 [00:02<00:00,  2.17s/file]100% Adding...|██████████|1/1 [00:02,  2.20s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Building data objects from sub/dir          |0.00 [00:00,      ?obj/s]                                                                      !Building data objects from sub/dir          |0.00 [00:00,      ?obj/s]                                                                      !  0% |          |0/? [00:00<?,    ?files/s]                                           !  0% Transferring|          |0/? [00:00<?,     ?file/s]  0% Transferring|          |0/1 [00:00<?,     ?file/s]100% Transferring|██████████|1/1 [00:00<00:00, 10.17file/s]
![A
  0%|          |memory://.nGz8AbkVzrbvShFaLcHcxM.tm0.00/? [00:00<?,        ?B/s][A
  0%|          |memory://.nGz8AbkVzrbvShFaLcHcxM.0.00/126 [00:00<?,        ?B/s][A  0% Transferring|          |2/? [00:00<00:00,  7.31file/s]
                                                                                [A                                                           !Building data objects from sub/dir          |0.00 [00:00,      ?obj/s]                                                                      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/sub/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'sub/dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/b5b2ae91244e1d9e815171d8f9107eecf8d4bde7665d8ea2c440195a4107c7ca' to '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/b5b2ae91244e1d9e815171d8f9107eecf8d4bde7665d8ea2c440195a4107c7ca'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/sub/.MkTXc3ooeJixg2rqDpZ8i6.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/sub/.MkTXc3ooeJixg2rqDpZ8i6.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/.dvc/cache/.7GQodEyRJZgRa6BTg5N7jE.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/sub/dir/foo'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'sub/dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add sub/dir.dvc sub/.gitignore
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'sub/dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/b5b2ae91244e1d9e815171d8f9107eecf8d4bde7665d8ea2c440195a4107c7ca' to '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/b5b2ae91244e1d9e815171d8f9107eecf8d4bde7665d8ea2c440195a4107c7ca'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/sub/.gTf7j3SuonXPU2QSpyvSvF.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/sub/.gTf7j3SuonXPU2QSpyvSvF.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/.dvc/cache/.3KpTEj5VSRvuuUMx2e7DZw.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/sub/dir/foo'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_tracked_directory_deep0/sub/dir/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'sub/dir.dvc'.
________________________________ test_unchanged ________________________________

M = <class 'pytest_test_utils.matchers.Matcher'>
tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_unchanged0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_unchanged0'
scm = Git: '/tmp/pytest-of-user/pytest-384/test_unchanged0/.git'

    def test_unchanged(M, tmp_dir, dvc, scm):
        tmp_dir.dvc_gen({"dir": {"foo": "foo"}}, commit="add dir")
        tmp_dir.dvc_gen("bar", "bar", commit="add foo")
    
        assert dvc.data_status() == {
            **EMPTY_STATUS,
            "git": M.dict(),
            "unchanged": M.unordered("bar", join("dir", "")),
        }
>       assert dvc.data_status(granular=True) == {
            **EMPTY_STATUS,
            "git": M.dict(),
            "unchanged": M.unordered("bar", join("dir", ""), join("dir", "foo")),
        }

/home/user/dvc/tests/func/test_data_status.py:160: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/data.py:229: in status
    uncommitted_diff = _diff_index_to_wtree(
/home/user/dvc/dvc/repo/data.py:171: in _diff_index_to_wtree
    return _diff(
/home/user/dvc/dvc/repo/data.py:77: in _diff
    for change in diff(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:288: in diff
    yield from changes
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:165: in _diff
    old_items, old_unknown = _get_items(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:140: in _get_items
    items = dict(index.ls(key, detail=True))
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ae1dc75410>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:08:42,812 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_unchanged0/dir' to gitignore file.
2023-05-15 22:08:43,078 DEBUG: built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
2023-05-15 22:08:43,093 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:08:43,383 DEBUG: built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
2023-05-15 22:08:43,402 DEBUG: Preparing to transfer data from 'memory://dvc-staging/78bb9734202e46d63e3836399a135949df0908d92252ab3d18f7c5eb16a170d5' to '/tmp/pytest-of-user/pytest-384/test_unchanged0/.dvc/cache'
2023-05-15 22:08:43,419 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_unchanged0/.dvc/cache'
2023-05-15 22:08:43,451 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_unchanged0/.dvc/cache'
2023-05-15 22:08:43,604 DEBUG: Preparing to collect status from 'memory://dvc-staging/78bb9734202e46d63e3836399a135949df0908d92252ab3d18f7c5eb16a170d5'
2023-05-15 22:08:44,307 DEBUG: built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
2023-05-15 22:08:44,343 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:08:44,358 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_unchanged0/.T3r7QEqAr4dHJTKZT7VZ8A.tmp'
2023-05-15 22:08:44,404 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_unchanged0/.T3r7QEqAr4dHJTKZT7VZ8A.tmp'
2023-05-15 22:08:44,419 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_unchanged0/.dvc/cache/.75zAmCifDq32RQDorfFdKE.tmp'
2023-05-15 22:08:44,441 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_unchanged0/dir/foo'
2023-05-15 22:08:44,636 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:08:46,878 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_unchanged0/bar' to gitignore file.
2023-05-15 22:08:46,987 DEBUG: Computed stage: 'bar.dvc' md5: 'None'
2023-05-15 22:08:47,119 DEBUG: Preparing to transfer data from 'memory://dvc-staging/78bb9734202e46d63e3836399a135949df0908d92252ab3d18f7c5eb16a170d5' to '/tmp/pytest-of-user/pytest-384/test_unchanged0/.dvc/cache'
2023-05-15 22:08:47,130 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_unchanged0/.dvc/cache'
2023-05-15 22:08:47,143 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_unchanged0/.dvc/cache'
2023-05-15 22:08:47,268 DEBUG: Preparing to collect status from 'memory://dvc-staging/78bb9734202e46d63e3836399a135949df0908d92252ab3d18f7c5eb16a170d5'
2023-05-15 22:08:47,507 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:08:47,520 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_unchanged0/.EiaUugVg4WUik2Mtpi5oVu.tmp'
2023-05-15 22:08:47,565 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_unchanged0/.EiaUugVg4WUik2Mtpi5oVu.tmp'
2023-05-15 22:08:47,581 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_unchanged0/.dvc/cache/.HhhdKFoNgF47N8ZDaRuhkX.tmp'
2023-05-15 22:08:47,602 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_unchanged0/bar'
2023-05-15 22:08:47,774 DEBUG: Saving information to 'bar.dvc'.

To track the changes with git, run:

	git add .gitignore bar.dvc

To enable auto staging, run:

	dvc config core.autostage true
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  4.11file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.80file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.80file/s][A

![A[A

  0%|          |memory://.8GKxy8NCDR88jQAgbpwkej.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.8GKxy8NCDR88jQAgbpwkej0.00/63.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  6.32file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.07s/file]100% Adding...|██████████|1/1 [00:02,  2.10s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.69file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
                                                                                [A100% Adding...|██████████|1/1 [00:01<00:00,  1.12s/file]100% Adding...|██████████|1/1 [00:01,  1.15s/file]      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_unchanged0/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/78bb9734202e46d63e3836399a135949df0908d92252ab3d18f7c5eb16a170d5' to '/tmp/pytest-of-user/pytest-384/test_unchanged0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_unchanged0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_unchanged0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/78bb9734202e46d63e3836399a135949df0908d92252ab3d18f7c5eb16a170d5'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_unchanged0/.T3r7QEqAr4dHJTKZT7VZ8A.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_unchanged0/.T3r7QEqAr4dHJTKZT7VZ8A.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_unchanged0/.dvc/cache/.75zAmCifDq32RQDorfFdKE.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_unchanged0/dir/foo'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_unchanged0/bar' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'bar.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/78bb9734202e46d63e3836399a135949df0908d92252ab3d18f7c5eb16a170d5' to '/tmp/pytest-of-user/pytest-384/test_unchanged0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_unchanged0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_unchanged0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/78bb9734202e46d63e3836399a135949df0908d92252ab3d18f7c5eb16a170d5'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_unchanged0/.EiaUugVg4WUik2Mtpi5oVu.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_unchanged0/.EiaUugVg4WUik2Mtpi5oVu.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_unchanged0/.dvc/cache/.HhhdKFoNgF47N8ZDaRuhkX.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_unchanged0/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'bar.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore bar.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
_________________________________ test_subdir __________________________________

M = <class 'pytest_test_utils.matchers.Matcher'>
tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_subdir0')
scm = Git: '/tmp/pytest-of-user/pytest-384/test_subdir0/.git'

    def test_subdir(M, tmp_dir, scm):
        subrepo = tmp_dir / "sub"
        make_subrepo(subrepo, scm)
    
        with subrepo.chdir():
            subrepo.dvc_gen({"dir": {"foo": "foo"}}, commit="add dir")
            subrepo.dvc_gen("bar", "bar", commit="add foo")
            subrepo.gen("untracked", "untracked")
    
            dvc = subrepo.dvc
>           assert dvc.data_status(granular=True, untracked_files="all") == {
                **EMPTY_STATUS,
                "git": M.dict(),
                "unchanged": M.unordered("bar", join("dir", ""), join("dir", "foo")),
                "untracked": ["untracked"],
            }

/home/user/dvc/tests/func/test_data_status.py:215: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/data.py:229: in status
    uncommitted_diff = _diff_index_to_wtree(
/home/user/dvc/dvc/repo/data.py:171: in _diff_index_to_wtree
    return _diff(
/home/user/dvc/dvc/repo/data.py:77: in _diff
    for change in diff(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:288: in diff
    yield from changes
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:165: in _diff
    old_items, old_unknown = _get_items(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:140: in _get_items
    items = dict(index.ls(key, detail=True))
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ae1bc39b40>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:09:15,109 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/config.local' to gitignore file.
2023-05-15 22:09:15,131 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/tmp' to gitignore file.
2023-05-15 22:09:15,153 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/cache' to gitignore file.
2023-05-15 22:09:15,188 DEBUG: Removing '/var/tmp/dvc/repo/88e3800005f9f60e76d1cfd8ad596036'
2023-05-15 22:09:15,882 DEBUG: Staging files: {'/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/config', '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/.gitignore', '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvcignore'}
Initialized DVC repository.

You can now commit the changes to git.

2023-05-15 22:09:17,663 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/dir' to gitignore file.
2023-05-15 22:09:17,941 DEBUG: built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
2023-05-15 22:09:17,955 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:09:18,243 DEBUG: built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
2023-05-15 22:09:18,261 DEBUG: Preparing to transfer data from 'memory://dvc-staging/1c4d32bd216ad35035e9b0259b8a5faefaf3bf65dc92ce3bfb150d1fa2c0c7b3' to '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/cache'
2023-05-15 22:09:18,272 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/cache'
2023-05-15 22:09:18,303 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/cache'
2023-05-15 22:09:18,422 DEBUG: Preparing to collect status from 'memory://dvc-staging/1c4d32bd216ad35035e9b0259b8a5faefaf3bf65dc92ce3bfb150d1fa2c0c7b3'
2023-05-15 22:09:19,127 DEBUG: built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
2023-05-15 22:09:19,169 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:09:19,182 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.mWNd4EZ87nV5L3kdcqFbzX.tmp'
2023-05-15 22:09:19,229 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.mWNd4EZ87nV5L3kdcqFbzX.tmp'
2023-05-15 22:09:19,245 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/cache/.BStBbgCnxvMt7NBLD592zF.tmp'
2023-05-15 22:09:19,264 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/dir/foo'
2023-05-15 22:09:19,451 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:09:21,449 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/bar' to gitignore file.
2023-05-15 22:09:21,560 DEBUG: Computed stage: 'bar.dvc' md5: 'None'
2023-05-15 22:09:21,694 DEBUG: Preparing to transfer data from 'memory://dvc-staging/1c4d32bd216ad35035e9b0259b8a5faefaf3bf65dc92ce3bfb150d1fa2c0c7b3' to '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/cache'
2023-05-15 22:09:21,709 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/cache'
2023-05-15 22:09:21,721 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/cache'
2023-05-15 22:09:21,819 DEBUG: Preparing to collect status from 'memory://dvc-staging/1c4d32bd216ad35035e9b0259b8a5faefaf3bf65dc92ce3bfb150d1fa2c0c7b3'
2023-05-15 22:09:22,039 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:09:22,052 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.TaDaUD9RmjW343mYS6WnUk.tmp'
2023-05-15 22:09:22,097 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.TaDaUD9RmjW343mYS6WnUk.tmp'
2023-05-15 22:09:22,111 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/cache/.BEDHuPP8JARMJNEiNJs4Xf.tmp'
2023-05-15 22:09:22,131 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/bar'
2023-05-15 22:09:22,296 DEBUG: Saving information to 'bar.dvc'.

To track the changes with git, run:

	git add .gitignore bar.dvc

To enable auto staging, run:

	dvc config core.autostage true
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  4.02file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.62file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.62file/s][A

![A[A

  0%|          |memory://.2uAR6YJMLHJQrnmwF3jrfC.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.2uAR6YJMLHJQrnmwF3jrfC0.00/63.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  6.35file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.04s/file]100% Adding...|██████████|1/1 [00:02,  2.07s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.22file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
                                                                                [A100% Adding...|██████████|1/1 [00:01<00:00,  1.07s/file]100% Adding...|██████████|1/1 [00:01,  1.09s/file]      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/config.local' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/tmp' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/cache' to gitignore file.
DEBUG    dvc.utils.fs:fs.py:63 Removing '/var/tmp/dvc/repo/88e3800005f9f60e76d1cfd8ad596036'
DEBUG    dvc.repo.scm_context:scm_context.py:68 Staging files: {'/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/config', '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/.gitignore', '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvcignore'}
INFO     dvc.repo.init:init.py:93 Initialized DVC repository.

INFO     dvc.repo.init:init.py:95 You can now commit the changes to git.

DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/1c4d32bd216ad35035e9b0259b8a5faefaf3bf65dc92ce3bfb150d1fa2c0c7b3' to '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/1c4d32bd216ad35035e9b0259b8a5faefaf3bf65dc92ce3bfb150d1fa2c0c7b3'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.mWNd4EZ87nV5L3kdcqFbzX.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.mWNd4EZ87nV5L3kdcqFbzX.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/cache/.BStBbgCnxvMt7NBLD592zF.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/dir/foo'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/bar' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'bar.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/1c4d32bd216ad35035e9b0259b8a5faefaf3bf65dc92ce3bfb150d1fa2c0c7b3' to '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/1c4d32bd216ad35035e9b0259b8a5faefaf3bf65dc92ce3bfb150d1fa2c0c7b3'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.TaDaUD9RmjW343mYS6WnUk.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.TaDaUD9RmjW343mYS6WnUk.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/.dvc/cache/.BEDHuPP8JARMJNEiNJs4Xf.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_subdir0/sub/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'bar.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore bar.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
__________________________ test_partial_missing_cache __________________________

M = <class 'pytest_test_utils.matchers.Matcher'>
tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_partial_missing_cache0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_partial_missing_cache0'
scm = Git: '/tmp/pytest-of-user/pytest-384/test_partial_missing_cache0/.git'

    def test_partial_missing_cache(M, tmp_dir, dvc, scm):
        tmp_dir.dvc_gen({"dir": {"foo": "foo", "bar": "bar"}})
    
        # remove "foo" from cache
        odb = dvc.cache.repo
        odb.fs.rm(odb.oid_to_path("acbd18db4cc2f85cedef654fccc4a4d8"))
    
        assert dvc.data_status() == {
            **EMPTY_STATUS,
            "committed": {"added": [join("dir", "")]},
            "git": M.dict(),
        }
>       assert dvc.data_status(granular=True) == {
            **EMPTY_STATUS,
            "committed": {
                "added": M.unordered(
                    join("dir", ""), join("dir", "foo"), join("dir", "bar")
                )
            },
            "not_in_cache": [join("dir", "foo")],
            "git": M.dict(),
        }

/home/user/dvc/tests/func/test_data_status.py:343: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/data.py:229: in status
    uncommitted_diff = _diff_index_to_wtree(
/home/user/dvc/dvc/repo/data.py:171: in _diff_index_to_wtree
    return _diff(
/home/user/dvc/dvc/repo/data.py:77: in _diff
    for change in diff(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:288: in diff
    yield from changes
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:165: in _diff
    old_items, old_unknown = _get_items(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:140: in _get_items
    items = dict(index.ls(key, detail=True))
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ae776b3b90>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:10:16,354 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_partial_missing_cache0/dir' to gitignore file.
2023-05-15 22:10:16,747 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-15 22:10:16,761 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:10:17,112 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-15 22:10:17,130 DEBUG: Preparing to transfer data from 'memory://dvc-staging/46206cbbd28518f9e530101a2da3208f740d8d4b06530047b93c6e27bdf88ef5' to '/tmp/pytest-of-user/pytest-384/test_partial_missing_cache0/.dvc/cache'
2023-05-15 22:10:17,143 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_partial_missing_cache0/.dvc/cache'
2023-05-15 22:10:17,179 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_partial_missing_cache0/.dvc/cache'
2023-05-15 22:10:17,326 DEBUG: Preparing to collect status from 'memory://dvc-staging/46206cbbd28518f9e530101a2da3208f740d8d4b06530047b93c6e27bdf88ef5'
2023-05-15 22:10:18,125 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-15 22:10:18,164 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:10:18,174 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_partial_missing_cache0/.jM9ndicgxjEccqKMyEmAbd.tmp'
2023-05-15 22:10:18,227 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_partial_missing_cache0/.jM9ndicgxjEccqKMyEmAbd.tmp'
2023-05-15 22:10:18,240 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_partial_missing_cache0/.dvc/cache/.i7ZXngD2tpsxyg8o2oF8ht.tmp'
2023-05-15 22:10:18,258 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_partial_missing_cache0/dir/foo'
2023-05-15 22:10:18,446 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_partial_missing_cache0/dir/bar'
2023-05-15 22:10:18,962 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:10:19,196 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_partial_missing_cache0/.dvc/cache/ac/bd18db4cc2f85cedef654fccc4a4d8'
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  4.17file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |2.00 [00:00,   16.0obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/2 [00:00<?,     ?file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 14.90file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 14.90file/s][A

![A[A

  0%|          |memory://.8sHMtEmrczDSoCLfL4FYr7.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.8sHMtEmrczDSoCLfL4FYr7.0.00/126 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.87s/file]100% Adding...|██████████|1/1 [00:02,  2.91s/file]      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_partial_missing_cache0/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/46206cbbd28518f9e530101a2da3208f740d8d4b06530047b93c6e27bdf88ef5' to '/tmp/pytest-of-user/pytest-384/test_partial_missing_cache0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_partial_missing_cache0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_partial_missing_cache0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/46206cbbd28518f9e530101a2da3208f740d8d4b06530047b93c6e27bdf88ef5'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_partial_missing_cache0/.jM9ndicgxjEccqKMyEmAbd.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_partial_missing_cache0/.jM9ndicgxjEccqKMyEmAbd.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_partial_missing_cache0/.dvc/cache/.i7ZXngD2tpsxyg8o2oF8ht.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_partial_missing_cache0/dir/foo'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_partial_missing_cache0/dir/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_partial_missing_cache0/.dvc/cache/ac/bd18db4cc2f85cedef654fccc4a4d8'
______________________ test_missing_dir_object_from_head _______________________

M = <class 'pytest_test_utils.matchers.Matcher'>
tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0'
scm = Git: '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.git'

    def test_missing_dir_object_from_head(M, tmp_dir, dvc, scm):
        (stage,) = tmp_dir.dvc_gen({"dir": {"foo": "foo", "bar": "bar"}}, commit="add dir")
        remove("dir")
        tmp_dir.dvc_gen({"dir": {"foobar": "foobar"}})
        odb = dvc.cache.repo
        odb.fs.rm(odb.oid_to_path(stage.outs[0].hash_info.value))
    
        assert dvc.data_status() == {
            **EMPTY_STATUS,
            "committed": {"modified": [join("dir", "")]},
            "git": M.dict(),
        }
>       assert dvc.data_status(granular=True) == {
            **EMPTY_STATUS,
            "committed": {
                "modified": [join("dir", "")],
                "unknown": [join("dir", "foobar")],
            },
            "git": M.dict(),
        }

/home/user/dvc/tests/func/test_data_status.py:367: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/data.py:229: in status
    uncommitted_diff = _diff_index_to_wtree(
/home/user/dvc/dvc/repo/data.py:171: in _diff_index_to_wtree
    return _diff(
/home/user/dvc/dvc/repo/data.py:77: in _diff
    for change in diff(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:288: in diff
    yield from changes
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:165: in _diff
    old_items, old_unknown = _get_items(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:140: in _get_items
    items = dict(index.ls(key, detail=True))
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ae3c970410>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:10:26,582 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/dir' to gitignore file.
2023-05-15 22:10:26,951 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-15 22:10:26,965 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:10:27,269 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-15 22:10:27,283 DEBUG: Preparing to transfer data from 'memory://dvc-staging/f5c59a606cdcf1de138240cc32dee8c784ee3419871c541c0bf848ece30aec17' to '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.dvc/cache'
2023-05-15 22:10:27,294 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.dvc/cache'
2023-05-15 22:10:27,327 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.dvc/cache'
2023-05-15 22:10:27,469 DEBUG: Preparing to collect status from 'memory://dvc-staging/f5c59a606cdcf1de138240cc32dee8c784ee3419871c541c0bf848ece30aec17'
2023-05-15 22:10:28,239 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-15 22:10:28,277 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:10:28,289 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.B3u3JDNfdjN5MacbL69tWy.tmp'
2023-05-15 22:10:28,333 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.B3u3JDNfdjN5MacbL69tWy.tmp'
2023-05-15 22:10:28,348 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.dvc/cache/.hxoFHsuKmhjm3vG9pNLnRC.tmp'
2023-05-15 22:10:28,368 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/dir/foo'
2023-05-15 22:10:28,443 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/dir/bar'
2023-05-15 22:10:28,636 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:10:29,722 DEBUG: Removing 'dir'
2023-05-15 22:10:30,986 DEBUG: built tree 'object b66c79180d7549229d54ca917e219cc4.dir'
2023-05-15 22:10:31,000 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:10:31,309 DEBUG: built tree 'object b66c79180d7549229d54ca917e219cc4.dir'
2023-05-15 22:10:31,324 DEBUG: Preparing to transfer data from 'memory://dvc-staging/f5c59a606cdcf1de138240cc32dee8c784ee3419871c541c0bf848ece30aec17' to '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.dvc/cache'
2023-05-15 22:10:31,336 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.dvc/cache'
2023-05-15 22:10:31,365 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.dvc/cache'
2023-05-15 22:10:31,485 DEBUG: Preparing to collect status from 'memory://dvc-staging/f5c59a606cdcf1de138240cc32dee8c784ee3419871c541c0bf848ece30aec17'
2023-05-15 22:10:32,147 DEBUG: built tree 'object b66c79180d7549229d54ca917e219cc4.dir'
2023-05-15 22:10:32,186 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:10:32,198 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.Uh4Ude8MjVDUSpRXabfLiQ.tmp'
2023-05-15 22:10:32,245 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.Uh4Ude8MjVDUSpRXabfLiQ.tmp'
2023-05-15 22:10:32,261 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.dvc/cache/.S5WiyDr7k2PzHcSCycBMwd.tmp'
2023-05-15 22:10:32,284 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/dir/foobar'
2023-05-15 22:10:32,474 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:10:32,953 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.dvc/cache/5e/a40360f5b4ec688df672a4db9c17d1.dir'
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  4.05file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |2.00 [00:00,   19.6obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/2 [00:00<?,     ?file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 16.46file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 16.46file/s][A

![A[A

  0%|          |memory://.BjW64r9fgXUDrdEYNbwYWj.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.BjW64r9fgXUDrdEYNbwYWj.0.00/126 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.31s/file]100% Adding...|██████████|1/1 [00:02,  2.34s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  2.65file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00, 10.20file/s][A

![A[A

  0%|          |memory://.DFWbFZHdAFUQky2L3Rmoy2.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.DFWbFZHdAFUQky2L3Rmoy20.00/66.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  7.89file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.38s/file]100% Adding...|██████████|1/1 [00:02,  2.42s/file]      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/f5c59a606cdcf1de138240cc32dee8c784ee3419871c541c0bf848ece30aec17' to '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/f5c59a606cdcf1de138240cc32dee8c784ee3419871c541c0bf848ece30aec17'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.B3u3JDNfdjN5MacbL69tWy.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.B3u3JDNfdjN5MacbL69tWy.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.dvc/cache/.hxoFHsuKmhjm3vG9pNLnRC.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/dir/foo'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/dir/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.utils.fs:fs.py:63 Removing 'dir'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object b66c79180d7549229d54ca917e219cc4.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object b66c79180d7549229d54ca917e219cc4.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/f5c59a606cdcf1de138240cc32dee8c784ee3419871c541c0bf848ece30aec17' to '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/f5c59a606cdcf1de138240cc32dee8c784ee3419871c541c0bf848ece30aec17'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object b66c79180d7549229d54ca917e219cc4.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.Uh4Ude8MjVDUSpRXabfLiQ.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.Uh4Ude8MjVDUSpRXabfLiQ.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.dvc/cache/.S5WiyDr7k2PzHcSCycBMwd.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/dir/foobar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_h0/.dvc/cache/5e/a40360f5b4ec688df672a4db9c17d1.dir'
______________________ test_missing_dir_object_from_index ______________________

M = <class 'pytest_test_utils.matchers.Matcher'>
tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0'
scm = Git: '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.git'

    def test_missing_dir_object_from_index(M, tmp_dir, dvc, scm):
        tmp_dir.dvc_gen({"dir": {"foo": "foo", "bar": "bar"}}, commit="add dir")
        remove("dir")
        (stage,) = tmp_dir.dvc_gen({"dir": {"foobar": "foobar"}})
        odb = dvc.cache.repo
        odb.fs.rm(odb.oid_to_path(stage.outs[0].hash_info.value))
    
        assert dvc.data_status() == {
            **EMPTY_STATUS,
            "committed": {"modified": [join("dir", "")]},
            "not_in_cache": [join("dir", "")],
            "git": M.dict(),
        }
>       assert dvc.data_status(granular=True) == {
            **EMPTY_STATUS,
            "committed": {
                "modified": [join("dir", "")],
            },
            "uncommitted": {"unknown": [join("dir", "foobar")]},
            "not_in_cache": [join("dir", "")],
            "git": M.dict(),
        }

/home/user/dvc/tests/func/test_data_status.py:390: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/data.py:236: in status
    committed_diff = _diff_head_to_index(repo, head=head, **kwargs)
/home/user/dvc/dvc/repo/data.py:189: in _diff_head_to_index
    return _diff(head_index, index, **kwargs)
/home/user/dvc/dvc/repo/data.py:77: in _diff
    for change in diff(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:288: in diff
    yield from changes
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:165: in _diff
    old_items, old_unknown = _get_items(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:140: in _get_items
    items = dict(index.ls(key, detail=True))
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ae9d39c370>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:10:40,129 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/dir' to gitignore file.
2023-05-15 22:10:40,478 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-15 22:10:40,492 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:10:40,836 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-15 22:10:40,852 DEBUG: Preparing to transfer data from 'memory://dvc-staging/5154f48a4cd76383e88ec7f08f90de1d68a6c45502930895e466cbccb20670d3' to '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.dvc/cache'
2023-05-15 22:10:40,864 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.dvc/cache'
2023-05-15 22:10:40,903 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.dvc/cache'
2023-05-15 22:10:41,061 DEBUG: Preparing to collect status from 'memory://dvc-staging/5154f48a4cd76383e88ec7f08f90de1d68a6c45502930895e466cbccb20670d3'
2023-05-15 22:10:41,851 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-15 22:10:41,895 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:10:41,910 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.8Au2xErhB7LKPVZGQJbxjB.tmp'
2023-05-15 22:10:41,957 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.8Au2xErhB7LKPVZGQJbxjB.tmp'
2023-05-15 22:10:41,972 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.dvc/cache/.U2vGL4ETwMuvWhDEDVRyiL.tmp'
2023-05-15 22:10:41,990 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/dir/foo'
2023-05-15 22:10:42,069 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/dir/bar'
2023-05-15 22:10:42,291 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:10:43,453 DEBUG: Removing 'dir'
2023-05-15 22:10:44,738 DEBUG: built tree 'object b66c79180d7549229d54ca917e219cc4.dir'
2023-05-15 22:10:44,753 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:10:45,048 DEBUG: built tree 'object b66c79180d7549229d54ca917e219cc4.dir'
2023-05-15 22:10:45,065 DEBUG: Preparing to transfer data from 'memory://dvc-staging/5154f48a4cd76383e88ec7f08f90de1d68a6c45502930895e466cbccb20670d3' to '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.dvc/cache'
2023-05-15 22:10:45,078 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.dvc/cache'
2023-05-15 22:10:45,108 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.dvc/cache'
2023-05-15 22:10:45,237 DEBUG: Preparing to collect status from 'memory://dvc-staging/5154f48a4cd76383e88ec7f08f90de1d68a6c45502930895e466cbccb20670d3'
2023-05-15 22:10:45,978 DEBUG: built tree 'object b66c79180d7549229d54ca917e219cc4.dir'
2023-05-15 22:10:46,021 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:10:46,033 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.ARMMppcCUEufRZkRXoqiyS.tmp'
2023-05-15 22:10:46,079 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.ARMMppcCUEufRZkRXoqiyS.tmp'
2023-05-15 22:10:46,093 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.dvc/cache/.WSiySLFmWibDoKNermXC4h.tmp'
2023-05-15 22:10:46,118 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/dir/foobar'
2023-05-15 22:10:46,307 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:10:46,816 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.dvc/cache/b6/6c79180d7549229d54ca917e219cc4.dir'
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.65file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |2.00 [00:00,   19.3obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/2 [00:00<?,     ?file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 16.95file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 16.95file/s][A

![A[A

  0%|          |memory://.PE2C3KvLQPU62oqaVsevCK.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.PE2C3KvLQPU62oqaVsevCK.0.00/126 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.41s/file]100% Adding...|██████████|1/1 [00:02,  2.45s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  2.60file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.08file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.08file/s][A

![A[A

  0%|          |memory://.7zEKGhzNrTZ7RRTso7zgnr.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.7zEKGhzNrTZ7RRTso7zgnr0.00/66.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  5.59file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.46s/file]100% Adding...|██████████|1/1 [00:02,  2.49s/file]      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/5154f48a4cd76383e88ec7f08f90de1d68a6c45502930895e466cbccb20670d3' to '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/5154f48a4cd76383e88ec7f08f90de1d68a6c45502930895e466cbccb20670d3'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.8Au2xErhB7LKPVZGQJbxjB.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.8Au2xErhB7LKPVZGQJbxjB.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.dvc/cache/.U2vGL4ETwMuvWhDEDVRyiL.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/dir/foo'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/dir/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.utils.fs:fs.py:63 Removing 'dir'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object b66c79180d7549229d54ca917e219cc4.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object b66c79180d7549229d54ca917e219cc4.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/5154f48a4cd76383e88ec7f08f90de1d68a6c45502930895e466cbccb20670d3' to '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/5154f48a4cd76383e88ec7f08f90de1d68a6c45502930895e466cbccb20670d3'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object b66c79180d7549229d54ca917e219cc4.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.ARMMppcCUEufRZkRXoqiyS.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.ARMMppcCUEufRZkRXoqiyS.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.dvc/cache/.WSiySLFmWibDoKNermXC4h.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/dir/foobar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_dir_object_from_i0/.dvc/cache/b6/6c79180d7549229d54ca917e219cc4.dir'
__________________________ test_missing_remote_cache ___________________________

M = <class 'pytest_test_utils.matchers.Matcher'>
tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0'
scm = Git: '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.git'
local_remote = PosixTmpDir('/tmp/pytest-of-user/pytest-384/local-cloud44')

    def test_missing_remote_cache(M, tmp_dir, dvc, scm, local_remote):
        tmp_dir.dvc_gen({"dir": {"foo": "foo", "bar": "bar"}})
        tmp_dir.dvc_gen("foobar", "foobar")
    
        assert dvc.data_status(untracked_files="all") == {
            **EMPTY_STATUS,
            "untracked": M.unordered("foobar.dvc", "dir.dvc", ".gitignore"),
            "committed": {"added": M.unordered("foobar", join("dir", ""))},
            "not_in_remote": M.unordered("foobar", join("dir", "")),
            "git": M.dict(),
        }
    
>       assert dvc.data_status(granular=True, untracked_files="all") == {
            **EMPTY_STATUS,
            "untracked": M.unordered("foobar.dvc", "dir.dvc", ".gitignore"),
            "committed": {
                "added": M.unordered(
                    "foobar",
                    join("dir", ""),
                    join("dir", "foo"),
                    join("dir", "bar"),
                )
            },
            "uncommitted": {},
            "not_in_remote": M.unordered(
                "foobar",
                join("dir", ""),
                join("dir", "foo"),
                join("dir", "bar"),
            ),
            "git": M.dict(),
        }

/home/user/dvc/tests/func/test_data_status.py:413: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/data.py:229: in status
    uncommitted_diff = _diff_index_to_wtree(
/home/user/dvc/dvc/repo/data.py:171: in _diff_index_to_wtree
    return _diff(
/home/user/dvc/dvc/repo/data.py:77: in _diff
    for change in diff(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:288: in diff
    yield from changes
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:165: in _diff
    old_items, old_unknown = _get_items(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:140: in _get_items
    items = dict(index.ls(key, detail=True))
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ae9de9aaf0>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
---------------------------- Captured stdout setup -----------------------------
2023-05-15 22:10:54,429 DEBUG: Writing '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.dvc/config'.
------------------------------ Captured log setup ------------------------------
DEBUG    dvc.config:config.py:206 Writing '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.dvc/config'.
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:10:56,464 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/dir' to gitignore file.
2023-05-15 22:10:56,822 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-15 22:10:56,834 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:10:57,140 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-15 22:10:57,157 DEBUG: Preparing to transfer data from 'memory://dvc-staging/c4a917dd848266f415ca05ba2e5072107a52b718904f89e1fd5d966c3a6ef221' to '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.dvc/cache'
2023-05-15 22:10:57,171 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.dvc/cache'
2023-05-15 22:10:57,205 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.dvc/cache'
2023-05-15 22:10:57,350 DEBUG: Preparing to collect status from 'memory://dvc-staging/c4a917dd848266f415ca05ba2e5072107a52b718904f89e1fd5d966c3a6ef221'
2023-05-15 22:10:58,051 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-15 22:10:58,097 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:10:58,110 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.7KmyZ44PqKf9wFobyAZCcM.tmp'
2023-05-15 22:10:58,158 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.7KmyZ44PqKf9wFobyAZCcM.tmp'
2023-05-15 22:10:58,174 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.dvc/cache/.5AXBzQ6SugLxnKqbg9koaZ.tmp'
2023-05-15 22:10:58,197 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/dir/foo'
2023-05-15 22:10:58,271 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/dir/bar'
2023-05-15 22:10:58,456 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:10:59,459 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/foobar' to gitignore file.
2023-05-15 22:10:59,567 DEBUG: Computed stage: 'foobar.dvc' md5: 'None'
2023-05-15 22:10:59,704 DEBUG: Preparing to transfer data from 'memory://dvc-staging/c4a917dd848266f415ca05ba2e5072107a52b718904f89e1fd5d966c3a6ef221' to '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.dvc/cache'
2023-05-15 22:10:59,718 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.dvc/cache'
2023-05-15 22:10:59,731 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.dvc/cache'
2023-05-15 22:10:59,835 DEBUG: Preparing to collect status from 'memory://dvc-staging/c4a917dd848266f415ca05ba2e5072107a52b718904f89e1fd5d966c3a6ef221'
2023-05-15 22:11:00,062 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:11:00,076 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.3DYd4dkRRvmoZFsqdSf3nb.tmp'
2023-05-15 22:11:00,119 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.3DYd4dkRRvmoZFsqdSf3nb.tmp'
2023-05-15 22:11:00,133 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.dvc/cache/.UwX5SXcYkqPe4NzHPSkkJ4.tmp'
2023-05-15 22:11:00,154 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/foobar'
2023-05-15 22:11:00,327 DEBUG: Saving information to 'foobar.dvc'.

To track the changes with git, run:

	git add .gitignore foobar.dvc

To enable auto staging, run:

	dvc config core.autostage true
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.75file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |2.00 [00:00,   18.3obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/2 [00:00<?,     ?file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 16.82file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 16.82file/s][A

![A[A

  0%|          |memory://.j4m2LzwJpvEopzbiUxTsF8.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.j4m2LzwJpvEopzbiUxTsF8.0.00/126 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.24s/file]100% Adding...|██████████|1/1 [00:02,  2.28s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  4.20file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
                                                                                [A100% Adding...|██████████|1/1 [00:01<00:00,  1.09s/file]100% Adding...|██████████|1/1 [00:01,  1.12s/file]      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/c4a917dd848266f415ca05ba2e5072107a52b718904f89e1fd5d966c3a6ef221' to '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/c4a917dd848266f415ca05ba2e5072107a52b718904f89e1fd5d966c3a6ef221'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.7KmyZ44PqKf9wFobyAZCcM.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.7KmyZ44PqKf9wFobyAZCcM.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.dvc/cache/.5AXBzQ6SugLxnKqbg9koaZ.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/dir/foo'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/dir/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/foobar' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'foobar.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/c4a917dd848266f415ca05ba2e5072107a52b718904f89e1fd5d966c3a6ef221' to '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/c4a917dd848266f415ca05ba2e5072107a52b718904f89e1fd5d966c3a6ef221'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.3DYd4dkRRvmoZFsqdSf3nb.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.3DYd4dkRRvmoZFsqdSf3nb.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/.dvc/cache/.UwX5SXcYkqPe4NzHPSkkJ4.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_missing_remote_cache0/foobar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'foobar.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore foobar.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
__________________________ test_root_from_dir_to_file __________________________

M = <class 'pytest_test_utils.matchers.Matcher'>
tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_root_from_dir_to_file0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_root_from_dir_to_file0'
scm = Git: '/tmp/pytest-of-user/pytest-384/test_root_from_dir_to_file0/.git'

    def test_root_from_dir_to_file(M, tmp_dir, dvc, scm):
        tmp_dir.dvc_gen({"data": {"foo": "foo", "bar": "bar"}})
        remove("data")
        tmp_dir.gen("data", "file")
    
        assert dvc.data_status() == {
            **EMPTY_STATUS,
            "committed": {"added": [join("data", "")]},
            "uncommitted": {"modified": ["data"]},
            "git": M.dict(),
        }
>       assert dvc.data_status(granular=True) == {
            **EMPTY_STATUS,
            "committed": {
                "added": M.unordered(
                    join("data", ""), join("data", "foo"), join("data", "bar")
                )
            },
            "uncommitted": {
                "deleted": M.unordered(join("data", "foo"), join("data", "bar")),
                "modified": ["data"],
            },
            "git": M.dict(),
        }

/home/user/dvc/tests/func/test_data_status.py:446: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/data.py:229: in status
    uncommitted_diff = _diff_index_to_wtree(
/home/user/dvc/dvc/repo/data.py:171: in _diff_index_to_wtree
    return _diff(
/home/user/dvc/dvc/repo/data.py:77: in _diff
    for change in diff(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:288: in diff
    yield from changes
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:165: in _diff
    old_items, old_unknown = _get_items(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:140: in _get_items
    items = dict(index.ls(key, detail=True))
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ae42d8a550>
key = ('data',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:11:08,056 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_root_from_dir_to_file0/data' to gitignore file.
2023-05-15 22:11:08,365 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-15 22:11:08,378 DEBUG: Computed stage: 'data.dvc' md5: 'None'
2023-05-15 22:11:08,670 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-15 22:11:08,683 DEBUG: Preparing to transfer data from 'memory://dvc-staging/c2f2335911d9a9c9b7c8d5a840e1d6882b054bd27de2d10ad96d15f49cc6e7e8' to '/tmp/pytest-of-user/pytest-384/test_root_from_dir_to_file0/.dvc/cache'
2023-05-15 22:11:08,693 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_root_from_dir_to_file0/.dvc/cache'
2023-05-15 22:11:08,722 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_root_from_dir_to_file0/.dvc/cache'
2023-05-15 22:11:08,852 DEBUG: Preparing to collect status from 'memory://dvc-staging/c2f2335911d9a9c9b7c8d5a840e1d6882b054bd27de2d10ad96d15f49cc6e7e8'
2023-05-15 22:11:09,607 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-15 22:11:09,656 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:11:09,670 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_root_from_dir_to_file0/.7E9JGmue8VBwTwsWHzSxhV.tmp'
2023-05-15 22:11:09,715 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_root_from_dir_to_file0/.7E9JGmue8VBwTwsWHzSxhV.tmp'
2023-05-15 22:11:09,730 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_root_from_dir_to_file0/.dvc/cache/.CM5DCYnbzbyWzHzpecd2yP.tmp'
2023-05-15 22:11:09,749 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_root_from_dir_to_file0/data/foo'
2023-05-15 22:11:09,824 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_root_from_dir_to_file0/data/bar'
2023-05-15 22:11:10,026 DEBUG: Saving information to 'data.dvc'.

To track the changes with git, run:

	git add .gitignore data.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:11:10,255 DEBUG: Removing 'data'
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  4.14file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from data          |0.00 [00:00,      ?obj/s][A
                                                                   [A
![A
Building data objects from data          |0.00 [00:00,      ?obj/s][A
                                                                   [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/2 [00:00<?,     ?file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 17.02file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 17.02file/s][A

![A[A

  0%|          |memory://.kEiPRNhc6Ju8ATXMzifFVX.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.kEiPRNhc6Ju8ATXMzifFVX.0.00/126 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from data          |0.00 [00:00,      ?obj/s][A
                                                                   [A100% Adding...|██████████|1/1 [00:02<00:00,  2.21s/file]100% Adding...|██████████|1/1 [00:02,  2.24s/file]      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_root_from_dir_to_file0/data' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'data.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/c2f2335911d9a9c9b7c8d5a840e1d6882b054bd27de2d10ad96d15f49cc6e7e8' to '/tmp/pytest-of-user/pytest-384/test_root_from_dir_to_file0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_root_from_dir_to_file0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_root_from_dir_to_file0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/c2f2335911d9a9c9b7c8d5a840e1d6882b054bd27de2d10ad96d15f49cc6e7e8'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_root_from_dir_to_file0/.7E9JGmue8VBwTwsWHzSxhV.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_root_from_dir_to_file0/.7E9JGmue8VBwTwsWHzSxhV.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_root_from_dir_to_file0/.dvc/cache/.CM5DCYnbzbyWzHzpecd2yP.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_root_from_dir_to_file0/data/foo'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_root_from_dir_to_file0/data/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'data.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore data.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.utils.fs:fs.py:63 Removing 'data'
_______________________________ test_directories _______________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_directories0')
scm = Git: '/tmp/pytest-of-user/pytest-384/test_directories0/.git'
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_directories0'

    def test_directories(tmp_dir, scm, dvc):
        tmp_dir.dvc_gen({"dir": {"1": "1", "2": "2"}}, commit="add a directory")
        tmp_dir.dvc_gen({"dir": {"3": "3"}}, commit="add a file")
        tmp_dir.dvc_gen({"dir": {"2": "two"}}, commit="modify a file")
    
        (tmp_dir / "dir" / "2").unlink()
        assert dvc.status() != {}  # sanity check
        dvc.add("dir")
        scm.add(["dir.dvc"])
        scm.commit("delete a file")
    
        # The ":/<text>" format is a way to specify revisions by commit message:
        #       https://git-scm.com/docs/revisions
        #
>       assert dvc.diff(":/init", ":/directory") == {
            "added": [
                {
                    "path": os.path.join("dir", ""),
                    "hash": "5fb6b29836c388e093ca0715c872fe2a.dir",
                },
                {"path": os.path.join("dir", "1"), "hash": digest("1")},
                {"path": os.path.join("dir", "2"), "hash": digest("2")},
            ],
            "deleted": [],
            "modified": [],
            "not in cache": [],
            "renamed": [],
        }

/home/user/dvc/tests/func/test_diff.py:199: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/__init__.py:65: in wrapper
    return f(repo, *args, **kwargs)
/home/user/dvc/dvc/repo/diff.py:163: in diff
    return _diff(old, new, with_missing=with_missing)
/home/user/dvc/dvc/repo/diff.py:37: in _diff
    for change in idiff(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:286: in diff
    yield from _detect_renames(changes)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:219: in _detect_renames
    for change in changes:
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:168: in _diff
    new_items, new_unknown = _get_items(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:140: in _get_items
    items = dict(index.ls(key, detail=True))
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/view.py:127: in ls
    self._index._ensure_loaded(  # pylint: disable=protected-access
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ae02cb6cd0>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:12:30,159 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_directories0/dir' to gitignore file.
2023-05-15 22:12:30,460 DEBUG: built tree 'object 5fb6b29836c388e093ca0715c872fe2a.dir'
2023-05-15 22:12:30,474 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:12:30,792 DEBUG: built tree 'object 5fb6b29836c388e093ca0715c872fe2a.dir'
2023-05-15 22:12:30,807 DEBUG: Preparing to transfer data from 'memory://dvc-staging/6b68b3441ac79fa35521f9a9fa1c425bdd53885bfe2caf6238cc8a6f7f16023b' to '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache'
2023-05-15 22:12:30,817 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache'
2023-05-15 22:12:30,850 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache'
2023-05-15 22:12:30,992 DEBUG: Preparing to collect status from 'memory://dvc-staging/6b68b3441ac79fa35521f9a9fa1c425bdd53885bfe2caf6238cc8a6f7f16023b'
2023-05-15 22:12:31,691 DEBUG: built tree 'object 5fb6b29836c388e093ca0715c872fe2a.dir'
2023-05-15 22:12:31,734 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:12:31,744 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directories0/.DJNujwUYUEppPwESYWNoqB.tmp'
2023-05-15 22:12:31,784 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directories0/.DJNujwUYUEppPwESYWNoqB.tmp'
2023-05-15 22:12:31,795 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache/.L2dGxEt4iNofApPs2DzTwp.tmp'
2023-05-15 22:12:31,814 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directories0/dir/2'
2023-05-15 22:12:31,889 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directories0/dir/1'
2023-05-15 22:12:32,085 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:12:34,498 DEBUG: built tree 'object c0cac1b91ce03bde002f5b6f287e54f0.dir'
2023-05-15 22:12:34,514 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:12:34,848 DEBUG: built tree 'object c0cac1b91ce03bde002f5b6f287e54f0.dir'
2023-05-15 22:12:34,866 DEBUG: Preparing to transfer data from 'memory://dvc-staging/6b68b3441ac79fa35521f9a9fa1c425bdd53885bfe2caf6238cc8a6f7f16023b' to '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache'
2023-05-15 22:12:34,880 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache'
2023-05-15 22:12:34,915 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache'
2023-05-15 22:12:35,043 DEBUG: Preparing to collect status from 'memory://dvc-staging/6b68b3441ac79fa35521f9a9fa1c425bdd53885bfe2caf6238cc8a6f7f16023b'
2023-05-15 22:12:35,745 DEBUG: built tree 'object c0cac1b91ce03bde002f5b6f287e54f0.dir'
2023-05-15 22:12:35,802 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:12:35,815 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directories0/.hmfZacgCVzw6aFvbne9fhe.tmp'
2023-05-15 22:12:35,861 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directories0/.hmfZacgCVzw6aFvbne9fhe.tmp'
2023-05-15 22:12:35,877 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache/.C4icTXhoHQwxWv5YyPZq6M.tmp'
2023-05-15 22:12:35,895 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directories0/dir/2'
2023-05-15 22:12:35,969 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directories0/dir/1'
2023-05-15 22:12:36,052 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directories0/dir/3'
2023-05-15 22:12:36,266 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:12:39,137 DEBUG: built tree 'object 9b5faf37366b3370fd98e3e60ca439c1.dir'
2023-05-15 22:12:39,158 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:12:39,527 DEBUG: built tree 'object 9b5faf37366b3370fd98e3e60ca439c1.dir'
2023-05-15 22:12:39,543 DEBUG: Preparing to transfer data from 'memory://dvc-staging/6b68b3441ac79fa35521f9a9fa1c425bdd53885bfe2caf6238cc8a6f7f16023b' to '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache'
2023-05-15 22:12:39,555 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache'
2023-05-15 22:12:39,594 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache'
2023-05-15 22:12:39,724 DEBUG: Preparing to collect status from 'memory://dvc-staging/6b68b3441ac79fa35521f9a9fa1c425bdd53885bfe2caf6238cc8a6f7f16023b'
2023-05-15 22:12:40,510 DEBUG: built tree 'object 9b5faf37366b3370fd98e3e60ca439c1.dir'
2023-05-15 22:12:40,560 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:12:40,573 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directories0/.CTdXmNgZQGAbVgQMEYwKgS.tmp'
2023-05-15 22:12:40,628 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directories0/.CTdXmNgZQGAbVgQMEYwKgS.tmp'
2023-05-15 22:12:40,642 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache/.nD5Pwz8S7rwQnXiuFMjm3V.tmp'
2023-05-15 22:12:40,663 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directories0/dir/2'
2023-05-15 22:12:40,744 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directories0/dir/1'
2023-05-15 22:12:40,810 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directories0/dir/3'
2023-05-15 22:12:41,002 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:12:43,157 DEBUG: built tree 'object 83ae82fb367ac9926455870773ff09e6.dir'
2023-05-15 22:12:43,172 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:12:44,528 DEBUG: built tree 'object 83ae82fb367ac9926455870773ff09e6.dir'
2023-05-15 22:12:44,542 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:12:44,857 DEBUG: built tree 'object 83ae82fb367ac9926455870773ff09e6.dir'
2023-05-15 22:12:44,874 DEBUG: Preparing to transfer data from 'memory://dvc-staging/6b68b3441ac79fa35521f9a9fa1c425bdd53885bfe2caf6238cc8a6f7f16023b' to '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache'
2023-05-15 22:12:44,885 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache'
2023-05-15 22:12:44,920 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache'
2023-05-15 22:12:45,058 DEBUG: Preparing to collect status from 'memory://dvc-staging/6b68b3441ac79fa35521f9a9fa1c425bdd53885bfe2caf6238cc8a6f7f16023b'
2023-05-15 22:12:45,725 DEBUG: built tree 'object 83ae82fb367ac9926455870773ff09e6.dir'
2023-05-15 22:12:45,771 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:12:45,783 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directories0/.du8fJVoWWvLRUQwb3Htv2Q.tmp'
2023-05-15 22:12:45,833 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directories0/.du8fJVoWWvLRUQwb3Htv2Q.tmp'
2023-05-15 22:12:45,846 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache/.484v6rAo25YR64JfmAh9Bj.tmp'
2023-05-15 22:12:45,871 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directories0/dir/3'
2023-05-15 22:12:45,950 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_directories0/dir/1'
2023-05-15 22:12:46,151 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  4.10file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/2 [00:00<?,     ?file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 15.66file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 15.66file/s][A

![A[A

  0%|          |memory://.Htfb8RXJ3fu73e5GVhhtyw.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.Htfb8RXJ3fu73e5GVhhtyw.0.00/122 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.18s/file]100% Adding...|██████████|1/1 [00:02,  2.21s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  2.71file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.75file/s][A

![A[A

  0%|          |memory://.F7gdnYtX87NxTxzXsEHKaF.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.F7gdnYtX87NxTxzXsEHKaF.0.00/183 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  7.99file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.71s/file]100% Adding...|██████████|1/1 [00:02,  2.74s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  2.64file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |2.00 [00:00,   15.0obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.84file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.84file/s][A

![A[A

  0%|          |memory://.RYw5hXYoTa2BoWVHyLCfUB.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.RYw5hXYoTa2BoWVHyLCfUB.0.00/183 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  6.15file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.86s/file]100% Adding...|██████████|1/1 [00:02,  2.89s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Building data objects from dir          |0.00 [00:00,      ?obj/s]                                                                  !If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  2.71file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A

![A[A

  0%|          |memory://.h8NrYJVvyrsWYtFBNAFHWK.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.h8NrYJVvyrsWYtFBNAFHWK.0.00/122 [00:00<?,        ?B/s][A[A
100%|██████████|Transferring                      1/1 [00:00<00:00,  4.93file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.52s/file]100% Adding...|██████████|1/1 [00:02,  2.55s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_directories0/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5fb6b29836c388e093ca0715c872fe2a.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5fb6b29836c388e093ca0715c872fe2a.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/6b68b3441ac79fa35521f9a9fa1c425bdd53885bfe2caf6238cc8a6f7f16023b' to '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/6b68b3441ac79fa35521f9a9fa1c425bdd53885bfe2caf6238cc8a6f7f16023b'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5fb6b29836c388e093ca0715c872fe2a.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directories0/.DJNujwUYUEppPwESYWNoqB.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directories0/.DJNujwUYUEppPwESYWNoqB.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache/.L2dGxEt4iNofApPs2DzTwp.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directories0/dir/2'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directories0/dir/1'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object c0cac1b91ce03bde002f5b6f287e54f0.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object c0cac1b91ce03bde002f5b6f287e54f0.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/6b68b3441ac79fa35521f9a9fa1c425bdd53885bfe2caf6238cc8a6f7f16023b' to '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/6b68b3441ac79fa35521f9a9fa1c425bdd53885bfe2caf6238cc8a6f7f16023b'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object c0cac1b91ce03bde002f5b6f287e54f0.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directories0/.hmfZacgCVzw6aFvbne9fhe.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directories0/.hmfZacgCVzw6aFvbne9fhe.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache/.C4icTXhoHQwxWv5YyPZq6M.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directories0/dir/2'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directories0/dir/1'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directories0/dir/3'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 9b5faf37366b3370fd98e3e60ca439c1.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 9b5faf37366b3370fd98e3e60ca439c1.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/6b68b3441ac79fa35521f9a9fa1c425bdd53885bfe2caf6238cc8a6f7f16023b' to '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/6b68b3441ac79fa35521f9a9fa1c425bdd53885bfe2caf6238cc8a6f7f16023b'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 9b5faf37366b3370fd98e3e60ca439c1.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directories0/.CTdXmNgZQGAbVgQMEYwKgS.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directories0/.CTdXmNgZQGAbVgQMEYwKgS.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache/.nD5Pwz8S7rwQnXiuFMjm3V.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directories0/dir/2'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directories0/dir/1'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directories0/dir/3'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 83ae82fb367ac9926455870773ff09e6.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 83ae82fb367ac9926455870773ff09e6.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 83ae82fb367ac9926455870773ff09e6.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/6b68b3441ac79fa35521f9a9fa1c425bdd53885bfe2caf6238cc8a6f7f16023b' to '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/6b68b3441ac79fa35521f9a9fa1c425bdd53885bfe2caf6238cc8a6f7f16023b'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 83ae82fb367ac9926455870773ff09e6.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directories0/.du8fJVoWWvLRUQwb3Htv2Q.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directories0/.du8fJVoWWvLRUQwb3Htv2Q.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directories0/.dvc/cache/.484v6rAo25YR64JfmAh9Bj.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directories0/dir/3'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_directories0/dir/1'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
_______________________________ test_diff_dirty ________________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_diff_dirty0')
scm = Git: '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.git'
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_diff_dirty0'

    def test_diff_dirty(tmp_dir, scm, dvc):
        tmp_dir.dvc_gen(
            {"file": "file_content", "dir": {"dir_file1": "dir file content"}},
            commit="initial",
        )
    
        (tmp_dir / "file").unlink()
        tmp_dir.gen({"dir": {"dir_file2": "dir file 2 content"}})
        tmp_dir.dvc_gen("new_file", "new_file_content")
    
>       result = dvc.diff()

/home/user/dvc/tests/func/test_diff.py:299: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/__init__.py:65: in wrapper
    return f(repo, *args, **kwargs)
/home/user/dvc/dvc/repo/diff.py:163: in diff
    return _diff(old, new, with_missing=with_missing)
/home/user/dvc/dvc/repo/diff.py:37: in _diff
    for change in idiff(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:286: in diff
    yield from _detect_renames(changes)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:219: in _detect_renames
    for change in changes:
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:165: in _diff
    old_items, old_unknown = _get_items(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:140: in _get_items
    items = dict(index.ls(key, detail=True))
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/view.py:127: in ls
    self._index._ensure_loaded(  # pylint: disable=protected-access
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ae29806be0>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:13:07,048 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/file' to gitignore file.
2023-05-15 22:13:07,171 DEBUG: Computed stage: 'file.dvc' md5: 'None'
2023-05-15 22:13:07,321 DEBUG: Preparing to transfer data from 'memory://dvc-staging/7c084fe6ca4a0f7e9bfc2e34893851d0b4a2cf8d4cef68ec9b0ee4a8c4ea2592' to '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.dvc/cache'
2023-05-15 22:13:07,333 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.dvc/cache'
2023-05-15 22:13:07,344 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.dvc/cache'
2023-05-15 22:13:07,466 DEBUG: Preparing to collect status from 'memory://dvc-staging/7c084fe6ca4a0f7e9bfc2e34893851d0b4a2cf8d4cef68ec9b0ee4a8c4ea2592'
2023-05-15 22:13:07,708 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:13:07,722 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.7ciXpz6Z6DhMWGoHEsgSW9.tmp'
2023-05-15 22:13:07,766 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.7ciXpz6Z6DhMWGoHEsgSW9.tmp'
2023-05-15 22:13:07,781 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.dvc/cache/.4dTgaXeicxu3GSicvDmzX5.tmp'
2023-05-15 22:13:07,802 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/file'
2023-05-15 22:13:07,962 DEBUG: Saving information to 'file.dvc'.
2023-05-15 22:13:08,200 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/dir' to gitignore file.
2023-05-15 22:13:08,467 DEBUG: built tree 'object 92daf39af116ca2fb245acaeb2ae65f7.dir'
2023-05-15 22:13:08,482 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:13:08,759 DEBUG: built tree 'object 92daf39af116ca2fb245acaeb2ae65f7.dir'
2023-05-15 22:13:08,776 DEBUG: Preparing to transfer data from 'memory://dvc-staging/7c084fe6ca4a0f7e9bfc2e34893851d0b4a2cf8d4cef68ec9b0ee4a8c4ea2592' to '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.dvc/cache'
2023-05-15 22:13:08,790 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.dvc/cache'
2023-05-15 22:13:08,817 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.dvc/cache'
2023-05-15 22:13:08,952 DEBUG: Preparing to collect status from 'memory://dvc-staging/7c084fe6ca4a0f7e9bfc2e34893851d0b4a2cf8d4cef68ec9b0ee4a8c4ea2592'
2023-05-15 22:13:09,687 DEBUG: built tree 'object 92daf39af116ca2fb245acaeb2ae65f7.dir'
2023-05-15 22:13:09,731 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:13:09,745 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.XQs93wJF86mLNqTwETG6uy.tmp'
2023-05-15 22:13:09,795 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.XQs93wJF86mLNqTwETG6uy.tmp'
2023-05-15 22:13:09,811 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.dvc/cache/.FfcnJHj9qrQkLaMJKBBAXG.tmp'
2023-05-15 22:13:09,833 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/dir/dir_file1'
2023-05-15 22:13:10,039 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc file.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:13:12,210 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/new_file' to gitignore file.
2023-05-15 22:13:12,322 DEBUG: Computed stage: 'new_file.dvc' md5: 'None'
2023-05-15 22:13:12,469 DEBUG: Preparing to transfer data from 'memory://dvc-staging/7c084fe6ca4a0f7e9bfc2e34893851d0b4a2cf8d4cef68ec9b0ee4a8c4ea2592' to '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.dvc/cache'
2023-05-15 22:13:12,484 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.dvc/cache'
2023-05-15 22:13:12,501 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.dvc/cache'
2023-05-15 22:13:12,621 DEBUG: Preparing to collect status from 'memory://dvc-staging/7c084fe6ca4a0f7e9bfc2e34893851d0b4a2cf8d4cef68ec9b0ee4a8c4ea2592'
2023-05-15 22:13:12,865 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:13:12,877 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.6KsKJvdJoBETXecujKp3cW.tmp'
2023-05-15 22:13:12,944 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.6KsKJvdJoBETXecujKp3cW.tmp'
2023-05-15 22:13:12,957 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.dvc/cache/.BvK3AjHsHWHs3ip9L739Lj.tmp'
2023-05-15 22:13:12,976 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/new_file'
2023-05-15 22:13:13,142 DEBUG: Saving information to 'new_file.dvc'.

To track the changes with git, run:

	git add .gitignore new_file.dvc

To enable auto staging, run:

	dvc config core.autostage true
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  4.14file/s]Collecting targets          |2.00 [00:00,  5.54file/s]                                                      !  0% Adding...|          |0/2 [00:00<?,     ?file/s]
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
                                                                                [A 50% Adding...|█████     | file |1/2 [00:01<00:01,  1.13s/file]
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.71file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.71file/s][A

![A[A

  0%|          |memory://.2sALdSYbu4yjRoLe6nD8JH.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.2sALdSYbu4yjRoLe6nD8JH0.00/69.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  6.02file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████| dir |2/2 [00:03<00:00,  1.68s/file] 100% Adding...|██████████|2/2 [00:03,  1.61s/file]            
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  2.99file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
                                                                                [A100% Adding...|██████████|1/1 [00:01<00:00,  1.19s/file]100% Adding...|██████████|1/1 [00:01,  1.22s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/file' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'file.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/7c084fe6ca4a0f7e9bfc2e34893851d0b4a2cf8d4cef68ec9b0ee4a8c4ea2592' to '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/7c084fe6ca4a0f7e9bfc2e34893851d0b4a2cf8d4cef68ec9b0ee4a8c4ea2592'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.7ciXpz6Z6DhMWGoHEsgSW9.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.7ciXpz6Z6DhMWGoHEsgSW9.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.dvc/cache/.4dTgaXeicxu3GSicvDmzX5.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/file'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'file.dvc'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 92daf39af116ca2fb245acaeb2ae65f7.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 92daf39af116ca2fb245acaeb2ae65f7.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/7c084fe6ca4a0f7e9bfc2e34893851d0b4a2cf8d4cef68ec9b0ee4a8c4ea2592' to '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/7c084fe6ca4a0f7e9bfc2e34893851d0b4a2cf8d4cef68ec9b0ee4a8c4ea2592'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 92daf39af116ca2fb245acaeb2ae65f7.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.XQs93wJF86mLNqTwETG6uy.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.XQs93wJF86mLNqTwETG6uy.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.dvc/cache/.FfcnJHj9qrQkLaMJKBBAXG.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/dir/dir_file1'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc file.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/new_file' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'new_file.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/7c084fe6ca4a0f7e9bfc2e34893851d0b4a2cf8d4cef68ec9b0ee4a8c4ea2592' to '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/7c084fe6ca4a0f7e9bfc2e34893851d0b4a2cf8d4cef68ec9b0ee4a8c4ea2592'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.6KsKJvdJoBETXecujKp3cW.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.6KsKJvdJoBETXecujKp3cW.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/.dvc/cache/.BvK3AjHsHWHs3ip9L739Lj.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_dirty0/new_file'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'new_file.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore new_file.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
________________________ test_diff_rename_folder[True] _________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0')
scm = Git: '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/.git'
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0'
commit_last = True

    @pytest.mark.parametrize("commit_last", [True, False])
    def test_diff_rename_folder(tmp_dir, scm, dvc, commit_last):
        if commit_last:
            last_commit_msg = "commit #2"
            a_rev = "HEAD~1"
        else:
            last_commit_msg = None
            a_rev = "HEAD"
    
        tmp_dir.dvc_gen(
            {"dir": {"file": "text1", "subdir": {"file2": "text2"}}},
            commit="commit #1",
        )
        (tmp_dir / "dir").replace(tmp_dir / "dir2")
        tmp_dir.dvc_add("dir2", commit=last_commit_msg)
>       assert dvc.diff(a_rev) == {
            "added": [],
            "deleted": [],
            "modified": [],
            "renamed": [
                {
                    "path": {
                        "old": os.path.join("dir", ""),
                        "new": os.path.join("dir2", ""),
                    },
                    "hash": "cb58ee07cb01044db229e4d6121a0dfc.dir",
                },
                {
                    "path": {
                        "old": os.path.join("dir", "file"),
                        "new": os.path.join("dir2", "file"),
                    },
                    "hash": "cef7ccd89dacf1ced6f5ec91d759953f",
                },
                {
                    "path": {
                        "old": os.path.join("dir", "subdir", "file2"),
                        "new": os.path.join("dir2", "subdir", "file2"),
                    },
                    "hash": "fe6123a759017e4a2af4a2d19961ed71",
                },
            ],
            "not in cache": [],
        }

/home/user/dvc/tests/func/test_diff.py:549: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/__init__.py:65: in wrapper
    return f(repo, *args, **kwargs)
/home/user/dvc/dvc/repo/diff.py:163: in diff
    return _diff(old, new, with_missing=with_missing)
/home/user/dvc/dvc/repo/diff.py:37: in _diff
    for change in idiff(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:286: in diff
    yield from _detect_renames(changes)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:219: in _detect_renames
    for change in changes:
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:165: in _diff
    old_items, old_unknown = _get_items(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:140: in _get_items
    items = dict(index.ls(key, detail=True))
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/view.py:127: in ls
    self._index._ensure_loaded(  # pylint: disable=protected-access
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14adf0ded8c0>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:15:48,983 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/dir' to gitignore file.
2023-05-15 22:15:49,338 DEBUG: built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
2023-05-15 22:15:49,352 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:15:49,665 DEBUG: built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
2023-05-15 22:15:49,682 DEBUG: Preparing to transfer data from 'memory://dvc-staging/959025223436cd7d32213a0e3eb3dac0c331a256bdd6bd19f8d0a808f90edbe0' to '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/.dvc/cache'
2023-05-15 22:15:49,694 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/.dvc/cache'
2023-05-15 22:15:49,726 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/.dvc/cache'
2023-05-15 22:15:49,863 DEBUG: Preparing to collect status from 'memory://dvc-staging/959025223436cd7d32213a0e3eb3dac0c331a256bdd6bd19f8d0a808f90edbe0'
2023-05-15 22:15:50,598 DEBUG: built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
2023-05-15 22:15:50,639 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:15:50,651 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/.m83KXYfqGqaw8nnRh7GtYH.tmp'
2023-05-15 22:15:50,692 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/.m83KXYfqGqaw8nnRh7GtYH.tmp'
2023-05-15 22:15:50,706 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/.dvc/cache/.eHWjhFJ4mx2xyhVRouBtzH.tmp'
2023-05-15 22:15:50,724 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/dir/subdir/file2'
2023-05-15 22:15:50,795 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/dir/file'
2023-05-15 22:15:50,995 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:15:52,881 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/dir2' to gitignore file.
2023-05-15 22:15:53,222 DEBUG: built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
2023-05-15 22:15:53,237 DEBUG: Computed stage: 'dir2.dvc' md5: 'None'
2023-05-15 22:15:53,537 DEBUG: built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
2023-05-15 22:15:53,553 DEBUG: Preparing to transfer data from 'memory://dvc-staging/959025223436cd7d32213a0e3eb3dac0c331a256bdd6bd19f8d0a808f90edbe0' to '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/.dvc/cache'
2023-05-15 22:15:53,565 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/.dvc/cache'
2023-05-15 22:15:53,596 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/.dvc/cache'
2023-05-15 22:15:53,948 DEBUG: built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
2023-05-15 22:15:53,988 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:15:53,999 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/.7gtjqVXjD8T8gaK7ECeBDf.tmp'
2023-05-15 22:15:54,040 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/.7gtjqVXjD8T8gaK7ECeBDf.tmp'
2023-05-15 22:15:54,053 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/.dvc/cache/.TUB369wkEfCpo2Hpjc9naS.tmp'
2023-05-15 22:15:54,071 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/dir2/subdir/file2'
2023-05-15 22:15:54,142 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/dir2/file'
2023-05-15 22:15:54,338 DEBUG: Saving information to 'dir2.dvc'.

To track the changes with git, run:

	git add .gitignore dir2.dvc

To enable auto staging, run:

	dvc config core.autostage true
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  4.11file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |2.00 [00:00,   18.4obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/2 [00:00<?,     ?file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 16.51file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 16.51file/s][A

![A[A

  0%|          |memory://.Y73ueB2sjsJ6sfDzhkyrrL.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.Y73ueB2sjsJ6sfDzhkyrrL.0.00/136 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.25s/file]100% Adding...|██████████|1/1 [00:02,  2.28s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  4.12file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir2          |0.00 [00:00,      ?obj/s][A
Building data objects from dir2          |2.00 [00:00,   19.3obj/s][A
                                                                   [A
![A
Building data objects from dir2          |0.00 [00:00,      ?obj/s][A
                                                                   [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
Building data objects from dir2          |0.00 [00:00,      ?obj/s][A
                                                                   [A100% Adding...|██████████|1/1 [00:01<00:00,  1.69s/file]100% Adding...|██████████|1/1 [00:01,  1.72s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/959025223436cd7d32213a0e3eb3dac0c331a256bdd6bd19f8d0a808f90edbe0' to '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/959025223436cd7d32213a0e3eb3dac0c331a256bdd6bd19f8d0a808f90edbe0'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/.m83KXYfqGqaw8nnRh7GtYH.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/.m83KXYfqGqaw8nnRh7GtYH.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/.dvc/cache/.eHWjhFJ4mx2xyhVRouBtzH.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/dir/subdir/file2'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/dir/file'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/dir2' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir2.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/959025223436cd7d32213a0e3eb3dac0c331a256bdd6bd19f8d0a808f90edbe0' to '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/.dvc/cache'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/.7gtjqVXjD8T8gaK7ECeBDf.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/.7gtjqVXjD8T8gaK7ECeBDf.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/.dvc/cache/.TUB369wkEfCpo2Hpjc9naS.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/dir2/subdir/file2'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_True_0/dir2/file'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir2.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir2.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
________________________ test_diff_rename_folder[False] ________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0')
scm = Git: '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/.git'
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0'
commit_last = False

    @pytest.mark.parametrize("commit_last", [True, False])
    def test_diff_rename_folder(tmp_dir, scm, dvc, commit_last):
        if commit_last:
            last_commit_msg = "commit #2"
            a_rev = "HEAD~1"
        else:
            last_commit_msg = None
            a_rev = "HEAD"
    
        tmp_dir.dvc_gen(
            {"dir": {"file": "text1", "subdir": {"file2": "text2"}}},
            commit="commit #1",
        )
        (tmp_dir / "dir").replace(tmp_dir / "dir2")
        tmp_dir.dvc_add("dir2", commit=last_commit_msg)
>       assert dvc.diff(a_rev) == {
            "added": [],
            "deleted": [],
            "modified": [],
            "renamed": [
                {
                    "path": {
                        "old": os.path.join("dir", ""),
                        "new": os.path.join("dir2", ""),
                    },
                    "hash": "cb58ee07cb01044db229e4d6121a0dfc.dir",
                },
                {
                    "path": {
                        "old": os.path.join("dir", "file"),
                        "new": os.path.join("dir2", "file"),
                    },
                    "hash": "cef7ccd89dacf1ced6f5ec91d759953f",
                },
                {
                    "path": {
                        "old": os.path.join("dir", "subdir", "file2"),
                        "new": os.path.join("dir2", "subdir", "file2"),
                    },
                    "hash": "fe6123a759017e4a2af4a2d19961ed71",
                },
            ],
            "not in cache": [],
        }

/home/user/dvc/tests/func/test_diff.py:549: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/__init__.py:65: in wrapper
    return f(repo, *args, **kwargs)
/home/user/dvc/dvc/repo/diff.py:163: in diff
    return _diff(old, new, with_missing=with_missing)
/home/user/dvc/dvc/repo/diff.py:37: in _diff
    for change in idiff(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:286: in diff
    yield from _detect_renames(changes)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:219: in _detect_renames
    for change in changes:
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:165: in _diff
    old_items, old_unknown = _get_items(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:140: in _get_items
    items = dict(index.ls(key, detail=True))
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/view.py:127: in ls
    self._index._ensure_loaded(  # pylint: disable=protected-access
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14adeedfb280>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:16:01,854 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/dir' to gitignore file.
2023-05-15 22:16:02,190 DEBUG: built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
2023-05-15 22:16:02,204 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:16:02,505 DEBUG: built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
2023-05-15 22:16:02,523 DEBUG: Preparing to transfer data from 'memory://dvc-staging/9859861bb7caf79ea987968c1c4a51b6a0011c141cb5db892229346900f1ef0e' to '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/.dvc/cache'
2023-05-15 22:16:02,537 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/.dvc/cache'
2023-05-15 22:16:02,570 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/.dvc/cache'
2023-05-15 22:16:02,700 DEBUG: Preparing to collect status from 'memory://dvc-staging/9859861bb7caf79ea987968c1c4a51b6a0011c141cb5db892229346900f1ef0e'
2023-05-15 22:16:03,415 DEBUG: built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
2023-05-15 22:16:03,455 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:16:03,467 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/.jZwvnKG93hy8rgmBQ8D9fM.tmp'
2023-05-15 22:16:03,510 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/.jZwvnKG93hy8rgmBQ8D9fM.tmp'
2023-05-15 22:16:03,523 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/.dvc/cache/.Km9ngBBffNVHuzRwpqkdn2.tmp'
2023-05-15 22:16:03,541 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/dir/subdir/file2'
2023-05-15 22:16:03,611 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/dir/file'
2023-05-15 22:16:03,809 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:16:05,700 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/dir2' to gitignore file.
2023-05-15 22:16:05,991 DEBUG: built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
2023-05-15 22:16:06,003 DEBUG: Computed stage: 'dir2.dvc' md5: 'None'
2023-05-15 22:16:06,321 DEBUG: built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
2023-05-15 22:16:06,339 DEBUG: Preparing to transfer data from 'memory://dvc-staging/9859861bb7caf79ea987968c1c4a51b6a0011c141cb5db892229346900f1ef0e' to '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/.dvc/cache'
2023-05-15 22:16:06,351 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/.dvc/cache'
2023-05-15 22:16:06,384 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/.dvc/cache'
2023-05-15 22:16:06,709 DEBUG: built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
2023-05-15 22:16:06,756 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:16:06,768 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/.VUQaGvbeKQTyrDNz3zws25.tmp'
2023-05-15 22:16:06,815 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/.VUQaGvbeKQTyrDNz3zws25.tmp'
2023-05-15 22:16:06,826 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/.dvc/cache/.MsTGVfurvbEyMM9WNwJgSz.tmp'
2023-05-15 22:16:06,844 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/dir2/subdir/file2'
2023-05-15 22:16:06,919 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/dir2/file'
2023-05-15 22:16:07,122 DEBUG: Saving information to 'dir2.dvc'.

To track the changes with git, run:

	git add .gitignore dir2.dvc

To enable auto staging, run:

	dvc config core.autostage true
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  4.35file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |2.00 [00:00,   19.6obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/2 [00:00<?,     ?file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 17.42file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 17.42file/s][A

![A[A

  0%|          |memory://.aFvQ6e82AnmtkhZKgrMPxS.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.aFvQ6e82AnmtkhZKgrMPxS.0.00/136 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.62s/file]100% Adding...|██████████|1/1 [00:02,  2.65s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  4.22file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir2          |0.00 [00:00,      ?obj/s][A
                                                                   [A
![A
Building data objects from dir2          |0.00 [00:00,      ?obj/s][A
                                                                   [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
Building data objects from dir2          |0.00 [00:00,      ?obj/s][A
                                                                   [A100% Adding...|██████████|1/1 [00:01<00:00,  1.65s/file]100% Adding...|██████████|1/1 [00:01,  1.67s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/9859861bb7caf79ea987968c1c4a51b6a0011c141cb5db892229346900f1ef0e' to '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/9859861bb7caf79ea987968c1c4a51b6a0011c141cb5db892229346900f1ef0e'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/.jZwvnKG93hy8rgmBQ8D9fM.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/.jZwvnKG93hy8rgmBQ8D9fM.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/.dvc/cache/.Km9ngBBffNVHuzRwpqkdn2.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/dir/subdir/file2'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/dir/file'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/dir2' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir2.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/9859861bb7caf79ea987968c1c4a51b6a0011c141cb5db892229346900f1ef0e' to '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/.dvc/cache'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/.VUQaGvbeKQTyrDNz3zws25.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/.VUQaGvbeKQTyrDNz3zws25.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/.dvc/cache/.MsTGVfurvbEyMM9WNwJgSz.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/dir2/subdir/file2'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_folder_False_0/dir2/file'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir2.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir2.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
_________________________ test_diff_rename_file[True] __________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0')
scm = Git: '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/.git'
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0'
commit_last = True

    @pytest.mark.parametrize("commit_last", [True, False])
    def test_diff_rename_file(tmp_dir, scm, dvc, commit_last):
        if commit_last:
            last_commit_msg = "commit #2"
            a_rev = "HEAD~1"
        else:
            last_commit_msg = None
            a_rev = "HEAD"
    
        paths = tmp_dir.gen({"dir": {"file": "text1", "subdir": {"file2": "text2"}}})
        tmp_dir.dvc_add(paths, commit="commit #1")
        (tmp_dir / "dir" / "file").replace(tmp_dir / "dir" / "subdir" / "file3")
    
        tmp_dir.dvc_add(paths, commit=last_commit_msg)
>       assert dvc.diff(a_rev) == {
            "added": [],
            "deleted": [],
            "modified": [
                {
                    "path": os.path.join("dir", ""),
                    "hash": {
                        "old": "cb58ee07cb01044db229e4d6121a0dfc.dir",
                        "new": "a4ac9c339aacc60b6a3152e362c319c8.dir",
                    },
                }
            ],
            "renamed": [
                {
                    "path": {
                        "old": os.path.join("dir", "file"),
                        "new": os.path.join("dir", "subdir", "file3"),
                    },
                    "hash": "cef7ccd89dacf1ced6f5ec91d759953f",
                }
            ],
            "not in cache": [],
        }

/home/user/dvc/tests/func/test_diff.py:594: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/__init__.py:65: in wrapper
    return f(repo, *args, **kwargs)
/home/user/dvc/dvc/repo/diff.py:163: in diff
    return _diff(old, new, with_missing=with_missing)
/home/user/dvc/dvc/repo/diff.py:37: in _diff
    for change in idiff(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:286: in diff
    yield from _detect_renames(changes)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:219: in _detect_renames
    for change in changes:
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:165: in _diff
    old_items, old_unknown = _get_items(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:140: in _get_items
    items = dict(index.ls(key, detail=True))
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/view.py:127: in ls
    self._index._ensure_loaded(  # pylint: disable=protected-access
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14adeeb04230>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:16:13,473 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/dir' to gitignore file.
2023-05-15 22:16:13,737 DEBUG: built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
2023-05-15 22:16:13,752 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:16:14,057 DEBUG: built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
2023-05-15 22:16:14,073 DEBUG: Preparing to transfer data from 'memory://dvc-staging/823a8797e90413c9dbd0f9445e84920730f4f4fbf85233f59049b75c8b3d4f1d' to '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/.dvc/cache'
2023-05-15 22:16:14,084 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/.dvc/cache'
2023-05-15 22:16:14,115 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/.dvc/cache'
2023-05-15 22:16:14,234 DEBUG: Preparing to collect status from 'memory://dvc-staging/823a8797e90413c9dbd0f9445e84920730f4f4fbf85233f59049b75c8b3d4f1d'
2023-05-15 22:16:14,894 DEBUG: built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
2023-05-15 22:16:14,935 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:16:14,948 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/.ADEjbHR9R4itz4ydEULptA.tmp'
2023-05-15 22:16:14,990 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/.ADEjbHR9R4itz4ydEULptA.tmp'
2023-05-15 22:16:15,004 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/.dvc/cache/.BBaH4Bv5wMgqUBpZgjvxWg.tmp'
2023-05-15 22:16:15,025 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/dir/subdir/file2'
2023-05-15 22:16:15,097 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/dir/file'
2023-05-15 22:16:15,285 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:16:17,656 DEBUG: built tree 'object a4ac9c339aacc60b6a3152e362c319c8.dir'
2023-05-15 22:16:17,671 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:16:17,939 DEBUG: built tree 'object a4ac9c339aacc60b6a3152e362c319c8.dir'
2023-05-15 22:16:17,950 DEBUG: Preparing to transfer data from 'memory://dvc-staging/823a8797e90413c9dbd0f9445e84920730f4f4fbf85233f59049b75c8b3d4f1d' to '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/.dvc/cache'
2023-05-15 22:16:17,957 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/.dvc/cache'
2023-05-15 22:16:17,982 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/.dvc/cache'
2023-05-15 22:16:18,064 DEBUG: Preparing to collect status from 'memory://dvc-staging/823a8797e90413c9dbd0f9445e84920730f4f4fbf85233f59049b75c8b3d4f1d'
2023-05-15 22:16:18,614 DEBUG: built tree 'object a4ac9c339aacc60b6a3152e362c319c8.dir'
2023-05-15 22:16:18,660 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:16:18,672 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/.4KxJQZZynLc98F7tECifgh.tmp'
2023-05-15 22:16:18,709 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/.4KxJQZZynLc98F7tECifgh.tmp'
2023-05-15 22:16:18,718 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/.dvc/cache/.JhHckKpqX7NLmEqcLhYEgm.tmp'
2023-05-15 22:16:18,731 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/dir/subdir/file2'
2023-05-15 22:16:18,786 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/dir/subdir/file3'
2023-05-15 22:16:18,966 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  4.33file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/2 [00:00<?,     ?file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 17.17file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 17.17file/s][A

![A[A

  0%|          |memory://.FrcthnQ6q7Zr7vmT4yR76q.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.FrcthnQ6q7Zr7vmT4yR76q.0.00/136 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:01<00:00,  1.98s/file]100% Adding...|██████████|1/1 [00:02,  2.01s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  2.84file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A

![A[A

  0%|          |memory://.AeRWhVgNPQUcG9Kw533RP4.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.AeRWhVgNPQUcG9Kw533RP4.0.00/144 [00:00<?,        ?B/s][A[A
100%|██████████|Transferring                      1/1 [00:00<00:00,  6.45file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.19s/file]100% Adding...|██████████|1/1 [00:02,  2.22s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/823a8797e90413c9dbd0f9445e84920730f4f4fbf85233f59049b75c8b3d4f1d' to '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/823a8797e90413c9dbd0f9445e84920730f4f4fbf85233f59049b75c8b3d4f1d'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/.ADEjbHR9R4itz4ydEULptA.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/.ADEjbHR9R4itz4ydEULptA.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/.dvc/cache/.BBaH4Bv5wMgqUBpZgjvxWg.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/dir/subdir/file2'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/dir/file'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object a4ac9c339aacc60b6a3152e362c319c8.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object a4ac9c339aacc60b6a3152e362c319c8.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/823a8797e90413c9dbd0f9445e84920730f4f4fbf85233f59049b75c8b3d4f1d' to '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/823a8797e90413c9dbd0f9445e84920730f4f4fbf85233f59049b75c8b3d4f1d'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object a4ac9c339aacc60b6a3152e362c319c8.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/.4KxJQZZynLc98F7tECifgh.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/.4KxJQZZynLc98F7tECifgh.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/.dvc/cache/.JhHckKpqX7NLmEqcLhYEgm.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/dir/subdir/file2'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_True_0/dir/subdir/file3'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
_________________________ test_diff_rename_file[False] _________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0')
scm = Git: '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/.git'
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0'
commit_last = False

    @pytest.mark.parametrize("commit_last", [True, False])
    def test_diff_rename_file(tmp_dir, scm, dvc, commit_last):
        if commit_last:
            last_commit_msg = "commit #2"
            a_rev = "HEAD~1"
        else:
            last_commit_msg = None
            a_rev = "HEAD"
    
        paths = tmp_dir.gen({"dir": {"file": "text1", "subdir": {"file2": "text2"}}})
        tmp_dir.dvc_add(paths, commit="commit #1")
        (tmp_dir / "dir" / "file").replace(tmp_dir / "dir" / "subdir" / "file3")
    
        tmp_dir.dvc_add(paths, commit=last_commit_msg)
>       assert dvc.diff(a_rev) == {
            "added": [],
            "deleted": [],
            "modified": [
                {
                    "path": os.path.join("dir", ""),
                    "hash": {
                        "old": "cb58ee07cb01044db229e4d6121a0dfc.dir",
                        "new": "a4ac9c339aacc60b6a3152e362c319c8.dir",
                    },
                }
            ],
            "renamed": [
                {
                    "path": {
                        "old": os.path.join("dir", "file"),
                        "new": os.path.join("dir", "subdir", "file3"),
                    },
                    "hash": "cef7ccd89dacf1ced6f5ec91d759953f",
                }
            ],
            "not in cache": [],
        }

/home/user/dvc/tests/func/test_diff.py:594: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/__init__.py:65: in wrapper
    return f(repo, *args, **kwargs)
/home/user/dvc/dvc/repo/diff.py:163: in diff
    return _diff(old, new, with_missing=with_missing)
/home/user/dvc/dvc/repo/diff.py:37: in _diff
    for change in idiff(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:286: in diff
    yield from _detect_renames(changes)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:219: in _detect_renames
    for change in changes:
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:165: in _diff
    old_items, old_unknown = _get_items(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:140: in _get_items
    items = dict(index.ls(key, detail=True))
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/view.py:127: in ls
    self._index._ensure_loaded(  # pylint: disable=protected-access
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ae24bef4b0>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:16:27,980 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/dir' to gitignore file.
2023-05-15 22:16:28,327 DEBUG: built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
2023-05-15 22:16:28,342 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:16:28,652 DEBUG: built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
2023-05-15 22:16:28,672 DEBUG: Preparing to transfer data from 'memory://dvc-staging/8cffc1cd65fdfb4ab732cf3e62ef0fbc1831eb99272a1643df5031f9e17cc6b9' to '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/.dvc/cache'
2023-05-15 22:16:28,684 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/.dvc/cache'
2023-05-15 22:16:28,719 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/.dvc/cache'
2023-05-15 22:16:28,851 DEBUG: Preparing to collect status from 'memory://dvc-staging/8cffc1cd65fdfb4ab732cf3e62ef0fbc1831eb99272a1643df5031f9e17cc6b9'
2023-05-15 22:16:29,500 DEBUG: built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
2023-05-15 22:16:29,541 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:16:29,553 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/.kZgCMvXUY2ifLX24f6Lfr8.tmp'
2023-05-15 22:16:29,595 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/.kZgCMvXUY2ifLX24f6Lfr8.tmp'
2023-05-15 22:16:29,610 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/.dvc/cache/.gENCE2Vkb7hAHQfMHWQQbL.tmp'
2023-05-15 22:16:29,628 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/dir/subdir/file2'
2023-05-15 22:16:29,697 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/dir/file'
2023-05-15 22:16:29,902 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:16:32,292 DEBUG: built tree 'object a4ac9c339aacc60b6a3152e362c319c8.dir'
2023-05-15 22:16:32,304 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:16:32,619 DEBUG: built tree 'object a4ac9c339aacc60b6a3152e362c319c8.dir'
2023-05-15 22:16:32,634 DEBUG: Preparing to transfer data from 'memory://dvc-staging/8cffc1cd65fdfb4ab732cf3e62ef0fbc1831eb99272a1643df5031f9e17cc6b9' to '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/.dvc/cache'
2023-05-15 22:16:32,645 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/.dvc/cache'
2023-05-15 22:16:32,675 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/.dvc/cache'
2023-05-15 22:16:32,781 DEBUG: Preparing to collect status from 'memory://dvc-staging/8cffc1cd65fdfb4ab732cf3e62ef0fbc1831eb99272a1643df5031f9e17cc6b9'
2023-05-15 22:16:33,845 DEBUG: built tree 'object a4ac9c339aacc60b6a3152e362c319c8.dir'
2023-05-15 22:16:33,901 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:16:33,914 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/.nKvHiVjg4ZyniWfv9DoZih.tmp'
2023-05-15 22:16:33,963 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/.nKvHiVjg4ZyniWfv9DoZih.tmp'
2023-05-15 22:16:33,973 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/.dvc/cache/.9RpYynJX2BWpD6HFqx7CQB.tmp'
2023-05-15 22:16:33,991 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/dir/subdir/file2'
2023-05-15 22:16:34,071 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/dir/subdir/file3'
2023-05-15 22:16:34,249 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  2.57file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |2.00 [00:00,   19.2obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/2 [00:00<?,     ?file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 17.11file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 17.11file/s][A

![A[A

  0%|          |memory://.LmExaX5y7b6qT9yAqmaguk.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.LmExaX5y7b6qT9yAqmaguk.0.00/136 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.88s/file]100% Adding...|██████████|1/1 [00:02,  2.91s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  2.64file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A

![A[A

  0%|          |memory://.VLmVLzKU5mxWB3MK6DQWu7.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.VLmVLzKU5mxWB3MK6DQWu7.0.00/144 [00:00<?,        ?B/s][A[A
100%|██████████|Transferring                      1/1 [00:00<00:00,  5.10file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.80s/file]100% Adding...|██████████|1/1 [00:02,  2.84s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/8cffc1cd65fdfb4ab732cf3e62ef0fbc1831eb99272a1643df5031f9e17cc6b9' to '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/8cffc1cd65fdfb4ab732cf3e62ef0fbc1831eb99272a1643df5031f9e17cc6b9'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object cb58ee07cb01044db229e4d6121a0dfc.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/.kZgCMvXUY2ifLX24f6Lfr8.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/.kZgCMvXUY2ifLX24f6Lfr8.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/.dvc/cache/.gENCE2Vkb7hAHQfMHWQQbL.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/dir/subdir/file2'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/dir/file'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object a4ac9c339aacc60b6a3152e362c319c8.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object a4ac9c339aacc60b6a3152e362c319c8.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/8cffc1cd65fdfb4ab732cf3e62ef0fbc1831eb99272a1643df5031f9e17cc6b9' to '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/8cffc1cd65fdfb4ab732cf3e62ef0fbc1831eb99272a1643df5031f9e17cc6b9'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object a4ac9c339aacc60b6a3152e362c319c8.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/.nKvHiVjg4ZyniWfv9DoZih.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/.nKvHiVjg4ZyniWfv9DoZih.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/.dvc/cache/.9RpYynJX2BWpD6HFqx7CQB.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/dir/subdir/file2'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_diff_rename_file_False_0/dir/subdir/file3'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
____________________ test_rename_multiple_files_same_hashes ____________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0')
scm = Git: '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/.git'
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0'

    def test_rename_multiple_files_same_hashes(tmp_dir, scm, dvc):
        """Test diff by renaming >=2 instances of file with same hashes.
    
        DVC should be able to detect that they are renames, and should not include
        them in either of the `added` or the `deleted` section.
        """
        tmp_dir.dvc_gen(
            {"dir": {"foo": "foo", "subdir": {"foo": "foo"}}}, commit="commit #1"
        )
        remove(tmp_dir / "dir")
        # changing foo and subdir/foo to bar and subdir/bar respectively
        tmp_dir.dvc_gen(
            {"dir": {"bar": "foo", "subdir": {"bar": "foo"}}}, commit="commit #2"
        )
>       assert dvc.diff("HEAD~") == {
            "added": [],
            "deleted": [],
            "modified": [
                {
                    "hash": {
                        "new": "31b36b3ea5f4485e27f10578c47183b0.dir",
                        "old": "c7684c8b3b0d28cf80d5305e2d856bfc.dir",
                    },
                    "path": os.path.join("dir", ""),
                }
            ],
            "not in cache": [],
            "renamed": [
                {
                    "hash": "acbd18db4cc2f85cedef654fccc4a4d8",
                    "path": {
                        "new": os.path.join("dir", "bar"),
                        "old": os.path.join("dir", "foo"),
                    },
                },
                {
                    "hash": "acbd18db4cc2f85cedef654fccc4a4d8",
                    "path": {
                        "new": os.path.join("dir", "subdir", "bar"),
                        "old": os.path.join("dir", "subdir", "foo"),
                    },
                },
            ],
        }

/home/user/dvc/tests/func/test_diff.py:633: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/__init__.py:65: in wrapper
    return f(repo, *args, **kwargs)
/home/user/dvc/dvc/repo/diff.py:163: in diff
    return _diff(old, new, with_missing=with_missing)
/home/user/dvc/dvc/repo/diff.py:37: in _diff
    for change in idiff(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:286: in diff
    yield from _detect_renames(changes)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:219: in _detect_renames
    for change in changes:
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:165: in _diff
    old_items, old_unknown = _get_items(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/diff.py:140: in _get_items
    items = dict(index.ls(key, detail=True))
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/view.py:127: in ls
    self._index._ensure_loaded(  # pylint: disable=protected-access
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ae2814a550>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:16:41,584 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/dir' to gitignore file.
2023-05-15 22:16:41,966 DEBUG: built tree 'object c7684c8b3b0d28cf80d5305e2d856bfc.dir'
2023-05-15 22:16:41,978 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:16:42,299 DEBUG: built tree 'object c7684c8b3b0d28cf80d5305e2d856bfc.dir'
2023-05-15 22:16:42,316 DEBUG: Preparing to transfer data from 'memory://dvc-staging/80ada7ac6db93f9a7c46f61cbd459bb1b753ad408b7a5f2bf687e79f755842b8' to '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/.dvc/cache'
2023-05-15 22:16:42,330 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/.dvc/cache'
2023-05-15 22:16:42,365 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/.dvc/cache'
2023-05-15 22:16:42,484 DEBUG: Preparing to collect status from 'memory://dvc-staging/80ada7ac6db93f9a7c46f61cbd459bb1b753ad408b7a5f2bf687e79f755842b8'
2023-05-15 22:16:43,254 DEBUG: built tree 'object c7684c8b3b0d28cf80d5305e2d856bfc.dir'
2023-05-15 22:16:43,297 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:16:43,309 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/.L8vqgmZpYSR3gCs58PEQnd.tmp'
2023-05-15 22:16:43,356 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/.L8vqgmZpYSR3gCs58PEQnd.tmp'
2023-05-15 22:16:43,372 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/.dvc/cache/.9o83eLiB6YuZ5qEkHniGxm.tmp'
2023-05-15 22:16:43,395 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/dir/foo'
2023-05-15 22:16:43,464 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/dir/subdir/foo'
2023-05-15 22:16:43,661 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:16:44,921 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/dir'
2023-05-15 22:16:46,385 DEBUG: built tree 'object 31b36b3ea5f4485e27f10578c47183b0.dir'
2023-05-15 22:16:46,401 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:16:46,726 DEBUG: built tree 'object 31b36b3ea5f4485e27f10578c47183b0.dir'
2023-05-15 22:16:46,746 DEBUG: Preparing to transfer data from 'memory://dvc-staging/80ada7ac6db93f9a7c46f61cbd459bb1b753ad408b7a5f2bf687e79f755842b8' to '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/.dvc/cache'
2023-05-15 22:16:46,760 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/.dvc/cache'
2023-05-15 22:16:46,797 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/.dvc/cache'
2023-05-15 22:16:46,893 DEBUG: Preparing to collect status from 'memory://dvc-staging/80ada7ac6db93f9a7c46f61cbd459bb1b753ad408b7a5f2bf687e79f755842b8'
2023-05-15 22:16:47,548 DEBUG: built tree 'object 31b36b3ea5f4485e27f10578c47183b0.dir'
2023-05-15 22:16:47,597 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:16:47,609 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/.VueAADSb3xVV9v4Wh2u9Sr.tmp'
2023-05-15 22:16:47,652 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/.VueAADSb3xVV9v4Wh2u9Sr.tmp'
2023-05-15 22:16:47,667 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/.dvc/cache/.Zoz2bcRqvaxBCGAMoK7j8F.tmp'
2023-05-15 22:16:47,685 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/dir/bar'
2023-05-15 22:16:47,763 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/dir/subdir/bar'
2023-05-15 22:16:47,955 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.76file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |2.00 [00:00,   18.2obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.60file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.60file/s][A

![A[A

  0%|          |memory://.S2TtiHNTGbreQnTHw8zbHV.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.S2TtiHNTGbreQnTHw8zbHV.0.00/133 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  6.04file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.33s/file]100% Adding...|██████████|1/1 [00:02,  2.36s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  2.69file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |2.00 [00:00,   14.8obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A

![A[A

  0%|          |memory://.NLwGFkoN3nuvK7AdyhPK7c.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.NLwGFkoN3nuvK7AdyhPK7c.0.00/133 [00:00<?,        ?B/s][A[A
100%|██████████|Transferring                      1/1 [00:00<00:00,  5.06file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.62s/file]100% Adding...|██████████|1/1 [00:02,  2.65s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object c7684c8b3b0d28cf80d5305e2d856bfc.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object c7684c8b3b0d28cf80d5305e2d856bfc.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/80ada7ac6db93f9a7c46f61cbd459bb1b753ad408b7a5f2bf687e79f755842b8' to '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/80ada7ac6db93f9a7c46f61cbd459bb1b753ad408b7a5f2bf687e79f755842b8'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object c7684c8b3b0d28cf80d5305e2d856bfc.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/.L8vqgmZpYSR3gCs58PEQnd.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/.L8vqgmZpYSR3gCs58PEQnd.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/.dvc/cache/.9o83eLiB6YuZ5qEkHniGxm.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/dir/foo'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/dir/subdir/foo'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.utils.fs:fs.py:63 Removing '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/dir'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 31b36b3ea5f4485e27f10578c47183b0.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 31b36b3ea5f4485e27f10578c47183b0.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/80ada7ac6db93f9a7c46f61cbd459bb1b753ad408b7a5f2bf687e79f755842b8' to '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/80ada7ac6db93f9a7c46f61cbd459bb1b753ad408b7a5f2bf687e79f755842b8'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 31b36b3ea5f4485e27f10578c47183b0.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/.VueAADSb3xVV9v4Wh2u9Sr.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/.VueAADSb3xVV9v4Wh2u9Sr.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/.dvc/cache/.Zoz2bcRqvaxBCGAMoK7j8F.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/dir/bar'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_rename_multiple_files_sam0/dir/subdir/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
______________________________ test_get_repo_dir _______________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_get_repo_dir0')
erepo_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/erepo18')

    def test_get_repo_dir(tmp_dir, erepo_dir):
        with erepo_dir.chdir():
            erepo_dir.dvc_gen({"dir": {"file": "contents"}}, commit="create dir")
    
>       Repo.get(os.fspath(erepo_dir), "dir", "dir_imported")

/home/user/dvc/tests/func/test_get.py:42: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/get.py:76: in get
    fs.get(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:611: in get
    from_infos = list(self.find(from_info))
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:401: in find
    yield from self.fs.find(path)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:454: in find
    for _, dirs, files in self.walk(path, maxdepth, detail=True, **kwargs):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:282: in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:391: in ls
    return self.fs.ls(path, detail=detail, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ae84a7c320>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:24:43,872 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo18/dir' to gitignore file.
2023-05-15 22:24:44,144 DEBUG: built tree 'object 530dc51d2751ef7006228d6646774022.dir'
2023-05-15 22:24:44,158 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:24:44,461 DEBUG: built tree 'object 530dc51d2751ef7006228d6646774022.dir'
2023-05-15 22:24:44,477 DEBUG: Preparing to transfer data from 'memory://dvc-staging/4b3762f04c753f115beab14da9d482fdbe614174b4cad42485d8d2261c782de1' to '/tmp/pytest-of-user/pytest-384/erepo18/.dvc/cache'
2023-05-15 22:24:44,487 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo18/.dvc/cache'
2023-05-15 22:24:44,518 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo18/.dvc/cache'
2023-05-15 22:24:44,643 DEBUG: Preparing to collect status from 'memory://dvc-staging/4b3762f04c753f115beab14da9d482fdbe614174b4cad42485d8d2261c782de1'
2023-05-15 22:24:45,398 DEBUG: built tree 'object 530dc51d2751ef7006228d6646774022.dir'
2023-05-15 22:24:45,434 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:24:45,445 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo18/.ZX4SiXcpTW7QsYzURNDt2k.tmp'
2023-05-15 22:24:45,487 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo18/.ZX4SiXcpTW7QsYzURNDt2k.tmp'
2023-05-15 22:24:45,500 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo18/.dvc/cache/.FM9z6yCdq6rcroW5oebUds.tmp'
2023-05-15 22:24:45,523 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo18/dir/file'
2023-05-15 22:24:45,724 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:24:47,034 DEBUG: Creating external repo /tmp/pytest-of-user/pytest-384/erepo18@None
2023-05-15 22:24:47,049 DEBUG: erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo18' to a temporary dir
2023-05-15 22:24:49,681 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_repo_dir0/.P3QgQo9QgVVZgWg9C5AZGJ'
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  4.04file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.90file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.90file/s][A

![A[A

  0%|          |memory://.3w3AQYRwiYeQhcoDRrDffB.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.3w3AQYRwiYeQhcoDRrDffB0.00/64.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  6.06file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.10s/file]100% Adding...|██████████|1/1 [00:02,  2.13s/file]      
!Cloning erepo18|          |0.00/? [00:00,      ?obj/s]                                                      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo18/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 530dc51d2751ef7006228d6646774022.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 530dc51d2751ef7006228d6646774022.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/4b3762f04c753f115beab14da9d482fdbe614174b4cad42485d8d2261c782de1' to '/tmp/pytest-of-user/pytest-384/erepo18/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo18/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo18/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/4b3762f04c753f115beab14da9d482fdbe614174b4cad42485d8d2261c782de1'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 530dc51d2751ef7006228d6646774022.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo18/.ZX4SiXcpTW7QsYzURNDt2k.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo18/.ZX4SiXcpTW7QsYzURNDt2k.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo18/.dvc/cache/.FM9z6yCdq6rcroW5oebUds.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo18/dir/file'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.external_repo:external_repo.py:33 Creating external repo /tmp/pytest-of-user/pytest-384/erepo18@None
DEBUG    dvc.external_repo:external_repo.py:195 erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo18' to a temporary dir
DEBUG    scmrepo.git.backend.pygit2:pygit2.py:505 fetch_refspecs: []
DEBUG    dvc.utils.fs:fs.py:63 Removing '/tmp/pytest-of-user/pytest-384/test_get_repo_dir0/.P3QgQo9QgVVZgWg9C5AZGJ'
____________________________ test_get_file_from_dir ____________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_get_file_from_dir0')
erepo_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/erepo31')

    def test_get_file_from_dir(tmp_dir, erepo_dir):
        with erepo_dir.chdir():
            erepo_dir.dvc_gen(
                {
                    "dir": {
                        "1": "1",
                        "2": "2",
                        "subdir": {"foo": "foo", "bar": "bar"},
                    }
                },
                commit="create dir",
            )
    
>       Repo.get(os.fspath(erepo_dir), os.path.join("dir", "1"))

/home/user/dvc/tests/func/test_get.py:197: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/get.py:76: in get
    fs.get(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:607: in get
    if not self.isdir(from_info):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:157: in isdir
    return self.fs.isdir(path)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:654: in isdir
    return self.info(path)["type"] == "directory"
/home/user/dvc/dvc/fs/dvc.py:330: in info
    return self._info(key, path, ignore_subrepos=ignore_subrepos)
/home/user/dvc/dvc/fs/dvc.py:340: in _info
    dvc_info = dvc_fs.fs.index.info(subkey)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:413: in info
    entry = self[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:464: in __getitem__
    self._load(dir_key, dir_entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14adaeefd690>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:26:33,681 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo31/dir' to gitignore file.
2023-05-15 22:26:34,127 DEBUG: built tree 'object 761d384d8c6e5e55dfe61b6e7ab3e264.dir'
2023-05-15 22:26:34,141 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:26:34,487 DEBUG: built tree 'object 761d384d8c6e5e55dfe61b6e7ab3e264.dir'
2023-05-15 22:26:34,504 DEBUG: Preparing to transfer data from 'memory://dvc-staging/29f33ba9ce6c11b03157f36849b7cbe0ebba464bd44b91f35b20c3881d0ba7e4' to '/tmp/pytest-of-user/pytest-384/erepo31/.dvc/cache'
2023-05-15 22:26:34,515 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo31/.dvc/cache'
2023-05-15 22:26:34,554 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo31/.dvc/cache'
2023-05-15 22:26:34,709 DEBUG: Preparing to collect status from 'memory://dvc-staging/29f33ba9ce6c11b03157f36849b7cbe0ebba464bd44b91f35b20c3881d0ba7e4'
2023-05-15 22:26:35,521 DEBUG: built tree 'object 761d384d8c6e5e55dfe61b6e7ab3e264.dir'
2023-05-15 22:26:35,575 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:26:35,587 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo31/.iTyhskiHcYhR7z7ezFQa7P.tmp'
2023-05-15 22:26:35,631 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo31/.iTyhskiHcYhR7z7ezFQa7P.tmp'
2023-05-15 22:26:35,642 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo31/.dvc/cache/.kESKQvcy8vjSGgjwS59ieb.tmp'
2023-05-15 22:26:35,662 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo31/dir/2'
2023-05-15 22:26:35,736 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo31/dir/1'
2023-05-15 22:26:35,806 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo31/dir/subdir/foo'
2023-05-15 22:26:35,876 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo31/dir/subdir/bar'
2023-05-15 22:26:36,087 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:26:37,364 DEBUG: Creating external repo /tmp/pytest-of-user/pytest-384/erepo31@None
2023-05-15 22:26:37,378 DEBUG: erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo31' to a temporary dir
2023-05-15 22:26:39,766 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_file_from_dir0/.CYq3UkJSZfoRpY6etBabL6'
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  4.12file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |3.00 [00:00,   19.4obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/4 [00:00<?,     ?file/s][A
  0%|          |Transferring                      4/? [00:00<00:00, 25.15file/s][A
  0%|          |Transferring                      4/? [00:00<00:00, 25.15file/s][A

![A[A

  0%|          |memory://.fkSAcjn6BA2nDQBfjQ2d3y.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.fkSAcjn6BA2nDQBfjQ2d3y.0.00/262 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.65s/file]100% Adding...|██████████|1/1 [00:02,  2.67s/file]      
!Cloning erepo31|          |0.00/? [00:00,      ?obj/s]                                                      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo31/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 761d384d8c6e5e55dfe61b6e7ab3e264.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 761d384d8c6e5e55dfe61b6e7ab3e264.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/29f33ba9ce6c11b03157f36849b7cbe0ebba464bd44b91f35b20c3881d0ba7e4' to '/tmp/pytest-of-user/pytest-384/erepo31/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo31/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo31/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/29f33ba9ce6c11b03157f36849b7cbe0ebba464bd44b91f35b20c3881d0ba7e4'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 761d384d8c6e5e55dfe61b6e7ab3e264.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo31/.iTyhskiHcYhR7z7ezFQa7P.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo31/.iTyhskiHcYhR7z7ezFQa7P.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo31/.dvc/cache/.kESKQvcy8vjSGgjwS59ieb.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo31/dir/2'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo31/dir/1'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo31/dir/subdir/foo'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo31/dir/subdir/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.external_repo:external_repo.py:33 Creating external repo /tmp/pytest-of-user/pytest-384/erepo31@None
DEBUG    dvc.external_repo:external_repo.py:195 erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo31' to a temporary dir
DEBUG    scmrepo.git.backend.pygit2:pygit2.py:505 fetch_refspecs: []
DEBUG    dvc.utils.fs:fs.py:63 Removing '/tmp/pytest-of-user/pytest-384/test_get_file_from_dir0/.CYq3UkJSZfoRpY6etBabL6'
_____________________ test_get_from_subrepos[files1-True] ______________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_get_from_subrepos_files1_0')
erepo_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/erepo37'), is_dvc = True
files = {'dir': {'bar': 'bar'}}

    @pytest.mark.parametrize("is_dvc", [True, False])
    @pytest.mark.parametrize("files", [{"foo": "foo"}, {"dir": {"bar": "bar"}}])
    def test_get_from_subrepos(tmp_dir, erepo_dir, is_dvc, files):
        subrepo = erepo_dir / "subrepo"
        make_subrepo(subrepo, erepo_dir.scm)
        gen = subrepo.dvc_gen if is_dvc else subrepo.scm_gen
        with subrepo.chdir():
            gen(files, commit="add files in subrepo")
    
        key = next(iter(files))
>       Repo.get(os.fspath(erepo_dir), f"subrepo/{key}", out="out")

/home/user/dvc/tests/func/test_get.py:283: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/get.py:76: in get
    fs.get(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:611: in get
    from_infos = list(self.find(from_info))
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:401: in find
    yield from self.fs.find(path)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:454: in find
    for _, dirs, files in self.walk(path, maxdepth, detail=True, **kwargs):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:282: in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:391: in ls
    return self.fs.ls(path, detail=detail, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ada7bbe140>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:27:44,409 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/.dvc/config.local' to gitignore file.
2023-05-15 22:27:44,434 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/.dvc/tmp' to gitignore file.
2023-05-15 22:27:44,457 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/.dvc/cache' to gitignore file.
2023-05-15 22:27:44,495 DEBUG: Removing '/var/tmp/dvc/repo/7541d2575cdd3208ab96f4360ecf8b1d'
2023-05-15 22:27:45,378 DEBUG: Staging files: {'/tmp/pytest-of-user/pytest-384/erepo37/subrepo/.dvc/config', '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/.dvcignore', '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/.dvc/.gitignore'}
Initialized DVC repository.

You can now commit the changes to git.

2023-05-15 22:27:47,332 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/dir' to gitignore file.
2023-05-15 22:27:47,645 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-15 22:27:47,662 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:27:48,006 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-15 22:27:48,025 DEBUG: Preparing to transfer data from 'memory://dvc-staging/8e60cd3561549311ab3ab7a850f0a1cd42ca0f7b65d1bc29ae3c3870f74dceb9' to '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/.dvc/cache'
2023-05-15 22:27:48,042 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/.dvc/cache'
2023-05-15 22:27:48,075 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/.dvc/cache'
2023-05-15 22:27:48,310 DEBUG: Preparing to collect status from 'memory://dvc-staging/8e60cd3561549311ab3ab7a850f0a1cd42ca0f7b65d1bc29ae3c3870f74dceb9'
2023-05-15 22:27:49,171 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-15 22:27:49,215 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:27:49,232 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/.6hAsybLrUzpqMKhtFCysYp.tmp'
2023-05-15 22:27:49,287 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/.6hAsybLrUzpqMKhtFCysYp.tmp'
2023-05-15 22:27:49,310 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/.dvc/cache/.8Xqfrx4cjnzHVuFH8AhrT7.tmp'
2023-05-15 22:27:49,331 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/dir/bar'
2023-05-15 22:27:49,534 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:27:51,080 DEBUG: Creating external repo /tmp/pytest-of-user/pytest-384/erepo37@None
2023-05-15 22:27:51,095 DEBUG: erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo37' to a temporary dir
2023-05-15 22:27:55,265 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_from_subrepos_files1_0/.V9Epb3QbVzpfKFJLo7S4K9'
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.73file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
 50% |█████     |1/2 [00:00<00:00,  8.85files/s][A
                                                [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  8.88file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  8.88file/s][A

![A[A

  0%|          |memory://.LJoanCzCR2hM9UV9SxNzMN.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.LJoanCzCR2hM9UV9SxNzMN0.00/63.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  4.83file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.47s/file]100% Adding...|██████████|1/1 [00:02,  2.50s/file]      
!Cloning erepo37|          |0.00/? [00:00,      ?obj/s]                                                      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/.dvc/config.local' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/.dvc/tmp' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/.dvc/cache' to gitignore file.
DEBUG    dvc.utils.fs:fs.py:63 Removing '/var/tmp/dvc/repo/7541d2575cdd3208ab96f4360ecf8b1d'
DEBUG    dvc.repo.scm_context:scm_context.py:68 Staging files: {'/tmp/pytest-of-user/pytest-384/erepo37/subrepo/.dvc/config', '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/.dvcignore', '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/.dvc/.gitignore'}
INFO     dvc.repo.init:init.py:93 Initialized DVC repository.

INFO     dvc.repo.init:init.py:95 You can now commit the changes to git.

DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/8e60cd3561549311ab3ab7a850f0a1cd42ca0f7b65d1bc29ae3c3870f74dceb9' to '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/8e60cd3561549311ab3ab7a850f0a1cd42ca0f7b65d1bc29ae3c3870f74dceb9'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/.6hAsybLrUzpqMKhtFCysYp.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/.6hAsybLrUzpqMKhtFCysYp.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/.dvc/cache/.8Xqfrx4cjnzHVuFH8AhrT7.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo37/subrepo/dir/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.external_repo:external_repo.py:33 Creating external repo /tmp/pytest-of-user/pytest-384/erepo37@None
DEBUG    dvc.external_repo:external_repo.py:195 erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo37' to a temporary dir
DEBUG    scmrepo.git.backend.pygit2:pygit2.py:505 fetch_refspecs: []
DEBUG    dvc.utils.fs:fs.py:63 Removing '/tmp/pytest-of-user/pytest-384/test_get_from_subrepos_files1_0/.V9Epb3QbVzpfKFJLo7S4K9'
_______________________ test_granular_get_from_subrepos ________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_granular_get_from_subrepo0')
erepo_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/erepo39')

    def test_granular_get_from_subrepos(tmp_dir, erepo_dir):
        subrepo = erepo_dir / "subrepo"
        make_subrepo(subrepo, erepo_dir.scm)
        with subrepo.chdir():
            subrepo.dvc_gen({"dir": {"bar": "bar"}}, commit="files in subrepo")
    
        path = os.path.join("subrepo", "dir", "bar")
>       Repo.get(os.fspath(erepo_dir), path, out="out")

/home/user/dvc/tests/func/test_get.py:295: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/get.py:76: in get
    fs.get(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:607: in get
    if not self.isdir(from_info):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:157: in isdir
    return self.fs.isdir(path)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:654: in isdir
    return self.info(path)["type"] == "directory"
/home/user/dvc/dvc/fs/dvc.py:330: in info
    return self._info(key, path, ignore_subrepos=ignore_subrepos)
/home/user/dvc/dvc/fs/dvc.py:340: in _info
    dvc_info = dvc_fs.fs.index.info(subkey)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:413: in info
    entry = self[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:464: in __getitem__
    self._load(dir_key, dir_entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14add59c47d0>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:28:15,920 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/.dvc/config.local' to gitignore file.
2023-05-15 22:28:15,942 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/.dvc/tmp' to gitignore file.
2023-05-15 22:28:15,968 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/.dvc/cache' to gitignore file.
2023-05-15 22:28:16,010 DEBUG: Removing '/var/tmp/dvc/repo/37cda27375b6c235e57a499e89f6d345'
2023-05-15 22:28:16,792 DEBUG: Staging files: {'/tmp/pytest-of-user/pytest-384/erepo39/subrepo/.dvc/config', '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/.dvcignore', '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/.dvc/.gitignore'}
Initialized DVC repository.

You can now commit the changes to git.

2023-05-15 22:28:18,767 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/dir' to gitignore file.
2023-05-15 22:28:19,083 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-15 22:28:19,098 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:28:19,423 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-15 22:28:19,440 DEBUG: Preparing to transfer data from 'memory://dvc-staging/4f624d518534c8ea2fdcbec01b7c72a535deb8f99e0e0290982c9fe93ffded58' to '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/.dvc/cache'
2023-05-15 22:28:19,461 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/.dvc/cache'
2023-05-15 22:28:19,494 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/.dvc/cache'
2023-05-15 22:28:19,634 DEBUG: Preparing to collect status from 'memory://dvc-staging/4f624d518534c8ea2fdcbec01b7c72a535deb8f99e0e0290982c9fe93ffded58'
2023-05-15 22:28:20,454 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-15 22:28:20,495 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:28:20,509 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/.NkG7ZR93b6yZhkkEiyVF7q.tmp'
2023-05-15 22:28:20,557 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/.NkG7ZR93b6yZhkkEiyVF7q.tmp'
2023-05-15 22:28:20,570 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/.dvc/cache/.PkC3uASzoA9cD3anwx5K6u.tmp'
2023-05-15 22:28:20,588 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/dir/bar'
2023-05-15 22:28:20,823 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:28:22,319 DEBUG: Creating external repo /tmp/pytest-of-user/pytest-384/erepo39@None
2023-05-15 22:28:22,336 DEBUG: erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo39' to a temporary dir
2023-05-15 22:28:26,709 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_granular_get_from_subrepo0/.U9ZWvpJWybYn96KbEAy2K8'
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.66file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.43file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.43file/s][A

![A[A

  0%|          |memory://.aiJcuadDH7dekSyEwbgSgv.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.aiJcuadDH7dekSyEwbgSgv0.00/63.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  5.79file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.34s/file]100% Adding...|██████████|1/1 [00:02,  2.37s/file]      
!Cloning erepo39|          |0.00/? [00:00,      ?obj/s]                                                      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/.dvc/config.local' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/.dvc/tmp' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/.dvc/cache' to gitignore file.
DEBUG    dvc.utils.fs:fs.py:63 Removing '/var/tmp/dvc/repo/37cda27375b6c235e57a499e89f6d345'
DEBUG    dvc.repo.scm_context:scm_context.py:68 Staging files: {'/tmp/pytest-of-user/pytest-384/erepo39/subrepo/.dvc/config', '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/.dvcignore', '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/.dvc/.gitignore'}
INFO     dvc.repo.init:init.py:93 Initialized DVC repository.

INFO     dvc.repo.init:init.py:95 You can now commit the changes to git.

DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/4f624d518534c8ea2fdcbec01b7c72a535deb8f99e0e0290982c9fe93ffded58' to '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/4f624d518534c8ea2fdcbec01b7c72a535deb8f99e0e0290982c9fe93ffded58'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/.NkG7ZR93b6yZhkkEiyVF7q.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/.NkG7ZR93b6yZhkkEiyVF7q.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/.dvc/cache/.PkC3uASzoA9cD3anwx5K6u.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo39/subrepo/dir/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.external_repo:external_repo.py:33 Creating external repo /tmp/pytest-of-user/pytest-384/erepo39@None
DEBUG    dvc.external_repo:external_repo.py:195 erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo39' to a temporary dir
DEBUG    scmrepo.git.backend.pygit2:pygit2.py:505 fetch_refspecs: []
DEBUG    dvc.utils.fs:fs.py:63 Removing '/tmp/pytest-of-user/pytest-384/test_granular_get_from_subrepo0/.U9ZWvpJWybYn96KbEAy2K8'
____________________________ test_get_complete_repo ____________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_get_complete_repo0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_get_complete_repo0'
erepo_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/erepo40')

    def test_get_complete_repo(tmp_dir, dvc, erepo_dir):
        with erepo_dir.chdir():
            erepo_dir.dvc_gen({"foo": "foo"}, commit="add foo")
    
        subrepo = erepo_dir / "subrepo"
        make_subrepo(subrepo, erepo_dir.scm)
        with subrepo.chdir():
            subrepo.dvc_gen({"dir": {"bar": "bar"}}, commit="files in subrepo")
    
>       Repo.get(os.fspath(erepo_dir), "subrepo", out="out_sub")

/home/user/dvc/tests/func/test_get.py:308: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/get.py:76: in get
    fs.get(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:611: in get
    from_infos = list(self.find(from_info))
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:401: in find
    yield from self.fs.find(path)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:454: in find
    for _, dirs, files in self.walk(path, maxdepth, detail=True, **kwargs):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:428: in walk
    yield from self.walk(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:282: in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:391: in ls
    return self.fs.ls(path, detail=detail, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ada7bbec30>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:28:33,701 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo40/foo' to gitignore file.
2023-05-15 22:28:33,853 DEBUG: Computed stage: 'foo.dvc' md5: 'None'
2023-05-15 22:28:34,048 DEBUG: Preparing to transfer data from 'memory://dvc-staging/64fcc2069b2039742556e7e2893577ece9509f57b279519e020295a40349c97a' to '/tmp/pytest-of-user/pytest-384/erepo40/.dvc/cache'
2023-05-15 22:28:34,061 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo40/.dvc/cache'
2023-05-15 22:28:34,073 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo40/.dvc/cache'
2023-05-15 22:28:34,190 DEBUG: Preparing to collect status from 'memory://dvc-staging/64fcc2069b2039742556e7e2893577ece9509f57b279519e020295a40349c97a'
2023-05-15 22:28:34,457 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:28:34,470 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo40/.TfukvVNvFZ8m7BFf6rhSez.tmp'
2023-05-15 22:28:34,527 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo40/.TfukvVNvFZ8m7BFf6rhSez.tmp'
2023-05-15 22:28:34,540 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo40/.dvc/cache/.k6mKQ56byStL6N4xRJoMoL.tmp'
2023-05-15 22:28:34,556 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo40/foo'
2023-05-15 22:28:34,725 DEBUG: Saving information to 'foo.dvc'.

To track the changes with git, run:

	git add .gitignore foo.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:28:37,301 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/.dvc/config.local' to gitignore file.
2023-05-15 22:28:37,324 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/.dvc/tmp' to gitignore file.
2023-05-15 22:28:37,345 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/.dvc/cache' to gitignore file.
2023-05-15 22:28:37,381 DEBUG: Removing '/var/tmp/dvc/repo/23dcea067ef9650943cd1bdf7ad0bef3'
2023-05-15 22:28:38,121 DEBUG: Staging files: {'/tmp/pytest-of-user/pytest-384/erepo40/subrepo/.dvc/config', '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/.dvcignore', '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/.dvc/.gitignore'}
Initialized DVC repository.

You can now commit the changes to git.

2023-05-15 22:28:40,189 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/dir' to gitignore file.
2023-05-15 22:28:40,534 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-15 22:28:40,550 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:28:40,878 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-15 22:28:40,896 DEBUG: Preparing to transfer data from 'memory://dvc-staging/5dc76c1419383212be2ef1e29570394b756f9055d6cf04ffc65042cd7328db4e' to '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/.dvc/cache'
2023-05-15 22:28:40,909 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/.dvc/cache'
2023-05-15 22:28:40,940 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/.dvc/cache'
2023-05-15 22:28:41,069 DEBUG: Preparing to collect status from 'memory://dvc-staging/5dc76c1419383212be2ef1e29570394b756f9055d6cf04ffc65042cd7328db4e'
2023-05-15 22:28:41,859 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-15 22:28:41,899 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:28:41,915 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/.DGEYe6oTqUNGSNhDknsAcN.tmp'
2023-05-15 22:28:41,964 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/.DGEYe6oTqUNGSNhDknsAcN.tmp'
2023-05-15 22:28:41,982 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/.dvc/cache/.keijMxZ4urSGgjsngMA4ps.tmp'
2023-05-15 22:28:42,006 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/dir/bar'
2023-05-15 22:28:42,211 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:28:43,921 DEBUG: Creating external repo /tmp/pytest-of-user/pytest-384/erepo40@None
2023-05-15 22:28:43,936 DEBUG: erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo40' to a temporary dir
2023-05-15 22:28:48,992 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_complete_repo0/.49VgHZikYbNJ7uv22bWdht'
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.69file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
                                                                                [A100% Adding...|██████████|1/1 [00:01<00:00,  1.28s/file]100% Adding...|██████████|1/1 [00:01,  1.31s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.63file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.51file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.51file/s][A

![A[A

  0%|          |memory://.eNKprCBPwG6vNGs3LPqkef.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.eNKprCBPwG6vNGs3LPqkef0.00/63.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  5.61file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.32s/file]100% Adding...|██████████|1/1 [00:02,  2.35s/file]      
!Cloning erepo40|          |0.00/? [00:00,      ?obj/s]                                                      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo40/foo' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'foo.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/64fcc2069b2039742556e7e2893577ece9509f57b279519e020295a40349c97a' to '/tmp/pytest-of-user/pytest-384/erepo40/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo40/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo40/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/64fcc2069b2039742556e7e2893577ece9509f57b279519e020295a40349c97a'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo40/.TfukvVNvFZ8m7BFf6rhSez.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo40/.TfukvVNvFZ8m7BFf6rhSez.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo40/.dvc/cache/.k6mKQ56byStL6N4xRJoMoL.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo40/foo'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'foo.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore foo.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/.dvc/config.local' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/.dvc/tmp' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/.dvc/cache' to gitignore file.
DEBUG    dvc.utils.fs:fs.py:63 Removing '/var/tmp/dvc/repo/23dcea067ef9650943cd1bdf7ad0bef3'
DEBUG    dvc.repo.scm_context:scm_context.py:68 Staging files: {'/tmp/pytest-of-user/pytest-384/erepo40/subrepo/.dvc/config', '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/.dvcignore', '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/.dvc/.gitignore'}
INFO     dvc.repo.init:init.py:93 Initialized DVC repository.

INFO     dvc.repo.init:init.py:95 You can now commit the changes to git.

DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/5dc76c1419383212be2ef1e29570394b756f9055d6cf04ffc65042cd7328db4e' to '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/5dc76c1419383212be2ef1e29570394b756f9055d6cf04ffc65042cd7328db4e'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/.DGEYe6oTqUNGSNhDknsAcN.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/.DGEYe6oTqUNGSNhDknsAcN.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/.dvc/cache/.keijMxZ4urSGgjsngMA4ps.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo40/subrepo/dir/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.external_repo:external_repo.py:33 Creating external repo /tmp/pytest-of-user/pytest-384/erepo40@None
DEBUG    dvc.external_repo:external_repo.py:195 erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo40' to a temporary dir
DEBUG    scmrepo.git.backend.pygit2:pygit2.py:505 fetch_refspecs: []
DEBUG    dvc.utils.fs:fs.py:63 Removing '/tmp/pytest-of-user/pytest-384/test_get_complete_repo0/.49VgHZikYbNJ7uv22bWdht'
_______________________________ test_import_dir ________________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_import_dir0')
scm = Git: '/tmp/pytest-of-user/pytest-384/test_import_dir0/.git'
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_import_dir0'
erepo_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/erepo43')

    def test_import_dir(tmp_dir, scm, dvc, erepo_dir):
        with erepo_dir.chdir():
            erepo_dir.dvc_gen({"dir": {"foo": "foo content"}}, commit="create dir")
    
>       stage = dvc.imp(os.fspath(erepo_dir), "dir", "dir_imported")

/home/user/dvc/tests/func/test_import.py:90: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/imp.py:6: in imp
    return self.imp_url(path, out=out, fname=fname, erepo=erepo, frozen=True, **kwargs)
/home/user/dvc/dvc/repo/__init__.py:65: in wrapper
    return f(repo, *args, **kwargs)
/home/user/dvc/dvc/repo/scm_context.py:151: in run
    return method(repo, *args, **kw)
/home/user/dvc/dvc/repo/imp_url.py:91: in imp_url
    stage.run(jobs=jobs, no_download=no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:577: in run
    self._sync_import(dry, force, kwargs.get("jobs", None), no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:611: in _sync_import
    sync_import(self, dry, force, jobs, no_download)
/home/user/dvc/dvc/stage/imports.py:61: in sync_import
    stage.deps[0].download(
/home/user/dvc/dvc/dependency/repo.py:84: in download
    for odb, objs in self.get_used_objs().items():
/home/user/dvc/dvc/dependency/repo.py:111: in get_used_objs
    used, _, _ = self._get_used_and_obj(**kwargs)
/home/user/dvc/dvc/dependency/repo.py:148: in _get_used_and_obj
    object_store, meta, obj = build(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:244: in build
    meta, obj = _build_tree(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:126: in _build_tree
    for root, _, fnames in walk_iter:
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:282: in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:391: in ls
    return self.fs.ls(path, detail=detail, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ad8bf3a7d0>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:31:38,350 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo43/dir' to gitignore file.
2023-05-15 22:31:38,635 DEBUG: built tree 'object c9818faa4b30b932da3489a3bb179922.dir'
2023-05-15 22:31:38,651 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:31:38,984 DEBUG: built tree 'object c9818faa4b30b932da3489a3bb179922.dir'
2023-05-15 22:31:39,000 DEBUG: Preparing to transfer data from 'memory://dvc-staging/2bf47a8a808b488d8a3084219fa39cc31aa0e74d2cd6ad8a8d8d86ba44e6211d' to '/tmp/pytest-of-user/pytest-384/erepo43/.dvc/cache'
2023-05-15 22:31:39,015 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo43/.dvc/cache'
2023-05-15 22:31:39,046 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo43/.dvc/cache'
2023-05-15 22:31:39,189 DEBUG: Preparing to collect status from 'memory://dvc-staging/2bf47a8a808b488d8a3084219fa39cc31aa0e74d2cd6ad8a8d8d86ba44e6211d'
2023-05-15 22:31:39,925 DEBUG: built tree 'object c9818faa4b30b932da3489a3bb179922.dir'
2023-05-15 22:31:39,976 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:31:39,991 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo43/.c3BHVDa5LwjRJm6aKEfx9N.tmp'
2023-05-15 22:31:40,043 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo43/.c3BHVDa5LwjRJm6aKEfx9N.tmp'
2023-05-15 22:31:40,060 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo43/.dvc/cache/.acJXasbZFgyULdpPTrsRq8.tmp'
2023-05-15 22:31:40,086 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo43/dir/foo'
2023-05-15 22:31:40,289 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:31:42,488 DEBUG: Removing output 'dir_imported' of stage: 'dir_imported.dvc'.
2023-05-15 22:31:42,513 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_import_dir0/dir_imported'
Importing 'dir (/tmp/pytest-of-user/pytest-384/erepo43)' -> 'dir_imported'
2023-05-15 22:31:42,704 DEBUG: Computed stage: 'dir_imported.dvc' md5: '2849c92d236969578b205bd531008091'
2023-05-15 22:31:42,718 DEBUG: 'md5' of stage: 'dir_imported.dvc' changed.
2023-05-15 22:31:42,740 DEBUG: Creating external repo /tmp/pytest-of-user/pytest-384/erepo43@None
2023-05-15 22:31:42,774 DEBUG: erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo43' to a temporary dir
2023-05-15 22:31:44,845 DEBUG: Checking if stage '/dir' is in 'dvc.yaml'
2023-05-15 22:31:45,116 DEBUG: Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/erepo43/.dvc/cache' to '/tmp/pytest-of-user/pytest-384/test_import_dir0/.dvc/cache'
2023-05-15 22:31:45,132 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_import_dir0/.dvc/cache'
2023-05-15 22:31:45,143 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_import_dir0/.dvc/cache'
2023-05-15 22:31:45,225 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo43/.dvc/cache'
2023-05-15 22:31:45,240 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo43/.dvc/cache'
2023-05-15 22:31:45,304 DEBUG: Querying 1 oids via object_exists
2023-05-15 22:31:45,381 DEBUG: Indexing new .dir 'c9818faa4b30b932da3489a3bb179922.dir' with '1' nested files
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.63file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.82file/s][A

![A[A

  0%|          |memory://.WF3aftdQXHrD6VzeEnYL6d.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.WF3aftdQXHrD6VzeEnYL6d0.00/63.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  7.30file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.20s/file]100% Adding...|██████████|1/1 [00:02,  2.24s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Cloning erepo43|          |0.00/? [00:00,      ?obj/s]                                                      !  0% |          |0/? [00:00<?,    ?files/s]                                           !  0% Querying remote cache|          |0/1 [00:00<?,    ?files/s]                                                                !  0% Transferring|          |0/? [00:00<?,     ?file/s]  0% Transferring|          |0/1 [00:00<?,     ?file/s]
![A
  0%|          |/tmp/pytest-of-user/pytest-384/erep0.00/? [00:00<?,        ?B/s][A
  0%|          |/tmp/pytest-of-user/pytest-384/e0.00/63.0 [00:00<?,        ?B/s][A
                                                                                [A100% Transferring|██████████|1/1 [00:00<00:00,  5.07file/s]                                                           !Building data objects from dir          |0.00 [00:00,      ?obj/s]                                                                  
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo43/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object c9818faa4b30b932da3489a3bb179922.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object c9818faa4b30b932da3489a3bb179922.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/2bf47a8a808b488d8a3084219fa39cc31aa0e74d2cd6ad8a8d8d86ba44e6211d' to '/tmp/pytest-of-user/pytest-384/erepo43/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo43/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo43/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/2bf47a8a808b488d8a3084219fa39cc31aa0e74d2cd6ad8a8d8d86ba44e6211d'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object c9818faa4b30b932da3489a3bb179922.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo43/.c3BHVDa5LwjRJm6aKEfx9N.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo43/.c3BHVDa5LwjRJm6aKEfx9N.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo43/.dvc/cache/.acJXasbZFgyULdpPTrsRq8.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo43/dir/foo'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.stage:__init__.py:387 Removing output 'dir_imported' of stage: 'dir_imported.dvc'.
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_import_dir0/dir_imported'
INFO     dvc.stage.imports:imports.py:49 Importing 'dir (/tmp/pytest-of-user/pytest-384/erepo43)' -> 'dir_imported'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir_imported.dvc' md5: '2849c92d236969578b205bd531008091'
DEBUG    dvc.stage:__init__.py:363 'md5' of stage: 'dir_imported.dvc' changed.
DEBUG    dvc.external_repo:external_repo.py:33 Creating external repo /tmp/pytest-of-user/pytest-384/erepo43@None
DEBUG    dvc.external_repo:external_repo.py:195 erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo43' to a temporary dir
DEBUG    scmrepo.git.backend.pygit2:pygit2.py:505 fetch_refspecs: []
DEBUG    dvc.repo.stage:stage.py:80 Checking if stage '/dir' is in 'dvc.yaml'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/erepo43/.dvc/cache' to '/tmp/pytest-of-user/pytest-384/test_import_dir0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_import_dir0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_import_dir0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo43/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo43/.dvc/cache'
DEBUG    dvc_objects.db:db.py:349 Querying 1 oids via object_exists
DEBUG    dvc_data.hashfile.status:status.py:73 Indexing new .dir 'c9818faa4b30b932da3489a3bb179922.dir' with '1' nested files
__________________________ test_import_file_from_dir ___________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_import_file_from_dir0')
scm = Git: '/tmp/pytest-of-user/pytest-384/test_import_file_from_dir0/.git'
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_import_file_from_dir0'
erepo_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/erepo44')

    def test_import_file_from_dir(tmp_dir, scm, dvc, erepo_dir):
        with erepo_dir.chdir():
            erepo_dir.dvc_gen(
                {
                    "dir": {
                        "1": "1",
                        "2": "2",
                        "subdir": {"foo": "foo", "bar": "bar"},
                    }
                },
                commit="create dir",
            )
    
>       stage = dvc.imp(os.fspath(erepo_dir), os.path.join("dir", "1"))

/home/user/dvc/tests/func/test_import.py:113: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/imp.py:6: in imp
    return self.imp_url(path, out=out, fname=fname, erepo=erepo, frozen=True, **kwargs)
/home/user/dvc/dvc/repo/__init__.py:65: in wrapper
    return f(repo, *args, **kwargs)
/home/user/dvc/dvc/repo/scm_context.py:151: in run
    return method(repo, *args, **kw)
/home/user/dvc/dvc/repo/imp_url.py:91: in imp_url
    stage.run(jobs=jobs, no_download=no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:577: in run
    self._sync_import(dry, force, kwargs.get("jobs", None), no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:611: in _sync_import
    sync_import(self, dry, force, jobs, no_download)
/home/user/dvc/dvc/stage/imports.py:61: in sync_import
    stage.deps[0].download(
/home/user/dvc/dvc/dependency/repo.py:84: in download
    for odb, objs in self.get_used_objs().items():
/home/user/dvc/dvc/dependency/repo.py:111: in get_used_objs
    used, _, _ = self._get_used_and_obj(**kwargs)
/home/user/dvc/dvc/dependency/repo.py:148: in _get_used_and_obj
    object_store, meta, obj = build(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:240: in build
    details = fs.info(path)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:467: in info
    return self.fs.info(path, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:330: in info
    return self._info(key, path, ignore_subrepos=ignore_subrepos)
/home/user/dvc/dvc/fs/dvc.py:340: in _info
    dvc_info = dvc_fs.fs.index.info(subkey)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:413: in info
    entry = self[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:464: in __getitem__
    self._load(dir_key, dir_entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14add6983fa0>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:31:58,126 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo44/dir' to gitignore file.
2023-05-15 22:31:58,659 DEBUG: built tree 'object 761d384d8c6e5e55dfe61b6e7ab3e264.dir'
2023-05-15 22:31:58,674 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:31:59,118 DEBUG: built tree 'object 761d384d8c6e5e55dfe61b6e7ab3e264.dir'
2023-05-15 22:31:59,137 DEBUG: Preparing to transfer data from 'memory://dvc-staging/2a9b2ed2aa369820cf64a495b80e57a64f876785f1d835c18351ec9bda8022fe' to '/tmp/pytest-of-user/pytest-384/erepo44/.dvc/cache'
2023-05-15 22:31:59,150 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo44/.dvc/cache'
2023-05-15 22:31:59,196 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo44/.dvc/cache'
2023-05-15 22:31:59,417 DEBUG: Preparing to collect status from 'memory://dvc-staging/2a9b2ed2aa369820cf64a495b80e57a64f876785f1d835c18351ec9bda8022fe'
2023-05-15 22:32:00,341 DEBUG: built tree 'object 761d384d8c6e5e55dfe61b6e7ab3e264.dir'
2023-05-15 22:32:00,404 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:32:00,419 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo44/.SRGXHcJG6nYF2TJt2uVpLY.tmp'
2023-05-15 22:32:00,469 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo44/.SRGXHcJG6nYF2TJt2uVpLY.tmp'
2023-05-15 22:32:00,486 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo44/.dvc/cache/.V2fgnXCEYzvYSiDbuNiy93.tmp'
2023-05-15 22:32:00,506 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo44/dir/2'
2023-05-15 22:32:00,594 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo44/dir/1'
2023-05-15 22:32:00,676 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo44/dir/subdir/foo'
2023-05-15 22:32:00,755 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo44/dir/subdir/bar'
2023-05-15 22:32:01,004 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:32:03,252 DEBUG: Removing output '1' of stage: '1.dvc'.
2023-05-15 22:32:03,280 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_import_file_from_dir0/1'
Importing 'dir/1 (/tmp/pytest-of-user/pytest-384/erepo44)' -> '1'
2023-05-15 22:32:03,632 DEBUG: Computed stage: '1.dvc' md5: 'f14d4b38ffa6dbc70d0c529bc260f23c'
2023-05-15 22:32:03,650 DEBUG: 'md5' of stage: '1.dvc' changed.
2023-05-15 22:32:03,672 DEBUG: Creating external repo /tmp/pytest-of-user/pytest-384/erepo44@None
2023-05-15 22:32:03,688 DEBUG: erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo44' to a temporary dir
2023-05-15 22:32:05,891 DEBUG: Checking if stage '/dir/1' is in 'dvc.yaml'
2023-05-15 22:32:06,186 DEBUG: Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/erepo44/.dvc/cache' to '/tmp/pytest-of-user/pytest-384/test_import_file_from_dir0/.dvc/cache'
2023-05-15 22:32:06,202 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_import_file_from_dir0/.dvc/cache'
2023-05-15 22:32:06,215 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_import_file_from_dir0/.dvc/cache'
2023-05-15 22:32:06,309 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo44/.dvc/cache'
2023-05-15 22:32:06,326 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo44/.dvc/cache'
2023-05-15 22:32:06,401 DEBUG: Querying 1 oids via object_exists
2023-05-15 22:32:06,554 DEBUG: Indexing new .dir '761d384d8c6e5e55dfe61b6e7ab3e264.dir' with '4' nested files
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.68file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |2.00 [00:00,   18.6obj/s][A
Building data objects from dir          |4.00 [00:00,   14.5obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |4.00 [00:00,   34.6obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
100% |██████████|5/5 [00:00<00:00, 43.14files/s][A
                                                [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/4 [00:00<?,     ?file/s][A
  0%|          |Transferring                      4/? [00:00<00:00, 21.97file/s][A
  0%|          |Transferring                      4/? [00:00<00:00, 21.97file/s][A

![A[A

  0%|          |memory://.6tgh3VxCZyUXRKfDMfKAhw.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.6tgh3VxCZyUXRKfDMfKAhw.0.00/262 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |4.00 [00:00,   39.7obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:03<00:00,  3.16s/file]100% Adding...|██████████|1/1 [00:03,  3.19s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Cloning erepo44|          |0.00/? [00:00,      ?obj/s]                                                      !  0% |          |0/? [00:00<?,    ?files/s]                                           !  0% Querying remote cache|          |0/1 [00:00<?,    ?files/s]100% Querying remote cache|██████████|1/1 [00:00<00:00,  8.86files/s]                                                                     !  0% Transferring|          |0/? [00:00<?,     ?file/s]  0% Transferring|          |0/1 [00:00<?,     ?file/s]
![A
  0%|          |/tmp/pytest-of-user/pytest-384/erep0.00/? [00:00<?,        ?B/s][A
  0%|          |/tmp/pytest-of-user/pytest-384/er0.00/262 [00:00<?,        ?B/s][A
                                                                                [A100% Transferring|██████████|1/1 [00:00<00:00,  4.77file/s]                                                           
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo44/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 761d384d8c6e5e55dfe61b6e7ab3e264.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 761d384d8c6e5e55dfe61b6e7ab3e264.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/2a9b2ed2aa369820cf64a495b80e57a64f876785f1d835c18351ec9bda8022fe' to '/tmp/pytest-of-user/pytest-384/erepo44/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo44/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo44/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/2a9b2ed2aa369820cf64a495b80e57a64f876785f1d835c18351ec9bda8022fe'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 761d384d8c6e5e55dfe61b6e7ab3e264.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo44/.SRGXHcJG6nYF2TJt2uVpLY.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo44/.SRGXHcJG6nYF2TJt2uVpLY.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo44/.dvc/cache/.V2fgnXCEYzvYSiDbuNiy93.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo44/dir/2'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo44/dir/1'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo44/dir/subdir/foo'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo44/dir/subdir/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.stage:__init__.py:387 Removing output '1' of stage: '1.dvc'.
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_import_file_from_dir0/1'
INFO     dvc.stage.imports:imports.py:49 Importing 'dir/1 (/tmp/pytest-of-user/pytest-384/erepo44)' -> '1'
DEBUG    dvc.stage:__init__.py:475 Computed stage: '1.dvc' md5: 'f14d4b38ffa6dbc70d0c529bc260f23c'
DEBUG    dvc.stage:__init__.py:363 'md5' of stage: '1.dvc' changed.
DEBUG    dvc.external_repo:external_repo.py:33 Creating external repo /tmp/pytest-of-user/pytest-384/erepo44@None
DEBUG    dvc.external_repo:external_repo.py:195 erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo44' to a temporary dir
DEBUG    scmrepo.git.backend.pygit2:pygit2.py:505 fetch_refspecs: []
DEBUG    dvc.repo.stage:stage.py:80 Checking if stage '/dir/1' is in 'dvc.yaml'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/erepo44/.dvc/cache' to '/tmp/pytest-of-user/pytest-384/test_import_file_from_dir0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_import_file_from_dir0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_import_file_from_dir0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo44/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo44/.dvc/cache'
DEBUG    dvc_objects.db:db.py:349 Querying 1 oids via object_exists
DEBUG    dvc_data.hashfile.status:status.py:73 Indexing new .dir '761d384d8c6e5e55dfe61b6e7ab3e264.dir' with '4' nested files
_______________________ test_import_file_from_dir_to_dir _______________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_import_file_from_dir_to_d0')
scm = Git: '/tmp/pytest-of-user/pytest-384/test_import_file_from_dir_to_d0/.git'
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_import_file_from_dir_to_d0'
erepo_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/erepo45')

    def test_import_file_from_dir_to_dir(tmp_dir, scm, dvc, erepo_dir):
        with erepo_dir.chdir():
            erepo_dir.dvc_gen({"dir": {"foo": "foo"}}, commit="create dir")
    
        with pytest.raises(StagePathNotFoundError):
            dvc.imp(
                os.fspath(erepo_dir),
                os.path.join("dir", "foo"),
                out=os.path.join("dir", "foo"),
            )
    
        tmp_dir.gen({"dir": {}})
>       dvc.imp(
            os.fspath(erepo_dir),
            os.path.join("dir", "foo"),
            out=os.path.join("dir", "foo"),
        )

/home/user/dvc/tests/func/test_import.py:148: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/imp.py:6: in imp
    return self.imp_url(path, out=out, fname=fname, erepo=erepo, frozen=True, **kwargs)
/home/user/dvc/dvc/repo/__init__.py:65: in wrapper
    return f(repo, *args, **kwargs)
/home/user/dvc/dvc/repo/scm_context.py:151: in run
    return method(repo, *args, **kw)
/home/user/dvc/dvc/repo/imp_url.py:91: in imp_url
    stage.run(jobs=jobs, no_download=no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:577: in run
    self._sync_import(dry, force, kwargs.get("jobs", None), no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:611: in _sync_import
    sync_import(self, dry, force, jobs, no_download)
/home/user/dvc/dvc/stage/imports.py:61: in sync_import
    stage.deps[0].download(
/home/user/dvc/dvc/dependency/repo.py:84: in download
    for odb, objs in self.get_used_objs().items():
/home/user/dvc/dvc/dependency/repo.py:111: in get_used_objs
    used, _, _ = self._get_used_and_obj(**kwargs)
/home/user/dvc/dvc/dependency/repo.py:148: in _get_used_and_obj
    object_store, meta, obj = build(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:240: in build
    details = fs.info(path)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:467: in info
    return self.fs.info(path, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:330: in info
    return self._info(key, path, ignore_subrepos=ignore_subrepos)
/home/user/dvc/dvc/fs/dvc.py:340: in _info
    dvc_info = dvc_fs.fs.index.info(subkey)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:413: in info
    entry = self[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:464: in __getitem__
    self._load(dir_key, dir_entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14add58b2640>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:32:16,898 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo45/dir' to gitignore file.
2023-05-15 22:32:17,197 DEBUG: built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
2023-05-15 22:32:17,214 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:32:17,524 DEBUG: built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
2023-05-15 22:32:17,544 DEBUG: Preparing to transfer data from 'memory://dvc-staging/811f92c58aa7d1bdf6ff1ef746d15080f7eccb67e8773fb73929008eadf15287' to '/tmp/pytest-of-user/pytest-384/erepo45/.dvc/cache'
2023-05-15 22:32:17,561 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo45/.dvc/cache'
2023-05-15 22:32:17,592 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo45/.dvc/cache'
2023-05-15 22:32:17,724 DEBUG: Preparing to collect status from 'memory://dvc-staging/811f92c58aa7d1bdf6ff1ef746d15080f7eccb67e8773fb73929008eadf15287'
2023-05-15 22:32:18,471 DEBUG: built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
2023-05-15 22:32:18,509 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:32:18,525 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo45/.hf53JzCTUfrshTzjcxEuTC.tmp'
2023-05-15 22:32:18,562 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo45/.hf53JzCTUfrshTzjcxEuTC.tmp'
2023-05-15 22:32:18,577 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo45/.dvc/cache/.JhXPZuztWZbhrnFnujE8Tq.tmp'
2023-05-15 22:32:18,596 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo45/dir/foo'
2023-05-15 22:32:18,788 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:32:21,059 DEBUG: Removing output 'dir/foo' of stage: 'dir/foo.dvc'.
2023-05-15 22:32:21,080 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_import_file_from_dir_to_d0/dir/foo'
Importing 'dir/foo (/tmp/pytest-of-user/pytest-384/erepo45)' -> 'dir/foo'
2023-05-15 22:32:21,261 DEBUG: Computed stage: 'dir/foo.dvc' md5: '8fd9aaeecf6e4efa788820c20fdc66b7'
2023-05-15 22:32:21,277 DEBUG: 'md5' of stage: 'dir/foo.dvc' changed.
2023-05-15 22:32:21,303 DEBUG: Creating external repo /tmp/pytest-of-user/pytest-384/erepo45@None
2023-05-15 22:32:21,317 DEBUG: erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo45' to a temporary dir
2023-05-15 22:32:23,748 DEBUG: Checking if stage '/dir/foo' is in 'dvc.yaml'
2023-05-15 22:32:24,080 DEBUG: Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/erepo45/.dvc/cache' to '/tmp/pytest-of-user/pytest-384/test_import_file_from_dir_to_d0/.dvc/cache'
2023-05-15 22:32:24,095 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_import_file_from_dir_to_d0/.dvc/cache'
2023-05-15 22:32:24,109 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_import_file_from_dir_to_d0/.dvc/cache'
2023-05-15 22:32:24,204 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo45/.dvc/cache'
2023-05-15 22:32:24,215 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo45/.dvc/cache'
2023-05-15 22:32:24,289 DEBUG: Querying 1 oids via object_exists
2023-05-15 22:32:24,373 DEBUG: Indexing new .dir '84fe43362de8f1634c6fd2900440e9e2.dir' with '1' nested files
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.59file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.57file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.57file/s][A

![A[A

  0%|          |memory://.B4tVSxV295QSwyswxopWBU.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.B4tVSxV295QSwyswxopWBU0.00/63.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  5.48file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.15s/file]100% Adding...|██████████|1/1 [00:02,  2.19s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Cloning erepo45|          |0.00/? [00:00,      ?obj/s]                                                      !  0% |          |0/? [00:00<?,    ?files/s]                                           !  0% Querying remote cache|          |0/1 [00:00<?,    ?files/s]                                                                !  0% Transferring|          |0/? [00:00<?,     ?file/s]  0% Transferring|          |0/1 [00:00<?,     ?file/s]
![A
  0%|          |/tmp/pytest-of-user/pytest-384/erep0.00/? [00:00<?,        ?B/s][A
  0%|          |/tmp/pytest-of-user/pytest-384/e0.00/63.0 [00:00<?,        ?B/s][A
                                                                                [A100% Transferring|██████████|1/1 [00:00<00:00,  5.13file/s]                                                           
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo45/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/811f92c58aa7d1bdf6ff1ef746d15080f7eccb67e8773fb73929008eadf15287' to '/tmp/pytest-of-user/pytest-384/erepo45/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo45/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo45/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/811f92c58aa7d1bdf6ff1ef746d15080f7eccb67e8773fb73929008eadf15287'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 84fe43362de8f1634c6fd2900440e9e2.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo45/.hf53JzCTUfrshTzjcxEuTC.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo45/.hf53JzCTUfrshTzjcxEuTC.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo45/.dvc/cache/.JhXPZuztWZbhrnFnujE8Tq.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo45/dir/foo'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.stage:__init__.py:387 Removing output 'dir/foo' of stage: 'dir/foo.dvc'.
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_import_file_from_dir_to_d0/dir/foo'
INFO     dvc.stage.imports:imports.py:49 Importing 'dir/foo (/tmp/pytest-of-user/pytest-384/erepo45)' -> 'dir/foo'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir/foo.dvc' md5: '8fd9aaeecf6e4efa788820c20fdc66b7'
DEBUG    dvc.stage:__init__.py:363 'md5' of stage: 'dir/foo.dvc' changed.
DEBUG    dvc.external_repo:external_repo.py:33 Creating external repo /tmp/pytest-of-user/pytest-384/erepo45@None
DEBUG    dvc.external_repo:external_repo.py:195 erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo45' to a temporary dir
DEBUG    scmrepo.git.backend.pygit2:pygit2.py:505 fetch_refspecs: []
DEBUG    dvc.repo.stage:stage.py:80 Checking if stage '/dir/foo' is in 'dvc.yaml'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/erepo45/.dvc/cache' to '/tmp/pytest-of-user/pytest-384/test_import_file_from_dir_to_d0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_import_file_from_dir_to_d0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_import_file_from_dir_to_d0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo45/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo45/.dvc/cache'
DEBUG    dvc_objects.db:db.py:349 Querying 1 oids via object_exists
DEBUG    dvc_data.hashfile.status:status.py:73 Indexing new .dir '84fe43362de8f1634c6fd2900440e9e2.dir' with '1' nested files
______________________ test_pull_imported_directory_stage ______________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_pull_imported_directory_s0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_pull_imported_directory_s0'
erepo_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/erepo53')

    def test_pull_imported_directory_stage(tmp_dir, dvc, erepo_dir):
        with erepo_dir.chdir():
            erepo_dir.dvc_gen({"dir": {"foo": "foo content"}}, commit="create dir")
    
>       dvc.imp(os.fspath(erepo_dir), "dir", "dir_imported")

/home/user/dvc/tests/func/test_import.py:294: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/imp.py:6: in imp
    return self.imp_url(path, out=out, fname=fname, erepo=erepo, frozen=True, **kwargs)
/home/user/dvc/dvc/repo/__init__.py:65: in wrapper
    return f(repo, *args, **kwargs)
/home/user/dvc/dvc/repo/scm_context.py:151: in run
    return method(repo, *args, **kw)
/home/user/dvc/dvc/repo/imp_url.py:91: in imp_url
    stage.run(jobs=jobs, no_download=no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:577: in run
    self._sync_import(dry, force, kwargs.get("jobs", None), no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:611: in _sync_import
    sync_import(self, dry, force, jobs, no_download)
/home/user/dvc/dvc/stage/imports.py:61: in sync_import
    stage.deps[0].download(
/home/user/dvc/dvc/dependency/repo.py:84: in download
    for odb, objs in self.get_used_objs().items():
/home/user/dvc/dvc/dependency/repo.py:111: in get_used_objs
    used, _, _ = self._get_used_and_obj(**kwargs)
/home/user/dvc/dvc/dependency/repo.py:148: in _get_used_and_obj
    object_store, meta, obj = build(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:244: in build
    meta, obj = _build_tree(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:126: in _build_tree
    for root, _, fnames in walk_iter:
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:282: in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:391: in ls
    return self.fs.ls(path, detail=detail, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ad79064280>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:34:15,091 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo53/dir' to gitignore file.
2023-05-15 22:34:15,392 DEBUG: built tree 'object c9818faa4b30b932da3489a3bb179922.dir'
2023-05-15 22:34:15,404 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:34:15,692 DEBUG: built tree 'object c9818faa4b30b932da3489a3bb179922.dir'
2023-05-15 22:34:15,709 DEBUG: Preparing to transfer data from 'memory://dvc-staging/7fe3ec06a50885454013395c55c616c4627fb1c1699c955042571cef9fc9f39e' to '/tmp/pytest-of-user/pytest-384/erepo53/.dvc/cache'
2023-05-15 22:34:15,728 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo53/.dvc/cache'
2023-05-15 22:34:15,758 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo53/.dvc/cache'
2023-05-15 22:34:15,871 DEBUG: Preparing to collect status from 'memory://dvc-staging/7fe3ec06a50885454013395c55c616c4627fb1c1699c955042571cef9fc9f39e'
2023-05-15 22:34:16,541 DEBUG: built tree 'object c9818faa4b30b932da3489a3bb179922.dir'
2023-05-15 22:34:16,582 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:34:16,595 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo53/.biGeUiwcPD3qekvQj4qtut.tmp'
2023-05-15 22:34:16,640 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo53/.biGeUiwcPD3qekvQj4qtut.tmp'
2023-05-15 22:34:16,655 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo53/.dvc/cache/.BDbwjQiaFogKPph86LaHdV.tmp'
2023-05-15 22:34:16,683 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo53/dir/foo'
2023-05-15 22:34:16,878 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:34:18,931 DEBUG: Removing output 'dir_imported' of stage: 'dir_imported.dvc'.
2023-05-15 22:34:18,953 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_pull_imported_directory_s0/dir_imported'
Importing 'dir (/tmp/pytest-of-user/pytest-384/erepo53)' -> 'dir_imported'
2023-05-15 22:34:19,118 DEBUG: Computed stage: 'dir_imported.dvc' md5: '6a595a04bf05e8319df45c42ef22680b'
2023-05-15 22:34:19,130 DEBUG: 'md5' of stage: 'dir_imported.dvc' changed.
2023-05-15 22:34:19,154 DEBUG: Creating external repo /tmp/pytest-of-user/pytest-384/erepo53@None
2023-05-15 22:34:19,168 DEBUG: erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo53' to a temporary dir
2023-05-15 22:34:21,213 DEBUG: Checking if stage '/dir' is in 'dvc.yaml'
2023-05-15 22:34:21,507 DEBUG: Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/erepo53/.dvc/cache' to '/tmp/pytest-of-user/pytest-384/test_pull_imported_directory_s0/.dvc/cache'
2023-05-15 22:34:21,519 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_pull_imported_directory_s0/.dvc/cache'
2023-05-15 22:34:21,529 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_pull_imported_directory_s0/.dvc/cache'
2023-05-15 22:34:21,621 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo53/.dvc/cache'
2023-05-15 22:34:21,637 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo53/.dvc/cache'
2023-05-15 22:34:21,707 DEBUG: Querying 1 oids via object_exists
2023-05-15 22:34:21,790 DEBUG: Indexing new .dir 'c9818faa4b30b932da3489a3bb179922.dir' with '1' nested files
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.75file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.69file/s][A

![A[A

  0%|          |memory://.DtorKdZWoqcRgcvpSGeQ7V.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.DtorKdZWoqcRgcvpSGeQ7V0.00/63.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  7.41file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.04s/file]100% Adding...|██████████|1/1 [00:02,  2.07s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Cloning erepo53|          |0.00/? [00:00,      ?obj/s]                                                      !  0% |          |0/? [00:00<?,    ?files/s]                                           !  0% Querying remote cache|          |0/1 [00:00<?,    ?files/s]                                                                !  0% Transferring|          |0/? [00:00<?,     ?file/s]  0% Transferring|          |0/1 [00:00<?,     ?file/s]
![A
  0%|          |/tmp/pytest-of-user/pytest-384/erep0.00/? [00:00<?,        ?B/s][A
  0%|          |/tmp/pytest-of-user/pytest-384/e0.00/63.0 [00:00<?,        ?B/s][A
                                                                                [A100% Transferring|██████████|1/1 [00:00<00:00,  5.15file/s]                                                           !Building data objects from dir          |0.00 [00:00,      ?obj/s]                                                                  
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo53/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object c9818faa4b30b932da3489a3bb179922.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object c9818faa4b30b932da3489a3bb179922.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/7fe3ec06a50885454013395c55c616c4627fb1c1699c955042571cef9fc9f39e' to '/tmp/pytest-of-user/pytest-384/erepo53/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo53/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo53/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/7fe3ec06a50885454013395c55c616c4627fb1c1699c955042571cef9fc9f39e'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object c9818faa4b30b932da3489a3bb179922.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo53/.biGeUiwcPD3qekvQj4qtut.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo53/.biGeUiwcPD3qekvQj4qtut.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo53/.dvc/cache/.BDbwjQiaFogKPph86LaHdV.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo53/dir/foo'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.stage:__init__.py:387 Removing output 'dir_imported' of stage: 'dir_imported.dvc'.
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_pull_imported_directory_s0/dir_imported'
INFO     dvc.stage.imports:imports.py:49 Importing 'dir (/tmp/pytest-of-user/pytest-384/erepo53)' -> 'dir_imported'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir_imported.dvc' md5: '6a595a04bf05e8319df45c42ef22680b'
DEBUG    dvc.stage:__init__.py:363 'md5' of stage: 'dir_imported.dvc' changed.
DEBUG    dvc.external_repo:external_repo.py:33 Creating external repo /tmp/pytest-of-user/pytest-384/erepo53@None
DEBUG    dvc.external_repo:external_repo.py:195 erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo53' to a temporary dir
DEBUG    scmrepo.git.backend.pygit2:pygit2.py:505 fetch_refspecs: []
DEBUG    dvc.repo.stage:stage.py:80 Checking if stage '/dir' is in 'dvc.yaml'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/erepo53/.dvc/cache' to '/tmp/pytest-of-user/pytest-384/test_pull_imported_directory_s0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_pull_imported_directory_s0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_pull_imported_directory_s0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo53/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo53/.dvc/cache'
DEBUG    dvc_objects.db:db.py:349 Querying 1 oids via object_exists
DEBUG    dvc_data.hashfile.status:status.py:73 Indexing new .dir 'c9818faa4b30b932da3489a3bb179922.dir' with '1' nested files
_________________ test_pull_wildcard_imported_directory_stage __________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_pull_wildcard_imported_di0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_pull_wildcard_imported_di0'
erepo_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/erepo54')

    def test_pull_wildcard_imported_directory_stage(tmp_dir, dvc, erepo_dir):
        with erepo_dir.chdir():
            erepo_dir.dvc_gen({"dir123": {"foo": "foo content"}}, commit="create dir")
    
>       dvc.imp(os.fspath(erepo_dir), "dir123", "dir_imported123")

/home/user/dvc/tests/func/test_import.py:308: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/imp.py:6: in imp
    return self.imp_url(path, out=out, fname=fname, erepo=erepo, frozen=True, **kwargs)
/home/user/dvc/dvc/repo/__init__.py:65: in wrapper
    return f(repo, *args, **kwargs)
/home/user/dvc/dvc/repo/scm_context.py:151: in run
    return method(repo, *args, **kw)
/home/user/dvc/dvc/repo/imp_url.py:91: in imp_url
    stage.run(jobs=jobs, no_download=no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:577: in run
    self._sync_import(dry, force, kwargs.get("jobs", None), no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:611: in _sync_import
    sync_import(self, dry, force, jobs, no_download)
/home/user/dvc/dvc/stage/imports.py:61: in sync_import
    stage.deps[0].download(
/home/user/dvc/dvc/dependency/repo.py:84: in download
    for odb, objs in self.get_used_objs().items():
/home/user/dvc/dvc/dependency/repo.py:111: in get_used_objs
    used, _, _ = self._get_used_and_obj(**kwargs)
/home/user/dvc/dvc/dependency/repo.py:148: in _get_used_and_obj
    object_store, meta, obj = build(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:244: in build
    meta, obj = _build_tree(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:126: in _build_tree
    for root, _, fnames in walk_iter:
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:282: in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:391: in ls
    return self.fs.ls(path, detail=detail, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ad75636500>
key = ('dir123',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:34:32,382 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo54/dir123' to gitignore file.
2023-05-15 22:34:32,680 DEBUG: built tree 'object c9818faa4b30b932da3489a3bb179922.dir'
2023-05-15 22:34:32,698 DEBUG: Computed stage: 'dir123.dvc' md5: 'None'
2023-05-15 22:34:33,001 DEBUG: built tree 'object c9818faa4b30b932da3489a3bb179922.dir'
2023-05-15 22:34:33,018 DEBUG: Preparing to transfer data from 'memory://dvc-staging/a4269a4531c510c003bcf12ca56cb3daea8a3e5187541d872713382c75ccc8fe' to '/tmp/pytest-of-user/pytest-384/erepo54/.dvc/cache'
2023-05-15 22:34:33,030 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo54/.dvc/cache'
2023-05-15 22:34:33,058 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo54/.dvc/cache'
2023-05-15 22:34:33,177 DEBUG: Preparing to collect status from 'memory://dvc-staging/a4269a4531c510c003bcf12ca56cb3daea8a3e5187541d872713382c75ccc8fe'
2023-05-15 22:34:33,872 DEBUG: built tree 'object c9818faa4b30b932da3489a3bb179922.dir'
2023-05-15 22:34:33,910 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:34:33,922 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo54/.6JGrf9HCbXtEQosUrCMqvd.tmp'
2023-05-15 22:34:33,966 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo54/.6JGrf9HCbXtEQosUrCMqvd.tmp'
2023-05-15 22:34:33,981 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo54/.dvc/cache/.m5nZdvBevQ3fc6ZbPRr7rr.tmp'
2023-05-15 22:34:34,002 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo54/dir123/foo'
2023-05-15 22:34:34,192 DEBUG: Saving information to 'dir123.dvc'.

To track the changes with git, run:

	git add .gitignore dir123.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:34:36,245 DEBUG: Removing output 'dir_imported123' of stage: 'dir_imported123.dvc'.
2023-05-15 22:34:36,271 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_pull_wildcard_imported_di0/dir_imported123'
Importing 'dir123 (/tmp/pytest-of-user/pytest-384/erepo54)' -> 'dir_imported123'
2023-05-15 22:34:36,454 DEBUG: Computed stage: 'dir_imported123.dvc' md5: '9c61af252a657d88d51cd7297f0142f9'
2023-05-15 22:34:36,462 DEBUG: 'md5' of stage: 'dir_imported123.dvc' changed.
2023-05-15 22:34:36,478 DEBUG: Creating external repo /tmp/pytest-of-user/pytest-384/erepo54@None
2023-05-15 22:34:36,664 DEBUG: erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo54' to a temporary dir
2023-05-15 22:34:38,710 DEBUG: Checking if stage '/dir123' is in 'dvc.yaml'
2023-05-15 22:34:38,991 DEBUG: Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/erepo54/.dvc/cache' to '/tmp/pytest-of-user/pytest-384/test_pull_wildcard_imported_di0/.dvc/cache'
2023-05-15 22:34:39,004 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_pull_wildcard_imported_di0/.dvc/cache'
2023-05-15 22:34:39,018 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_pull_wildcard_imported_di0/.dvc/cache'
2023-05-15 22:34:39,104 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo54/.dvc/cache'
2023-05-15 22:34:39,119 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo54/.dvc/cache'
2023-05-15 22:34:39,183 DEBUG: Querying 1 oids via object_exists
2023-05-15 22:34:39,266 DEBUG: Indexing new .dir 'c9818faa4b30b932da3489a3bb179922.dir' with '1' nested files
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  4.13file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir123          |0.00 [00:00,      ?obj/s][A
                                                                     [A
![A
Building data objects from dir123          |0.00 [00:00,      ?obj/s][A
                                                                     [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.75file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.75file/s][A

![A[A

  0%|          |memory://.aYVC92A8NvVWuvKhHSEfTU.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.aYVC92A8NvVWuvKhHSEfTU0.00/63.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  6.35file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir123          |0.00 [00:00,      ?obj/s][A
                                                                     [A100% Adding...|██████████|1/1 [00:02<00:00,  2.06s/file]100% Adding...|██████████|1/1 [00:02,  2.09s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Cloning erepo54|          |0.00/? [00:00,      ?obj/s]                                                      !  0% |          |0/? [00:00<?,    ?files/s]                                           !  0% Querying remote cache|          |0/1 [00:00<?,    ?files/s]                                                                !  0% Transferring|          |0/? [00:00<?,     ?file/s]  0% Transferring|          |0/1 [00:00<?,     ?file/s]
![A
  0%|          |/tmp/pytest-of-user/pytest-384/erep0.00/? [00:00<?,        ?B/s][A
  0%|          |/tmp/pytest-of-user/pytest-384/e0.00/63.0 [00:00<?,        ?B/s][A
                                                                                [A100% Transferring|██████████|1/1 [00:00<00:00,  5.40file/s]                                                           !Building data objects from dir123          |0.00 [00:00,      ?obj/s]                                                                     
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo54/dir123' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object c9818faa4b30b932da3489a3bb179922.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir123.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object c9818faa4b30b932da3489a3bb179922.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/a4269a4531c510c003bcf12ca56cb3daea8a3e5187541d872713382c75ccc8fe' to '/tmp/pytest-of-user/pytest-384/erepo54/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo54/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo54/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/a4269a4531c510c003bcf12ca56cb3daea8a3e5187541d872713382c75ccc8fe'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object c9818faa4b30b932da3489a3bb179922.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo54/.6JGrf9HCbXtEQosUrCMqvd.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo54/.6JGrf9HCbXtEQosUrCMqvd.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo54/.dvc/cache/.m5nZdvBevQ3fc6ZbPRr7rr.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo54/dir123/foo'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir123.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir123.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.stage:__init__.py:387 Removing output 'dir_imported123' of stage: 'dir_imported123.dvc'.
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_pull_wildcard_imported_di0/dir_imported123'
INFO     dvc.stage.imports:imports.py:49 Importing 'dir123 (/tmp/pytest-of-user/pytest-384/erepo54)' -> 'dir_imported123'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir_imported123.dvc' md5: '9c61af252a657d88d51cd7297f0142f9'
DEBUG    dvc.stage:__init__.py:363 'md5' of stage: 'dir_imported123.dvc' changed.
DEBUG    dvc.external_repo:external_repo.py:33 Creating external repo /tmp/pytest-of-user/pytest-384/erepo54@None
DEBUG    dvc.external_repo:external_repo.py:195 erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo54' to a temporary dir
DEBUG    scmrepo.git.backend.pygit2:pygit2.py:505 fetch_refspecs: []
DEBUG    dvc.repo.stage:stage.py:80 Checking if stage '/dir123' is in 'dvc.yaml'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/erepo54/.dvc/cache' to '/tmp/pytest-of-user/pytest-384/test_pull_wildcard_imported_di0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_pull_wildcard_imported_di0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_pull_wildcard_imported_di0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo54/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo54/.dvc/cache'
DEBUG    dvc_objects.db:db.py:349 Querying 1 oids via object_exists
DEBUG    dvc_data.hashfile.status:status.py:73 Indexing new .dir 'c9818faa4b30b932da3489a3bb179922.dir' with '1' nested files
____________________ test_push_wildcard_from_bare_git_repo _____________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_push_wildcard_from_bare_g0')
make_tmp_dir = <function make_tmp_dir.<locals>.make at 0x14aed327b910>
erepo_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/erepo55')
local_cloud = PosixTmpDir('/tmp/pytest-of-user/pytest-384/local-cloud58')

    def test_push_wildcard_from_bare_git_repo(
        tmp_dir, make_tmp_dir, erepo_dir, local_cloud
    ):
        Git.init(tmp_dir.fs_path, bare=True).close()
    
        erepo_dir.add_remote(config=local_cloud.config)
        with erepo_dir.chdir():
            erepo_dir.dvc_gen(
                {
                    "dir123": {"foo": "foo content"},
                    "dirextra": {"extrafoo": "extra foo content"},
                },
                commit="initial",
            )
        erepo_dir.dvc.push([os.path.join(os.fspath(erepo_dir), "dire*")], glob=True)
    
        erepo_dir.scm.gitpython.repo.create_remote("origin", os.fspath(tmp_dir))
        erepo_dir.scm.gitpython.repo.remote("origin").push("master")
    
        dvc_repo = make_tmp_dir("dvc-repo", scm=True, dvc=True)
        with dvc_repo.chdir():
>           dvc_repo.dvc.imp(os.fspath(tmp_dir), "dirextra")

/home/user/dvc/tests/func/test_import.py:339: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/imp.py:6: in imp
    return self.imp_url(path, out=out, fname=fname, erepo=erepo, frozen=True, **kwargs)
/home/user/dvc/dvc/repo/__init__.py:65: in wrapper
    return f(repo, *args, **kwargs)
/home/user/dvc/dvc/repo/scm_context.py:151: in run
    return method(repo, *args, **kw)
/home/user/dvc/dvc/repo/imp_url.py:91: in imp_url
    stage.run(jobs=jobs, no_download=no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:577: in run
    self._sync_import(dry, force, kwargs.get("jobs", None), no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:611: in _sync_import
    sync_import(self, dry, force, jobs, no_download)
/home/user/dvc/dvc/stage/imports.py:61: in sync_import
    stage.deps[0].download(
/home/user/dvc/dvc/dependency/repo.py:84: in download
    for odb, objs in self.get_used_objs().items():
/home/user/dvc/dvc/dependency/repo.py:111: in get_used_objs
    used, _, _ = self._get_used_and_obj(**kwargs)
/home/user/dvc/dvc/dependency/repo.py:148: in _get_used_and_obj
    object_store, meta, obj = build(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:244: in build
    meta, obj = _build_tree(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:126: in _build_tree
    for root, _, fnames in walk_iter:
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:282: in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:391: in ls
    return self.fs.ls(path, detail=detail, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14add0238fa0>
key = ('dirextra',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:34:48,846 DEBUG: Writing '/tmp/pytest-of-user/pytest-384/erepo55/.dvc/config'.
2023-05-15 22:34:51,428 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo55/dir123' to gitignore file.
2023-05-15 22:34:51,708 DEBUG: built tree 'object c9818faa4b30b932da3489a3bb179922.dir'
2023-05-15 22:34:51,723 DEBUG: Computed stage: 'dir123.dvc' md5: 'None'
2023-05-15 22:34:52,038 DEBUG: built tree 'object c9818faa4b30b932da3489a3bb179922.dir'
2023-05-15 22:34:52,057 DEBUG: Preparing to transfer data from 'memory://dvc-staging/ed762be3bbcc7a7ec1436916a02bd7549e96857e46fea571e2c564ec85f0d6a4' to '/tmp/pytest-of-user/pytest-384/erepo55/.dvc/cache'
2023-05-15 22:34:52,069 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo55/.dvc/cache'
2023-05-15 22:34:52,099 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo55/.dvc/cache'
2023-05-15 22:34:52,220 DEBUG: Preparing to collect status from 'memory://dvc-staging/ed762be3bbcc7a7ec1436916a02bd7549e96857e46fea571e2c564ec85f0d6a4'
2023-05-15 22:34:52,878 DEBUG: built tree 'object c9818faa4b30b932da3489a3bb179922.dir'
2023-05-15 22:34:52,917 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:34:52,932 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo55/.RGc8cdnD4BtpSt6AAdWcXP.tmp'
2023-05-15 22:34:52,979 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo55/.RGc8cdnD4BtpSt6AAdWcXP.tmp'
2023-05-15 22:34:52,994 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo55/.dvc/cache/.EeoKH5mkCeKTgy7wstLeuX.tmp'
2023-05-15 22:34:53,018 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo55/dir123/foo'
2023-05-15 22:34:53,204 DEBUG: Saving information to 'dir123.dvc'.
2023-05-15 22:34:53,438 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo55/dirextra' to gitignore file.
2023-05-15 22:34:53,706 DEBUG: built tree 'object a7193c168eb42bbd9a102ddb0217259b.dir'
2023-05-15 22:34:53,721 DEBUG: Computed stage: 'dirextra.dvc' md5: 'None'
2023-05-15 22:34:54,009 DEBUG: built tree 'object a7193c168eb42bbd9a102ddb0217259b.dir'
2023-05-15 22:34:54,026 DEBUG: Preparing to transfer data from 'memory://dvc-staging/ed762be3bbcc7a7ec1436916a02bd7549e96857e46fea571e2c564ec85f0d6a4' to '/tmp/pytest-of-user/pytest-384/erepo55/.dvc/cache'
2023-05-15 22:34:54,039 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo55/.dvc/cache'
2023-05-15 22:34:54,068 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo55/.dvc/cache'
2023-05-15 22:34:54,194 DEBUG: Preparing to collect status from 'memory://dvc-staging/ed762be3bbcc7a7ec1436916a02bd7549e96857e46fea571e2c564ec85f0d6a4'
2023-05-15 22:34:54,872 DEBUG: built tree 'object a7193c168eb42bbd9a102ddb0217259b.dir'
2023-05-15 22:34:54,909 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:34:54,922 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo55/.coCybj3JKEoACfjzVNKYJP.tmp'
2023-05-15 22:34:54,964 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo55/.coCybj3JKEoACfjzVNKYJP.tmp'
2023-05-15 22:34:54,978 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo55/.dvc/cache/.M66yuP88ozESzJ5BQuo5JM.tmp'
2023-05-15 22:34:54,997 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo55/dirextra/extrafoo'
2023-05-15 22:34:55,196 DEBUG: Saving information to 'dirextra.dvc'.

To track the changes with git, run:

	git add .gitignore dirextra.dvc dir123.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:34:57,578 DEBUG: Checking if stage '/tmp/pytest-of-user/pytest-384/erepo55/dirextra' is in 'dvc.yaml'
2023-05-15 22:34:58,088 DEBUG: Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/erepo55/.dvc/cache' to '/tmp/pytest-of-user/pytest-384/local-cloud58'
2023-05-15 22:34:58,102 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/local-cloud58'
2023-05-15 22:34:58,114 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/local-cloud58'
2023-05-15 22:34:58,189 DEBUG: Querying 1 oids via object_exists
2023-05-15 22:34:58,349 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo55/.dvc/cache'
2023-05-15 22:34:58,363 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo55/.dvc/cache'
2023-05-15 22:34:58,939 DEBUG: Indexing pushed dir 'md5: a7193c168eb42bbd9a102ddb0217259b.dir' with '1' nested files
2023-05-15 22:35:01,401 DEBUG: Removing output 'dirextra' of stage: 'dirextra.dvc'.
2023-05-15 22:35:01,426 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/dvc-repo0/dirextra'
Importing 'dirextra (/tmp/pytest-of-user/pytest-384/test_push_wildcard_from_bare_g0)' -> 'dirextra'
2023-05-15 22:35:01,626 DEBUG: Computed stage: 'dirextra.dvc' md5: 'c3c564894871c1dd6c318cd397f93457'
2023-05-15 22:35:01,641 DEBUG: 'md5' of stage: 'dirextra.dvc' changed.
2023-05-15 22:35:01,662 DEBUG: Creating external repo /tmp/pytest-of-user/pytest-384/test_push_wildcard_from_bare_g0@None
2023-05-15 22:35:01,677 DEBUG: erepo: git clone '/tmp/pytest-of-user/pytest-384/test_push_wildcard_from_bare_g0' to a temporary dir
2023-05-15 22:35:03,252 DEBUG: Checking if stage '/dirextra' is in 'dvc.yaml'
2023-05-15 22:35:03,566 DEBUG: Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/local-cloud58' to '/tmp/pytest-of-user/pytest-384/dvc-repo0/.dvc/cache'
2023-05-15 22:35:03,577 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/dvc-repo0/.dvc/cache'
2023-05-15 22:35:03,589 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/dvc-repo0/.dvc/cache'
2023-05-15 22:35:03,667 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/local-cloud58'
2023-05-15 22:35:03,680 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/local-cloud58'
2023-05-15 22:35:03,745 DEBUG: Querying 1 oids via object_exists
2023-05-15 22:35:03,834 DEBUG: Indexing new .dir 'a7193c168eb42bbd9a102ddb0217259b.dir' with '1' nested files
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.80file/s]Collecting targets          |2.00 [00:00,  5.13file/s]                                                      !  0% Adding...|          |0/2 [00:00<?,     ?file/s]
![A
Building data objects from dir123          |0.00 [00:00,      ?obj/s][A
                                                                     [A
![A
Building data objects from dir123          |0.00 [00:00,      ?obj/s][A
                                                                     [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.86file/s][A

![A[A

  0%|          |memory://.XfU85xJBnCZQuGFNA322P3.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.XfU85xJBnCZQuGFNA322P30.00/63.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  7.57file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir123          |0.00 [00:00,      ?obj/s][A
                                                                     [A 50% Adding...|█████     | dir123 |1/2 [00:02<00:02,  2.01s/file]
![A
Building data objects from dirextra          |0.00 [00:00,      ?obj/s][A
                                                                       [A
![A
Building data objects from dirextra          |0.00 [00:00,      ?obj/s][A
                                                                       [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.91file/s][A

![A[A

  0%|          |memory://.7crawiEduPDCgz8zY6CZ2q.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.7crawiEduPDCgz8zY6CZ2q0.00/68.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  8.09file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dirextra          |0.00 [00:00,      ?obj/s][A
                                                                       [A100% Adding...|██████████| dirextra |2/2 [00:04<00:00,  2.01s/file]100% Adding...|██████████|2/2 [00:04,  2.02s/file]                 
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !  0% Querying remote cache|          |0/1 [00:00<?,    ?files/s]                                                                !  0% |          |0/? [00:00<?,    ?files/s]                                           !  0% |          |0/? [00:00<?,    ?files/s]                                           !  0% Transferring|          |0/? [00:00<?,     ?file/s]  0% Transferring|          |0/1 [00:00<?,     ?file/s]
![A
  0%|          |/tmp/pytest-of-user/pytest-384/erep0.00/? [00:00<?,        ?B/s][A
  0%|          |/tmp/pytest-of-user/pytest-384/e0.00/17.0 [00:00<?,        ?B/s][A
                                                                                [A100% Transferring|██████████|1/1 [00:00<00:00,  5.16file/s]100% Transferring|██████████|1/1 [00:00<00:00,  5.16file/s]
![A
  0%|          |/tmp/pytest-of-user/pytest-384/erep0.00/? [00:00<?,        ?B/s][A
  0%|          |/tmp/pytest-of-user/pytest-384/e0.00/68.0 [00:00<?,        ?B/s][A
                                                                                [A  0% Transferring|          |2/? [00:00<00:00,  4.98file/s]                                                           !If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Cloning test_push_wildcard_from_bare_g0|          |0.00/? [00:00,      ?obj/s]                                                                              !  0% |          |0/? [00:00<?,    ?files/s]                                           !  0% Querying remote cache|          |0/1 [00:00<?,    ?files/s]                                                                !  0% Transferring|          |0/? [00:00<?,     ?file/s]  0% Transferring|          |0/1 [00:00<?,     ?file/s]
![A
  0%|          |/tmp/pytest-of-user/pytest-384/loca0.00/? [00:00<?,        ?B/s][A
  0%|          |/tmp/pytest-of-user/pytest-384/l0.00/68.0 [00:00<?,        ?B/s][A
                                                                                [A100% Transferring|██████████|1/1 [00:00<00:00,  5.24file/s]                                                           !Building data objects from dirextra          |0.00 [00:00,      ?obj/s]                                                                       
------------------------------ Captured log call -------------------------------
DEBUG    dvc.config:config.py:206 Writing '/tmp/pytest-of-user/pytest-384/erepo55/.dvc/config'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo55/dir123' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object c9818faa4b30b932da3489a3bb179922.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir123.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object c9818faa4b30b932da3489a3bb179922.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/ed762be3bbcc7a7ec1436916a02bd7549e96857e46fea571e2c564ec85f0d6a4' to '/tmp/pytest-of-user/pytest-384/erepo55/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo55/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo55/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/ed762be3bbcc7a7ec1436916a02bd7549e96857e46fea571e2c564ec85f0d6a4'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object c9818faa4b30b932da3489a3bb179922.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo55/.RGc8cdnD4BtpSt6AAdWcXP.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo55/.RGc8cdnD4BtpSt6AAdWcXP.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo55/.dvc/cache/.EeoKH5mkCeKTgy7wstLeuX.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo55/dir123/foo'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir123.dvc'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo55/dirextra' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object a7193c168eb42bbd9a102ddb0217259b.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dirextra.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object a7193c168eb42bbd9a102ddb0217259b.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/ed762be3bbcc7a7ec1436916a02bd7549e96857e46fea571e2c564ec85f0d6a4' to '/tmp/pytest-of-user/pytest-384/erepo55/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo55/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo55/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/ed762be3bbcc7a7ec1436916a02bd7549e96857e46fea571e2c564ec85f0d6a4'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object a7193c168eb42bbd9a102ddb0217259b.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo55/.coCybj3JKEoACfjzVNKYJP.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo55/.coCybj3JKEoACfjzVNKYJP.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo55/.dvc/cache/.M66yuP88ozESzJ5BQuo5JM.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo55/dirextra/extrafoo'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dirextra.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dirextra.dvc dir123.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.repo.stage:stage.py:80 Checking if stage '/tmp/pytest-of-user/pytest-384/erepo55/dirextra' is in 'dvc.yaml'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/erepo55/.dvc/cache' to '/tmp/pytest-of-user/pytest-384/local-cloud58'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/local-cloud58'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/local-cloud58'
DEBUG    dvc_objects.db:db.py:349 Querying 1 oids via object_exists
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo55/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo55/.dvc/cache'
DEBUG    dvc_data.hashfile.transfer:transfer.py:132 Indexing pushed dir 'md5: a7193c168eb42bbd9a102ddb0217259b.dir' with '1' nested files
DEBUG    git.cmd:cmd.py:976 Popen(['git', 'remote', 'add', '--', 'origin', '/tmp/pytest-of-user/pytest-384/test_push_wildcard_from_bare_g0'], cwd=/tmp/pytest-of-user/pytest-384/erepo55, universal_newlines=False, shell=None, istream=None)
DEBUG    git.cmd:cmd.py:976 Popen(['git', 'push', '--porcelain', '--', 'origin', 'master'], cwd=/tmp/pytest-of-user/pytest-384/erepo55, universal_newlines=True, shell=None, istream=None)
DEBUG    dvc.stage:__init__.py:387 Removing output 'dirextra' of stage: 'dirextra.dvc'.
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/dvc-repo0/dirextra'
INFO     dvc.stage.imports:imports.py:49 Importing 'dirextra (/tmp/pytest-of-user/pytest-384/test_push_wildcard_from_bare_g0)' -> 'dirextra'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dirextra.dvc' md5: 'c3c564894871c1dd6c318cd397f93457'
DEBUG    dvc.stage:__init__.py:363 'md5' of stage: 'dirextra.dvc' changed.
DEBUG    dvc.external_repo:external_repo.py:33 Creating external repo /tmp/pytest-of-user/pytest-384/test_push_wildcard_from_bare_g0@None
DEBUG    dvc.external_repo:external_repo.py:195 erepo: git clone '/tmp/pytest-of-user/pytest-384/test_push_wildcard_from_bare_g0' to a temporary dir
DEBUG    scmrepo.git.backend.pygit2:pygit2.py:505 fetch_refspecs: []
DEBUG    dvc.repo.stage:stage.py:80 Checking if stage '/dirextra' is in 'dvc.yaml'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/local-cloud58' to '/tmp/pytest-of-user/pytest-384/dvc-repo0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/dvc-repo0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/dvc-repo0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/local-cloud58'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/local-cloud58'
DEBUG    dvc_objects.db:db.py:349 Querying 1 oids via object_exists
DEBUG    dvc_data.hashfile.status:status.py:73 Indexing new .dir 'a7193c168eb42bbd9a102ddb0217259b.dir' with '1' nested files
______________________ test_import_subrepos[files1-True] _______________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_import_subrepos_files1_Tr0')
erepo_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/erepo68')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_import_subrepos_files1_Tr0'
scm = Git: '/tmp/pytest-of-user/pytest-384/test_import_subrepos_files1_Tr0/.git'
is_dvc = True, files = {'dir': {'bar': 'bar'}}

    @pytest.mark.parametrize("is_dvc", [True, False])
    @pytest.mark.parametrize("files", [{"foo": "foo"}, {"dir": {"bar": "bar"}}])
    def test_import_subrepos(tmp_dir, erepo_dir, dvc, scm, is_dvc, files):
        subrepo = erepo_dir / "subrepo"
        make_subrepo(subrepo, erepo_dir.scm)
        gen = subrepo.dvc_gen if is_dvc else subrepo.scm_gen
        with subrepo.chdir():
            gen(files, commit="add files in subrepo")
    
        key = next(iter(files))
        path = str((subrepo / key).relative_to(erepo_dir))
    
>       stage = dvc.imp(os.fspath(erepo_dir), path, out="out")

/home/user/dvc/tests/func/test_import.py:499: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/imp.py:6: in imp
    return self.imp_url(path, out=out, fname=fname, erepo=erepo, frozen=True, **kwargs)
/home/user/dvc/dvc/repo/__init__.py:65: in wrapper
    return f(repo, *args, **kwargs)
/home/user/dvc/dvc/repo/scm_context.py:151: in run
    return method(repo, *args, **kw)
/home/user/dvc/dvc/repo/imp_url.py:91: in imp_url
    stage.run(jobs=jobs, no_download=no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:577: in run
    self._sync_import(dry, force, kwargs.get("jobs", None), no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:611: in _sync_import
    sync_import(self, dry, force, jobs, no_download)
/home/user/dvc/dvc/stage/imports.py:61: in sync_import
    stage.deps[0].download(
/home/user/dvc/dvc/dependency/repo.py:84: in download
    for odb, objs in self.get_used_objs().items():
/home/user/dvc/dvc/dependency/repo.py:111: in get_used_objs
    used, _, _ = self._get_used_and_obj(**kwargs)
/home/user/dvc/dvc/dependency/repo.py:148: in _get_used_and_obj
    object_store, meta, obj = build(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:244: in build
    meta, obj = _build_tree(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:126: in _build_tree
    for root, _, fnames in walk_iter:
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:282: in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:391: in ls
    return self.fs.ls(path, detail=detail, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ad5cce8c80>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:38:35,613 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/.dvc/config.local' to gitignore file.
2023-05-15 22:38:35,640 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/.dvc/tmp' to gitignore file.
2023-05-15 22:38:35,664 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/.dvc/cache' to gitignore file.
2023-05-15 22:38:35,702 DEBUG: Removing '/var/tmp/dvc/repo/dbad98d4424becbf56412c239c082c72'
2023-05-15 22:38:36,461 DEBUG: Staging files: {'/tmp/pytest-of-user/pytest-384/erepo68/subrepo/.dvc/.gitignore', '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/.dvc/config', '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/.dvcignore'}
Initialized DVC repository.

You can now commit the changes to git.

2023-05-15 22:38:38,655 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/dir' to gitignore file.
2023-05-15 22:38:38,959 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-15 22:38:38,979 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:38:39,284 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-15 22:38:39,302 DEBUG: Preparing to transfer data from 'memory://dvc-staging/14ca5c979e23815729e455cd4b153a1c4110baa8f55f0338a7bc6e3fd85b30a0' to '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/.dvc/cache'
2023-05-15 22:38:39,314 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/.dvc/cache'
2023-05-15 22:38:39,346 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/.dvc/cache'
2023-05-15 22:38:39,482 DEBUG: Preparing to collect status from 'memory://dvc-staging/14ca5c979e23815729e455cd4b153a1c4110baa8f55f0338a7bc6e3fd85b30a0'
2023-05-15 22:38:40,252 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-15 22:38:40,293 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:38:40,307 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/.73z6g9pE6pfiimkQgX9ipM.tmp'
2023-05-15 22:38:40,354 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/.73z6g9pE6pfiimkQgX9ipM.tmp'
2023-05-15 22:38:40,370 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/.dvc/cache/.VA4LoGfn3MqLFhfzTFY9ZQ.tmp'
2023-05-15 22:38:40,393 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/dir/bar'
2023-05-15 22:38:40,600 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:38:43,077 DEBUG: Removing output 'out' of stage: 'out.dvc'.
2023-05-15 22:38:43,106 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_import_subrepos_files1_Tr0/out'
Importing 'subrepo/dir (/tmp/pytest-of-user/pytest-384/erepo68)' -> 'out'
2023-05-15 22:38:43,321 DEBUG: Computed stage: 'out.dvc' md5: 'f65a1c00cb7f3737171b517e56463dbf'
2023-05-15 22:38:43,334 DEBUG: 'md5' of stage: 'out.dvc' changed.
2023-05-15 22:38:43,355 DEBUG: Creating external repo /tmp/pytest-of-user/pytest-384/erepo68@None
2023-05-15 22:38:43,370 DEBUG: erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo68' to a temporary dir
2023-05-15 22:38:45,600 DEBUG: Checking if stage '/subrepo/dir' is in 'dvc.yaml'
2023-05-15 22:38:45,640 DEBUG: Assuming '/subrepo/dir' to be a stage inside 'dvc.yaml'
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.31file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  8.44file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  8.44file/s][A

![A[A

  0%|          |memory://.FMtgHwTDGhVhUz99RfCi6d.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.FMtgHwTDGhVhUz99RfCi6d0.00/63.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  5.79file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.22s/file]100% Adding...|██████████|1/1 [00:02,  2.26s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Cloning erepo68|          |0.00/? [00:00,      ?obj/s]                                                      !Building data objects from subrepo/dir          |0.00 [00:00,      ?obj/s]                                                                          
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/.dvc/config.local' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/.dvc/tmp' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/.dvc/cache' to gitignore file.
DEBUG    dvc.utils.fs:fs.py:63 Removing '/var/tmp/dvc/repo/dbad98d4424becbf56412c239c082c72'
DEBUG    dvc.repo.scm_context:scm_context.py:68 Staging files: {'/tmp/pytest-of-user/pytest-384/erepo68/subrepo/.dvc/.gitignore', '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/.dvc/config', '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/.dvcignore'}
INFO     dvc.repo.init:init.py:93 Initialized DVC repository.

INFO     dvc.repo.init:init.py:95 You can now commit the changes to git.

DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/14ca5c979e23815729e455cd4b153a1c4110baa8f55f0338a7bc6e3fd85b30a0' to '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/14ca5c979e23815729e455cd4b153a1c4110baa8f55f0338a7bc6e3fd85b30a0'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/.73z6g9pE6pfiimkQgX9ipM.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/.73z6g9pE6pfiimkQgX9ipM.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/.dvc/cache/.VA4LoGfn3MqLFhfzTFY9ZQ.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo68/subrepo/dir/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.stage:__init__.py:387 Removing output 'out' of stage: 'out.dvc'.
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_import_subrepos_files1_Tr0/out'
INFO     dvc.stage.imports:imports.py:49 Importing 'subrepo/dir (/tmp/pytest-of-user/pytest-384/erepo68)' -> 'out'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'out.dvc' md5: 'f65a1c00cb7f3737171b517e56463dbf'
DEBUG    dvc.stage:__init__.py:363 'md5' of stage: 'out.dvc' changed.
DEBUG    dvc.external_repo:external_repo.py:33 Creating external repo /tmp/pytest-of-user/pytest-384/erepo68@None
DEBUG    dvc.external_repo:external_repo.py:195 erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo68' to a temporary dir
DEBUG    scmrepo.git.backend.pygit2:pygit2.py:505 fetch_refspecs: []
DEBUG    dvc.repo.stage:stage.py:80 Checking if stage '/subrepo/dir' is in 'dvc.yaml'
DEBUG    dvc.repo.stage:stage.py:218 Assuming '/subrepo/dir' to be a stage inside 'dvc.yaml'
______________________ test_granular_import_from_subrepos ______________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_granular_import_from_subr0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_granular_import_from_subr0'
erepo_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/erepo70')

    def test_granular_import_from_subrepos(tmp_dir, dvc, erepo_dir):
        subrepo = erepo_dir / "subrepo"
        make_subrepo(subrepo, erepo_dir.scm)
        with subrepo.chdir():
            subrepo.dvc_gen({"dir": {"bar": "bar"}}, commit="files in subrepo")
    
        path = os.path.join("subrepo", "dir", "bar")
>       stage = dvc.imp(os.fspath(erepo_dir), path, out="out")

/home/user/dvc/tests/func/test_import.py:516: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/imp.py:6: in imp
    return self.imp_url(path, out=out, fname=fname, erepo=erepo, frozen=True, **kwargs)
/home/user/dvc/dvc/repo/__init__.py:65: in wrapper
    return f(repo, *args, **kwargs)
/home/user/dvc/dvc/repo/scm_context.py:151: in run
    return method(repo, *args, **kw)
/home/user/dvc/dvc/repo/imp_url.py:91: in imp_url
    stage.run(jobs=jobs, no_download=no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:577: in run
    self._sync_import(dry, force, kwargs.get("jobs", None), no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:611: in _sync_import
    sync_import(self, dry, force, jobs, no_download)
/home/user/dvc/dvc/stage/imports.py:61: in sync_import
    stage.deps[0].download(
/home/user/dvc/dvc/dependency/repo.py:84: in download
    for odb, objs in self.get_used_objs().items():
/home/user/dvc/dvc/dependency/repo.py:111: in get_used_objs
    used, _, _ = self._get_used_and_obj(**kwargs)
/home/user/dvc/dvc/dependency/repo.py:148: in _get_used_and_obj
    object_store, meta, obj = build(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:240: in build
    details = fs.info(path)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:467: in info
    return self.fs.info(path, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:330: in info
    return self._info(key, path, ignore_subrepos=ignore_subrepos)
/home/user/dvc/dvc/fs/dvc.py:340: in _info
    dvc_info = dvc_fs.fs.index.info(subkey)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:413: in info
    entry = self[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:464: in __getitem__
    self._load(dir_key, dir_entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ad748fa500>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:39:12,556 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/.dvc/config.local' to gitignore file.
2023-05-15 22:39:12,581 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/.dvc/tmp' to gitignore file.
2023-05-15 22:39:12,605 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/.dvc/cache' to gitignore file.
2023-05-15 22:39:12,642 DEBUG: Removing '/var/tmp/dvc/repo/ecf11209c0e80e7ca657784c84d8e822'
2023-05-15 22:39:13,397 DEBUG: Staging files: {'/tmp/pytest-of-user/pytest-384/erepo70/subrepo/.dvcignore', '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/.dvc/config', '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/.dvc/.gitignore'}
Initialized DVC repository.

You can now commit the changes to git.

2023-05-15 22:39:15,438 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/dir' to gitignore file.
2023-05-15 22:39:15,707 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-15 22:39:15,723 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:39:16,029 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-15 22:39:16,047 DEBUG: Preparing to transfer data from 'memory://dvc-staging/540823e916760388f3e8dc150e1713d6fa53055832ac20c713e3d42e8090fc33' to '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/.dvc/cache'
2023-05-15 22:39:16,062 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/.dvc/cache'
2023-05-15 22:39:16,096 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/.dvc/cache'
2023-05-15 22:39:16,222 DEBUG: Preparing to collect status from 'memory://dvc-staging/540823e916760388f3e8dc150e1713d6fa53055832ac20c713e3d42e8090fc33'
2023-05-15 22:39:16,892 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-15 22:39:16,932 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:39:16,945 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/.9dFgt4yPHzDmsniywVuiq4.tmp'
2023-05-15 22:39:16,989 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/.9dFgt4yPHzDmsniywVuiq4.tmp'
2023-05-15 22:39:17,005 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/.dvc/cache/.SDj63zeij6bc7TnXrMPGji.tmp'
2023-05-15 22:39:17,026 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/dir/bar'
2023-05-15 22:39:17,212 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:39:19,375 DEBUG: Removing output 'out' of stage: 'out.dvc'.
2023-05-15 22:39:19,401 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_granular_import_from_subr0/out'
Importing 'subrepo/dir/bar (/tmp/pytest-of-user/pytest-384/erepo70)' -> 'out'
2023-05-15 22:39:19,577 DEBUG: Computed stage: 'out.dvc' md5: 'd98f1fdfcc266cc1af3fe1ffa49b2db2'
2023-05-15 22:39:19,591 DEBUG: 'md5' of stage: 'out.dvc' changed.
2023-05-15 22:39:19,610 DEBUG: Creating external repo /tmp/pytest-of-user/pytest-384/erepo70@None
2023-05-15 22:39:19,625 DEBUG: erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo70' to a temporary dir
2023-05-15 22:39:21,585 DEBUG: Checking if stage '/subrepo/dir/bar' is in 'dvc.yaml'
2023-05-15 22:39:21,612 DEBUG: Assuming '/subrepo/dir/bar' to be a stage inside 'dvc.yaml'
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.54file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00, 11.08file/s][A

![A[A

  0%|          |memory://.bXEsYy2bbenFwfS5Tr58wB.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.bXEsYy2bbenFwfS5Tr58wB0.00/63.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  7.81file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.03s/file]100% Adding...|██████████|1/1 [00:02,  2.06s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Cloning erepo70|          |0.00/? [00:00,      ?obj/s]                                                      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/.dvc/config.local' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/.dvc/tmp' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/.dvc/cache' to gitignore file.
DEBUG    dvc.utils.fs:fs.py:63 Removing '/var/tmp/dvc/repo/ecf11209c0e80e7ca657784c84d8e822'
DEBUG    dvc.repo.scm_context:scm_context.py:68 Staging files: {'/tmp/pytest-of-user/pytest-384/erepo70/subrepo/.dvcignore', '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/.dvc/config', '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/.dvc/.gitignore'}
INFO     dvc.repo.init:init.py:93 Initialized DVC repository.

INFO     dvc.repo.init:init.py:95 You can now commit the changes to git.

DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/540823e916760388f3e8dc150e1713d6fa53055832ac20c713e3d42e8090fc33' to '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/540823e916760388f3e8dc150e1713d6fa53055832ac20c713e3d42e8090fc33'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/.9dFgt4yPHzDmsniywVuiq4.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/.9dFgt4yPHzDmsniywVuiq4.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/.dvc/cache/.SDj63zeij6bc7TnXrMPGji.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo70/subrepo/dir/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.stage:__init__.py:387 Removing output 'out' of stage: 'out.dvc'.
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_granular_import_from_subr0/out'
INFO     dvc.stage.imports:imports.py:49 Importing 'subrepo/dir/bar (/tmp/pytest-of-user/pytest-384/erepo70)' -> 'out'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'out.dvc' md5: 'd98f1fdfcc266cc1af3fe1ffa49b2db2'
DEBUG    dvc.stage:__init__.py:363 'md5' of stage: 'out.dvc' changed.
DEBUG    dvc.external_repo:external_repo.py:33 Creating external repo /tmp/pytest-of-user/pytest-384/erepo70@None
DEBUG    dvc.external_repo:external_repo.py:195 erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo70' to a temporary dir
DEBUG    scmrepo.git.backend.pygit2:pygit2.py:505 fetch_refspecs: []
DEBUG    dvc.repo.stage:stage.py:80 Checking if stage '/subrepo/dir/bar' is in 'dvc.yaml'
DEBUG    dvc.repo.stage:stage.py:218 Assuming '/subrepo/dir/bar' to be a stage inside 'dvc.yaml'
_____________ test_pull_imported_stage_from_subrepos[files1-True] ______________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_pull_imported_stage_from_2')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_pull_imported_stage_from_2'
erepo_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/erepo73'), is_dvc = True
files = {'dir': {'bar': 'bar'}}

    @pytest.mark.parametrize("is_dvc", [True, False])
    @pytest.mark.parametrize("files", [{"foo": "foo"}, {"dir": {"bar": "bar"}}])
    def test_pull_imported_stage_from_subrepos(tmp_dir, dvc, erepo_dir, is_dvc, files):
        subrepo = erepo_dir / "subrepo"
        make_subrepo(subrepo, erepo_dir.scm)
        gen = subrepo.dvc_gen if is_dvc else subrepo.scm_gen
        with subrepo.chdir():
            gen(files, commit="files in subrepo")
    
        key = first(files)
        path = os.path.join("subrepo", key)
>       dvc.imp(os.fspath(erepo_dir), path, out="out")

/home/user/dvc/tests/func/test_import.py:536: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/imp.py:6: in imp
    return self.imp_url(path, out=out, fname=fname, erepo=erepo, frozen=True, **kwargs)
/home/user/dvc/dvc/repo/__init__.py:65: in wrapper
    return f(repo, *args, **kwargs)
/home/user/dvc/dvc/repo/scm_context.py:151: in run
    return method(repo, *args, **kw)
/home/user/dvc/dvc/repo/imp_url.py:91: in imp_url
    stage.run(jobs=jobs, no_download=no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:577: in run
    self._sync_import(dry, force, kwargs.get("jobs", None), no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:611: in _sync_import
    sync_import(self, dry, force, jobs, no_download)
/home/user/dvc/dvc/stage/imports.py:61: in sync_import
    stage.deps[0].download(
/home/user/dvc/dvc/dependency/repo.py:84: in download
    for odb, objs in self.get_used_objs().items():
/home/user/dvc/dvc/dependency/repo.py:111: in get_used_objs
    used, _, _ = self._get_used_and_obj(**kwargs)
/home/user/dvc/dvc/dependency/repo.py:148: in _get_used_and_obj
    object_store, meta, obj = build(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:244: in build
    meta, obj = _build_tree(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:126: in _build_tree
    for root, _, fnames in walk_iter:
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:282: in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:391: in ls
    return self.fs.ls(path, detail=detail, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ad6169bc80>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:40:10,981 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/.dvc/config.local' to gitignore file.
2023-05-15 22:40:11,008 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/.dvc/tmp' to gitignore file.
2023-05-15 22:40:11,034 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/.dvc/cache' to gitignore file.
2023-05-15 22:40:11,076 DEBUG: Removing '/var/tmp/dvc/repo/e69bfd063158166b0808ae16a9e184ff'
2023-05-15 22:40:11,802 DEBUG: Staging files: {'/tmp/pytest-of-user/pytest-384/erepo73/subrepo/.dvc/config', '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/.dvcignore', '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/.dvc/.gitignore'}
Initialized DVC repository.

You can now commit the changes to git.

2023-05-15 22:40:14,050 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/dir' to gitignore file.
2023-05-15 22:40:14,555 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-15 22:40:14,573 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:40:14,897 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-15 22:40:14,916 DEBUG: Preparing to transfer data from 'memory://dvc-staging/cee1cd4f2bcf443032eee84d58fb83fbf17a5cbfb6e9c12908d9c4e1781be73e' to '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/.dvc/cache'
2023-05-15 22:40:14,933 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/.dvc/cache'
2023-05-15 22:40:14,970 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/.dvc/cache'
2023-05-15 22:40:15,108 DEBUG: Preparing to collect status from 'memory://dvc-staging/cee1cd4f2bcf443032eee84d58fb83fbf17a5cbfb6e9c12908d9c4e1781be73e'
2023-05-15 22:40:15,929 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-15 22:40:15,973 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:40:15,988 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/.UfxCmeB5CwqpjHwQi3FsNb.tmp'
2023-05-15 22:40:16,036 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/.UfxCmeB5CwqpjHwQi3FsNb.tmp'
2023-05-15 22:40:16,055 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/.dvc/cache/.ZDGrBeosL9xDR4cEQh64Ab.tmp'
2023-05-15 22:40:16,083 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/dir/bar'
2023-05-15 22:40:16,293 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:40:18,514 DEBUG: Removing output 'out' of stage: 'out.dvc'.
2023-05-15 22:40:18,538 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_pull_imported_stage_from_2/out'
Importing 'subrepo/dir (/tmp/pytest-of-user/pytest-384/erepo73)' -> 'out'
2023-05-15 22:40:18,705 DEBUG: Computed stage: 'out.dvc' md5: '5a202c7de48478ecd532d5460ec8ad46'
2023-05-15 22:40:18,719 DEBUG: 'md5' of stage: 'out.dvc' changed.
2023-05-15 22:40:18,739 DEBUG: Creating external repo /tmp/pytest-of-user/pytest-384/erepo73@None
2023-05-15 22:40:18,753 DEBUG: erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo73' to a temporary dir
2023-05-15 22:40:20,784 DEBUG: Checking if stage '/subrepo/dir' is in 'dvc.yaml'
2023-05-15 22:40:20,827 DEBUG: Assuming '/subrepo/dir' to be a stage inside 'dvc.yaml'
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.77file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  8.86file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  8.86file/s][A

![A[A

  0%|          |memory://.jYmJmqpdV6UfRbG7GjjJ2q.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.jYmJmqpdV6UfRbG7GjjJ2q0.00/63.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  5.29file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.52s/file]100% Adding...|██████████|1/1 [00:02,  2.55s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Cloning erepo73|          |0.00/? [00:00,      ?obj/s]                                                      !Building data objects from subrepo/dir          |0.00 [00:00,      ?obj/s]                                                                          
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/.dvc/config.local' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/.dvc/tmp' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/.dvc/cache' to gitignore file.
DEBUG    dvc.utils.fs:fs.py:63 Removing '/var/tmp/dvc/repo/e69bfd063158166b0808ae16a9e184ff'
DEBUG    dvc.repo.scm_context:scm_context.py:68 Staging files: {'/tmp/pytest-of-user/pytest-384/erepo73/subrepo/.dvc/config', '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/.dvcignore', '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/.dvc/.gitignore'}
INFO     dvc.repo.init:init.py:93 Initialized DVC repository.

INFO     dvc.repo.init:init.py:95 You can now commit the changes to git.

DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/cee1cd4f2bcf443032eee84d58fb83fbf17a5cbfb6e9c12908d9c4e1781be73e' to '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/cee1cd4f2bcf443032eee84d58fb83fbf17a5cbfb6e9c12908d9c4e1781be73e'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/.UfxCmeB5CwqpjHwQi3FsNb.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/.UfxCmeB5CwqpjHwQi3FsNb.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/.dvc/cache/.ZDGrBeosL9xDR4cEQh64Ab.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo73/subrepo/dir/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.stage:__init__.py:387 Removing output 'out' of stage: 'out.dvc'.
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_pull_imported_stage_from_2/out'
INFO     dvc.stage.imports:imports.py:49 Importing 'subrepo/dir (/tmp/pytest-of-user/pytest-384/erepo73)' -> 'out'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'out.dvc' md5: '5a202c7de48478ecd532d5460ec8ad46'
DEBUG    dvc.stage:__init__.py:363 'md5' of stage: 'out.dvc' changed.
DEBUG    dvc.external_repo:external_repo.py:33 Creating external repo /tmp/pytest-of-user/pytest-384/erepo73@None
DEBUG    dvc.external_repo:external_repo.py:195 erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo73' to a temporary dir
DEBUG    scmrepo.git.backend.pygit2:pygit2.py:505 fetch_refspecs: []
DEBUG    dvc.repo.stage:stage.py:80 Checking if stage '/subrepo/dir' is in 'dvc.yaml'
DEBUG    dvc.repo.stage:stage.py:218 Assuming '/subrepo/dir' to be a stage inside 'dvc.yaml'
__________________________ test_import_complete_repo ___________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_import_complete_repo0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_import_complete_repo0'
erepo_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/erepo75')

    def test_import_complete_repo(tmp_dir, dvc, erepo_dir):
        with erepo_dir.chdir():
            erepo_dir.dvc_gen({"foo": "foo"}, commit="add foo")
    
        subrepo = erepo_dir / "subrepo"
        make_subrepo(subrepo, erepo_dir.scm)
        with subrepo.chdir():
            subrepo.dvc_gen({"dir": {"bar": "bar"}}, commit="files in subrepo")
    
>       dvc.imp(os.fspath(erepo_dir), "subrepo", out="out_sub")

/home/user/dvc/tests/func/test_import.py:558: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/imp.py:6: in imp
    return self.imp_url(path, out=out, fname=fname, erepo=erepo, frozen=True, **kwargs)
/home/user/dvc/dvc/repo/__init__.py:65: in wrapper
    return f(repo, *args, **kwargs)
/home/user/dvc/dvc/repo/scm_context.py:151: in run
    return method(repo, *args, **kw)
/home/user/dvc/dvc/repo/imp_url.py:91: in imp_url
    stage.run(jobs=jobs, no_download=no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:577: in run
    self._sync_import(dry, force, kwargs.get("jobs", None), no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:611: in _sync_import
    sync_import(self, dry, force, jobs, no_download)
/home/user/dvc/dvc/stage/imports.py:61: in sync_import
    stage.deps[0].download(
/home/user/dvc/dvc/dependency/repo.py:84: in download
    for odb, objs in self.get_used_objs().items():
/home/user/dvc/dvc/dependency/repo.py:111: in get_used_objs
    used, _, _ = self._get_used_and_obj(**kwargs)
/home/user/dvc/dvc/dependency/repo.py:148: in _get_used_and_obj
    object_store, meta, obj = build(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:244: in build
    meta, obj = _build_tree(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:126: in _build_tree
    for root, _, fnames in walk_iter:
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:428: in walk
    yield from self.walk(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:282: in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:391: in ls
    return self.fs.ls(path, detail=detail, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ad66e3c820>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:40:56,363 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo75/foo' to gitignore file.
2023-05-15 22:40:56,481 DEBUG: Computed stage: 'foo.dvc' md5: 'None'
2023-05-15 22:40:56,610 DEBUG: Preparing to transfer data from 'memory://dvc-staging/1a6986ec26650c539d890e1a5e31cbb4e5671116ecd711319bec7138b6aa715b' to '/tmp/pytest-of-user/pytest-384/erepo75/.dvc/cache'
2023-05-15 22:40:56,622 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo75/.dvc/cache'
2023-05-15 22:40:56,635 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo75/.dvc/cache'
2023-05-15 22:40:56,744 DEBUG: Preparing to collect status from 'memory://dvc-staging/1a6986ec26650c539d890e1a5e31cbb4e5671116ecd711319bec7138b6aa715b'
2023-05-15 22:40:56,990 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:40:57,004 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo75/.TfNYWwfaBMa9FiynEge43Q.tmp'
2023-05-15 22:40:57,045 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo75/.TfNYWwfaBMa9FiynEge43Q.tmp'
2023-05-15 22:40:57,063 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo75/.dvc/cache/.7BZ8A8C5ZGqDo935cTYvcW.tmp'
2023-05-15 22:40:57,082 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo75/foo'
2023-05-15 22:40:57,251 DEBUG: Saving information to 'foo.dvc'.

To track the changes with git, run:

	git add .gitignore foo.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:41:00,279 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/.dvc/config.local' to gitignore file.
2023-05-15 22:41:00,303 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/.dvc/tmp' to gitignore file.
2023-05-15 22:41:00,329 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/.dvc/cache' to gitignore file.
2023-05-15 22:41:00,376 DEBUG: Removing '/var/tmp/dvc/repo/ed1a219c6f02bedd5bce221dcd25b5e3'
2023-05-15 22:41:01,160 DEBUG: Staging files: {'/tmp/pytest-of-user/pytest-384/erepo75/subrepo/.dvc/config', '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/.dvc/.gitignore', '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/.dvcignore'}
Initialized DVC repository.

You can now commit the changes to git.

2023-05-15 22:41:03,490 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/dir' to gitignore file.
2023-05-15 22:41:03,807 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-15 22:41:03,821 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:41:04,124 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-15 22:41:04,144 DEBUG: Preparing to transfer data from 'memory://dvc-staging/cb2907da235c33c2e20e1589a455f07f2435d87dc84f6e1b6f0bb6902d6ab576' to '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/.dvc/cache'
2023-05-15 22:41:04,157 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/.dvc/cache'
2023-05-15 22:41:04,196 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/.dvc/cache'
2023-05-15 22:41:04,339 DEBUG: Preparing to collect status from 'memory://dvc-staging/cb2907da235c33c2e20e1589a455f07f2435d87dc84f6e1b6f0bb6902d6ab576'
2023-05-15 22:41:05,118 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-15 22:41:05,156 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:41:05,169 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/.PkyzqoAoRWL86VmqdaR59Y.tmp'
2023-05-15 22:41:05,215 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/.PkyzqoAoRWL86VmqdaR59Y.tmp'
2023-05-15 22:41:05,234 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/.dvc/cache/.o3Ppiw8muGKkPXXGxfQpgo.tmp'
2023-05-15 22:41:05,260 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/dir/bar'
2023-05-15 22:41:05,480 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:41:07,790 DEBUG: Removing output 'out_sub' of stage: 'out_sub.dvc'.
2023-05-15 22:41:07,814 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_import_complete_repo0/out_sub'
Importing 'subrepo (/tmp/pytest-of-user/pytest-384/erepo75)' -> 'out_sub'
2023-05-15 22:41:08,011 DEBUG: Computed stage: 'out_sub.dvc' md5: '8163f8f43b1fb8aad3e6b4022f4a5d31'
2023-05-15 22:41:08,026 DEBUG: 'md5' of stage: 'out_sub.dvc' changed.
2023-05-15 22:41:08,045 DEBUG: Creating external repo /tmp/pytest-of-user/pytest-384/erepo75@None
2023-05-15 22:41:08,062 DEBUG: erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo75' to a temporary dir
2023-05-15 22:41:10,415 DEBUG: Checking if stage '/subrepo' is in 'dvc.yaml'
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.08file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
                                                                                [A100% Adding...|██████████|1/1 [00:01<00:00,  1.11s/file]100% Adding...|██████████|1/1 [00:01,  1.14s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.10file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.28file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.28file/s][A

![A[A

  0%|          |memory://.FCf9jcpF8dWwNQJABv9MAR.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.FCf9jcpF8dWwNQJABv9MAR0.00/63.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  5.48file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.36s/file]100% Adding...|██████████|1/1 [00:02,  2.39s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Cloning erepo75|          |0.00/? [00:00,      ?obj/s]                                                      !Building data objects from subrepo          |0.00 [00:00,      ?obj/s]Building data objects from subrepo          |1.00 [00:00,   8.96obj/s]                                                                      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo75/foo' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'foo.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/1a6986ec26650c539d890e1a5e31cbb4e5671116ecd711319bec7138b6aa715b' to '/tmp/pytest-of-user/pytest-384/erepo75/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo75/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo75/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/1a6986ec26650c539d890e1a5e31cbb4e5671116ecd711319bec7138b6aa715b'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo75/.TfNYWwfaBMa9FiynEge43Q.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo75/.TfNYWwfaBMa9FiynEge43Q.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo75/.dvc/cache/.7BZ8A8C5ZGqDo935cTYvcW.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo75/foo'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'foo.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore foo.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/.dvc/config.local' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/.dvc/tmp' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/.dvc/cache' to gitignore file.
DEBUG    dvc.utils.fs:fs.py:63 Removing '/var/tmp/dvc/repo/ed1a219c6f02bedd5bce221dcd25b5e3'
DEBUG    dvc.repo.scm_context:scm_context.py:68 Staging files: {'/tmp/pytest-of-user/pytest-384/erepo75/subrepo/.dvc/config', '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/.dvc/.gitignore', '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/.dvcignore'}
INFO     dvc.repo.init:init.py:93 Initialized DVC repository.

INFO     dvc.repo.init:init.py:95 You can now commit the changes to git.

DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/cb2907da235c33c2e20e1589a455f07f2435d87dc84f6e1b6f0bb6902d6ab576' to '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/cb2907da235c33c2e20e1589a455f07f2435d87dc84f6e1b6f0bb6902d6ab576'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/.PkyzqoAoRWL86VmqdaR59Y.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/.PkyzqoAoRWL86VmqdaR59Y.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/.dvc/cache/.o3Ppiw8muGKkPXXGxfQpgo.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo75/subrepo/dir/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.stage:__init__.py:387 Removing output 'out_sub' of stage: 'out_sub.dvc'.
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_import_complete_repo0/out_sub'
INFO     dvc.stage.imports:imports.py:49 Importing 'subrepo (/tmp/pytest-of-user/pytest-384/erepo75)' -> 'out_sub'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'out_sub.dvc' md5: '8163f8f43b1fb8aad3e6b4022f4a5d31'
DEBUG    dvc.stage:__init__.py:363 'md5' of stage: 'out_sub.dvc' changed.
DEBUG    dvc.external_repo:external_repo.py:33 Creating external repo /tmp/pytest-of-user/pytest-384/erepo75@None
DEBUG    dvc.external_repo:external_repo.py:195 erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo75' to a temporary dir
DEBUG    scmrepo.git.backend.pygit2:pygit2.py:505 fetch_refspecs: []
DEBUG    dvc.repo.stage:stage.py:80 Checking if stage '/subrepo' is in 'dvc.yaml'
____________________________ test_import_with_jobs _____________________________

mocker = <pytest_mock.plugin.MockerFixture object at 0x14ad49592be0>
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_import_with_jobs0'
erepo_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/erepo77')

    def test_import_with_jobs(mocker, dvc, erepo_dir):
        import dvc_data.hashfile.transfer as otransfer
    
        with erepo_dir.chdir():
            erepo_dir.dvc_gen(
                {
                    "dir1": {
                        "file1": "file1",
                        "file2": "file2",
                        "file3": "file3",
                        "file4": "file4",
                    }
                },
                commit="init",
            )
    
        spy = mocker.spy(otransfer, "transfer")
>       dvc.imp(os.fspath(erepo_dir), "dir1", jobs=3)

/home/user/dvc/tests/func/test_import.py:598: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/imp.py:6: in imp
    return self.imp_url(path, out=out, fname=fname, erepo=erepo, frozen=True, **kwargs)
/home/user/dvc/dvc/repo/__init__.py:65: in wrapper
    return f(repo, *args, **kwargs)
/home/user/dvc/dvc/repo/scm_context.py:151: in run
    return method(repo, *args, **kw)
/home/user/dvc/dvc/repo/imp_url.py:91: in imp_url
    stage.run(jobs=jobs, no_download=no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:577: in run
    self._sync_import(dry, force, kwargs.get("jobs", None), no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:611: in _sync_import
    sync_import(self, dry, force, jobs, no_download)
/home/user/dvc/dvc/stage/imports.py:61: in sync_import
    stage.deps[0].download(
/home/user/dvc/dvc/dependency/repo.py:84: in download
    for odb, objs in self.get_used_objs().items():
/home/user/dvc/dvc/dependency/repo.py:111: in get_used_objs
    used, _, _ = self._get_used_and_obj(**kwargs)
/home/user/dvc/dvc/dependency/repo.py:148: in _get_used_and_obj
    object_store, meta, obj = build(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:244: in build
    meta, obj = _build_tree(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:126: in _build_tree
    for root, _, fnames in walk_iter:
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:282: in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:391: in ls
    return self.fs.ls(path, detail=detail, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ad69a28370>
key = ('dir1',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:41:31,363 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo77/dir1' to gitignore file.
2023-05-15 22:41:31,921 DEBUG: built tree 'object 50f40a0005c48e40611c85f5fd26c2d0.dir'
2023-05-15 22:41:31,936 DEBUG: Computed stage: 'dir1.dvc' md5: 'None'
2023-05-15 22:41:32,286 DEBUG: built tree 'object 50f40a0005c48e40611c85f5fd26c2d0.dir'
2023-05-15 22:41:32,305 DEBUG: Preparing to transfer data from 'memory://dvc-staging/293f373e568cd6e080f41f6d5998a5b4309c97262eabb345726ba89783ca4192' to '/tmp/pytest-of-user/pytest-384/erepo77/.dvc/cache'
2023-05-15 22:41:32,323 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo77/.dvc/cache'
2023-05-15 22:41:32,364 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo77/.dvc/cache'
2023-05-15 22:41:32,568 DEBUG: Preparing to collect status from 'memory://dvc-staging/293f373e568cd6e080f41f6d5998a5b4309c97262eabb345726ba89783ca4192'
2023-05-15 22:41:33,469 DEBUG: built tree 'object 50f40a0005c48e40611c85f5fd26c2d0.dir'
2023-05-15 22:41:33,527 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:41:33,541 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo77/.Rm7aC8CHs3638nkNTdVsWg.tmp'
2023-05-15 22:41:33,586 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo77/.Rm7aC8CHs3638nkNTdVsWg.tmp'
2023-05-15 22:41:33,602 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo77/.dvc/cache/.ioozSr5fUXAQWPWrKgsvVQ.tmp'
2023-05-15 22:41:33,622 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo77/dir1/file2'
2023-05-15 22:41:33,695 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo77/dir1/file4'
2023-05-15 22:41:33,776 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo77/dir1/file3'
2023-05-15 22:41:33,853 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo77/dir1/file1'
2023-05-15 22:41:34,060 DEBUG: Saving information to 'dir1.dvc'.

To track the changes with git, run:

	git add .gitignore dir1.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:41:36,743 DEBUG: Removing output 'dir1' of stage: 'dir1.dvc'.
2023-05-15 22:41:36,774 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_import_with_jobs0/dir1'
Importing 'dir1 (/tmp/pytest-of-user/pytest-384/erepo77)' -> 'dir1'
2023-05-15 22:41:36,979 DEBUG: Computed stage: 'dir1.dvc' md5: 'e9cf895a7834c64b68e33b66a91b6971'
2023-05-15 22:41:36,994 DEBUG: 'md5' of stage: 'dir1.dvc' changed.
2023-05-15 22:41:37,018 DEBUG: Creating external repo /tmp/pytest-of-user/pytest-384/erepo77@None
2023-05-15 22:41:37,034 DEBUG: erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo77' to a temporary dir
2023-05-15 22:41:39,496 DEBUG: Checking if stage '/dir1' is in 'dvc.yaml'
2023-05-15 22:41:39,814 DEBUG: Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/erepo77/.dvc/cache' to '/tmp/pytest-of-user/pytest-384/test_import_with_jobs0/.dvc/cache'
2023-05-15 22:41:39,829 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_import_with_jobs0/.dvc/cache'
2023-05-15 22:41:39,842 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_import_with_jobs0/.dvc/cache'
2023-05-15 22:41:39,931 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo77/.dvc/cache'
2023-05-15 22:41:39,948 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo77/.dvc/cache'
2023-05-15 22:41:40,030 DEBUG: Querying 1 oids via object_exists
2023-05-15 22:41:40,130 DEBUG: Indexing new .dir '50f40a0005c48e40611c85f5fd26c2d0.dir' with '4' nested files
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.09file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir1          |0.00 [00:00,      ?obj/s][A
Building data objects from dir1          |2.00 [00:00,   17.5obj/s][A
Building data objects from dir1          |4.00 [00:00,   15.0obj/s][A
                                                                   [A
![A
Building data objects from dir1          |0.00 [00:00,      ?obj/s][A
                                                                   [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
100% |██████████|5/5 [00:00<00:00, 45.72files/s][A
                                                [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/4 [00:00<?,     ?file/s][A
  0%|          |Transferring                      4/? [00:00<00:00, 20.88file/s][A
  0%|          |Transferring                      4/? [00:00<00:00, 20.88file/s][A

![A[A

  0%|          |memory://.MH3DBJ9gAQ2u563upA48Px.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.MH3DBJ9gAQ2u563upA48Px.0.00/260 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir1          |0.00 [00:00,      ?obj/s][A
                                                                   [A100% Adding...|██████████|1/1 [00:02<00:00,  2.99s/file]100% Adding...|██████████|1/1 [00:03,  3.02s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Cloning erepo77|          |0.00/? [00:00,      ?obj/s]                                                      !  0% |          |0/? [00:00<?,    ?files/s]                                           !  0% Querying remote cache|          |0/1 [00:00<?,    ?files/s]                                                                !  0% Transferring|          |0/? [00:00<?,     ?file/s]  0% Transferring|          |0/1 [00:00<?,     ?file/s]
![A
  0%|          |/tmp/pytest-of-user/pytest-384/erep0.00/? [00:00<?,        ?B/s][A
  0%|          |/tmp/pytest-of-user/pytest-384/er0.00/260 [00:00<?,        ?B/s][A
                                                                                [A100% Transferring|██████████|1/1 [00:00<00:00,  4.98file/s]                                                           !Building data objects from dir1          |0.00 [00:00,      ?obj/s]                                                                   
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo77/dir1' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 50f40a0005c48e40611c85f5fd26c2d0.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir1.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 50f40a0005c48e40611c85f5fd26c2d0.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/293f373e568cd6e080f41f6d5998a5b4309c97262eabb345726ba89783ca4192' to '/tmp/pytest-of-user/pytest-384/erepo77/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo77/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo77/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/293f373e568cd6e080f41f6d5998a5b4309c97262eabb345726ba89783ca4192'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 50f40a0005c48e40611c85f5fd26c2d0.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo77/.Rm7aC8CHs3638nkNTdVsWg.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo77/.Rm7aC8CHs3638nkNTdVsWg.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo77/.dvc/cache/.ioozSr5fUXAQWPWrKgsvVQ.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo77/dir1/file2'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo77/dir1/file4'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo77/dir1/file3'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo77/dir1/file1'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir1.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir1.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.stage:__init__.py:387 Removing output 'dir1' of stage: 'dir1.dvc'.
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_import_with_jobs0/dir1'
INFO     dvc.stage.imports:imports.py:49 Importing 'dir1 (/tmp/pytest-of-user/pytest-384/erepo77)' -> 'dir1'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir1.dvc' md5: 'e9cf895a7834c64b68e33b66a91b6971'
DEBUG    dvc.stage:__init__.py:363 'md5' of stage: 'dir1.dvc' changed.
DEBUG    dvc.external_repo:external_repo.py:33 Creating external repo /tmp/pytest-of-user/pytest-384/erepo77@None
DEBUG    dvc.external_repo:external_repo.py:195 erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo77' to a temporary dir
DEBUG    scmrepo.git.backend.pygit2:pygit2.py:505 fetch_refspecs: []
DEBUG    dvc.repo.stage:stage.py:80 Checking if stage '/dir1' is in 'dvc.yaml'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/erepo77/.dvc/cache' to '/tmp/pytest-of-user/pytest-384/test_import_with_jobs0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_import_with_jobs0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_import_with_jobs0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo77/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo77/.dvc/cache'
DEBUG    dvc_objects.db:db.py:349 Querying 1 oids via object_exists
DEBUG    dvc_data.hashfile.status:status.py:73 Indexing new .dir '50f40a0005c48e40611c85f5fd26c2d0.dir' with '4' nested files
_____________________________ test_chained_import ______________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_chained_import0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_chained_import0'
make_tmp_dir = <function make_tmp_dir.<locals>.make at 0x14aed327b910>
erepo_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/erepo78')
local_cloud = PosixTmpDir('/tmp/pytest-of-user/pytest-384/local-cloud61')

    def test_chained_import(tmp_dir, dvc, make_tmp_dir, erepo_dir, local_cloud):
        erepo_dir.add_remote(config=local_cloud.config)
        with erepo_dir.chdir():
            erepo_dir.dvc_gen({"dir": {"foo": "foo", "bar": "bar"}}, commit="init")
        erepo_dir.dvc.push()
        remove(erepo_dir.dvc.cache.local.path)
        remove(os.fspath(erepo_dir / "dir"))
    
        erepo2 = make_tmp_dir("erepo2", scm=True, dvc=True)
        with erepo2.chdir():
>           erepo2.dvc.imp(os.fspath(erepo_dir), "dir")

/home/user/dvc/tests/func/test_import.py:614: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/imp.py:6: in imp
    return self.imp_url(path, out=out, fname=fname, erepo=erepo, frozen=True, **kwargs)
/home/user/dvc/dvc/repo/__init__.py:65: in wrapper
    return f(repo, *args, **kwargs)
/home/user/dvc/dvc/repo/scm_context.py:151: in run
    return method(repo, *args, **kw)
/home/user/dvc/dvc/repo/imp_url.py:91: in imp_url
    stage.run(jobs=jobs, no_download=no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:577: in run
    self._sync_import(dry, force, kwargs.get("jobs", None), no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:611: in _sync_import
    sync_import(self, dry, force, jobs, no_download)
/home/user/dvc/dvc/stage/imports.py:61: in sync_import
    stage.deps[0].download(
/home/user/dvc/dvc/dependency/repo.py:84: in download
    for odb, objs in self.get_used_objs().items():
/home/user/dvc/dvc/dependency/repo.py:111: in get_used_objs
    used, _, _ = self._get_used_and_obj(**kwargs)
/home/user/dvc/dvc/dependency/repo.py:148: in _get_used_and_obj
    object_store, meta, obj = build(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:244: in build
    meta, obj = _build_tree(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:126: in _build_tree
    for root, _, fnames in walk_iter:
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:282: in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:391: in ls
    return self.fs.ls(path, detail=detail, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ad698c5910>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:41:52,246 DEBUG: Writing '/tmp/pytest-of-user/pytest-384/erepo78/.dvc/config'.
2023-05-15 22:41:54,787 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo78/dir' to gitignore file.
2023-05-15 22:41:55,192 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-15 22:41:55,212 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:41:55,547 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-15 22:41:55,569 DEBUG: Preparing to transfer data from 'memory://dvc-staging/67a417fbfba1b39e13989ef02ebe7d873a9a41e8f5a8d807fd64f51d72373f71' to '/tmp/pytest-of-user/pytest-384/erepo78/.dvc/cache'
2023-05-15 22:41:55,584 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo78/.dvc/cache'
2023-05-15 22:41:55,622 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo78/.dvc/cache'
2023-05-15 22:41:55,770 DEBUG: Preparing to collect status from 'memory://dvc-staging/67a417fbfba1b39e13989ef02ebe7d873a9a41e8f5a8d807fd64f51d72373f71'
2023-05-15 22:41:56,550 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-15 22:41:56,602 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:41:56,618 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo78/.JiHQdTg5dyba9GrS5hByrB.tmp'
2023-05-15 22:41:56,668 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo78/.JiHQdTg5dyba9GrS5hByrB.tmp'
2023-05-15 22:41:56,685 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo78/.dvc/cache/.AkwM2BUJyJB55DB7Nn8cCV.tmp'
2023-05-15 22:41:56,711 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo78/dir/foo'
2023-05-15 22:41:56,789 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo78/dir/bar'
2023-05-15 22:41:57,014 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:41:59,821 DEBUG: Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/erepo78/.dvc/cache' to '/tmp/pytest-of-user/pytest-384/local-cloud61'
2023-05-15 22:41:59,834 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/local-cloud61'
2023-05-15 22:41:59,849 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/local-cloud61'
2023-05-15 22:41:59,918 DEBUG: Querying 1 oids via object_exists
2023-05-15 22:42:00,090 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo78/.dvc/cache'
2023-05-15 22:42:00,104 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo78/.dvc/cache'
2023-05-15 22:42:01,106 DEBUG: Indexing pushed dir 'md5: 5ea40360f5b4ec688df672a4db9c17d1.dir' with '2' nested files
2023-05-15 22:42:01,176 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo78/.dvc/cache'
2023-05-15 22:42:01,196 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo78/dir'
2023-05-15 22:42:02,761 DEBUG: Removing output 'dir' of stage: 'dir.dvc'.
2023-05-15 22:42:02,790 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo210/dir'
Importing 'dir (/tmp/pytest-of-user/pytest-384/erepo78)' -> 'dir'
2023-05-15 22:42:03,013 DEBUG: Computed stage: 'dir.dvc' md5: '1ab135cdac216459fa8f45f56c50c79e'
2023-05-15 22:42:03,028 DEBUG: 'md5' of stage: 'dir.dvc' changed.
2023-05-15 22:42:03,050 DEBUG: Creating external repo /tmp/pytest-of-user/pytest-384/erepo78@None
2023-05-15 22:42:03,065 DEBUG: erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo78' to a temporary dir
2023-05-15 22:42:05,451 DEBUG: Checking if stage '/dir' is in 'dvc.yaml'
2023-05-15 22:42:05,729 DEBUG: Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/local-cloud61' to '/tmp/pytest-of-user/pytest-384/erepo210/.dvc/cache'
2023-05-15 22:42:05,743 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo210/.dvc/cache'
2023-05-15 22:42:05,755 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo210/.dvc/cache'
2023-05-15 22:42:05,843 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/local-cloud61'
2023-05-15 22:42:05,854 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/local-cloud61'
2023-05-15 22:42:05,915 DEBUG: Querying 1 oids via object_exists
2023-05-15 22:42:06,016 DEBUG: Indexing new .dir '5ea40360f5b4ec688df672a4db9c17d1.dir' with '2' nested files
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.54file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |2.00 [00:00,   17.6obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/2 [00:00<?,     ?file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 15.35file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 15.35file/s][A

![A[A

  0%|          |memory://.8rnraprFtzEpXXqbsz9S9V.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.8rnraprFtzEpXXqbsz9S9V.0.00/126 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.51s/file]100% Adding...|██████████|1/1 [00:02,  2.54s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !  0% Querying remote cache|          |0/1 [00:00<?,    ?files/s]                                                                !  0% |          |0/? [00:00<?,    ?files/s]                                           !  0% |          |0/? [00:00<?,    ?files/s]                                           !  0% Transferring|          |0/? [00:00<?,     ?file/s]  0% Transferring|          |0/2 [00:00<?,     ?file/s]
![A
  0%|          |/tmp/pytest-of-user/pytest-384/erep0.00/? [00:00<?,        ?B/s][A
  0%|          |/tmp/pytest-of-user/pytest-384/e0.00/3.00 [00:00<?,        ?B/s][A
                                                                                [A 50% Transferring|█████     |1/2 [00:00<00:00,  2.54file/s]
![A
  0%|          |/tmp/pytest-of-user/pytest-384/erep0.00/? [00:00<?,        ?B/s][A
  0%|          |/tmp/pytest-of-user/pytest-384/e0.00/3.00 [00:00<?,        ?B/s][A
                                                                                [A100% Transferring|██████████|2/2 [00:00<00:00,  3.66file/s]  0% Transferring|          |2/? [00:00<00:00,  3.66file/s]
![A
  0%|          |/tmp/pytest-of-user/pytest-384/erep0.00/? [00:00<?,        ?B/s][A
  0%|          |/tmp/pytest-of-user/pytest-384/er0.00/126 [00:00<?,        ?B/s][A
                                                                                [A  0% Transferring|          |3/? [00:00<00:00,  3.97file/s]                                                           !If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Cloning erepo78|          |0.00/? [00:00,      ?obj/s]                                                      !  0% |          |0/? [00:00<?,    ?files/s]                                           !  0% Querying remote cache|          |0/1 [00:00<?,    ?files/s]                                                                !  0% Transferring|          |0/? [00:00<?,     ?file/s]  0% Transferring|          |0/1 [00:00<?,     ?file/s]
![A
  0%|          |/tmp/pytest-of-user/pytest-384/loca0.00/? [00:00<?,        ?B/s][A
  0%|          |/tmp/pytest-of-user/pytest-384/lo0.00/126 [00:00<?,        ?B/s][A
                                                                                [A100% Transferring|██████████|1/1 [00:00<00:00,  4.67file/s]                                                           !Building data objects from dir          |0.00 [00:00,      ?obj/s]                                                                  
------------------------------ Captured log call -------------------------------
DEBUG    dvc.config:config.py:206 Writing '/tmp/pytest-of-user/pytest-384/erepo78/.dvc/config'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo78/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/67a417fbfba1b39e13989ef02ebe7d873a9a41e8f5a8d807fd64f51d72373f71' to '/tmp/pytest-of-user/pytest-384/erepo78/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo78/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo78/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/67a417fbfba1b39e13989ef02ebe7d873a9a41e8f5a8d807fd64f51d72373f71'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo78/.JiHQdTg5dyba9GrS5hByrB.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo78/.JiHQdTg5dyba9GrS5hByrB.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo78/.dvc/cache/.AkwM2BUJyJB55DB7Nn8cCV.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo78/dir/foo'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo78/dir/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/erepo78/.dvc/cache' to '/tmp/pytest-of-user/pytest-384/local-cloud61'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/local-cloud61'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/local-cloud61'
DEBUG    dvc_objects.db:db.py:349 Querying 1 oids via object_exists
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo78/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo78/.dvc/cache'
DEBUG    dvc_data.hashfile.transfer:transfer.py:132 Indexing pushed dir 'md5: 5ea40360f5b4ec688df672a4db9c17d1.dir' with '2' nested files
DEBUG    dvc.utils.fs:fs.py:63 Removing '/tmp/pytest-of-user/pytest-384/erepo78/.dvc/cache'
DEBUG    dvc.utils.fs:fs.py:63 Removing '/tmp/pytest-of-user/pytest-384/erepo78/dir'
DEBUG    dvc.stage:__init__.py:387 Removing output 'dir' of stage: 'dir.dvc'.
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo210/dir'
INFO     dvc.stage.imports:imports.py:49 Importing 'dir (/tmp/pytest-of-user/pytest-384/erepo78)' -> 'dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: '1ab135cdac216459fa8f45f56c50c79e'
DEBUG    dvc.stage:__init__.py:363 'md5' of stage: 'dir.dvc' changed.
DEBUG    dvc.external_repo:external_repo.py:33 Creating external repo /tmp/pytest-of-user/pytest-384/erepo78@None
DEBUG    dvc.external_repo:external_repo.py:195 erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo78' to a temporary dir
DEBUG    scmrepo.git.backend.pygit2:pygit2.py:505 fetch_refspecs: []
DEBUG    dvc.repo.stage:stage.py:80 Checking if stage '/dir' is in 'dvc.yaml'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/local-cloud61' to '/tmp/pytest-of-user/pytest-384/erepo210/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo210/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo210/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/local-cloud61'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/local-cloud61'
DEBUG    dvc_objects.db:db.py:349 Querying 1 oids via object_exists
DEBUG    dvc_data.hashfile.status:status.py:73 Indexing new .dir '5ea40360f5b4ec688df672a4db9c17d1.dir' with '2' nested files
_____________________________ test_circular_import _____________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_circular_import0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_circular_import0'
scm = Git: '/tmp/pytest-of-user/pytest-384/test_circular_import0/.git'
erepo_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/erepo211')

    def test_circular_import(tmp_dir, dvc, scm, erepo_dir):
        from dvc.exceptions import CircularImportError
    
        with erepo_dir.chdir():
            erepo_dir.dvc_gen({"dir": {"foo": "foo", "bar": "bar"}}, commit="init")
    
>       dvc.imp(os.fspath(erepo_dir), "dir", "dir_imported")

/home/user/dvc/tests/func/test_import.py:643: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/imp.py:6: in imp
    return self.imp_url(path, out=out, fname=fname, erepo=erepo, frozen=True, **kwargs)
/home/user/dvc/dvc/repo/__init__.py:65: in wrapper
    return f(repo, *args, **kwargs)
/home/user/dvc/dvc/repo/scm_context.py:151: in run
    return method(repo, *args, **kw)
/home/user/dvc/dvc/repo/imp_url.py:91: in imp_url
    stage.run(jobs=jobs, no_download=no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:577: in run
    self._sync_import(dry, force, kwargs.get("jobs", None), no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:611: in _sync_import
    sync_import(self, dry, force, jobs, no_download)
/home/user/dvc/dvc/stage/imports.py:61: in sync_import
    stage.deps[0].download(
/home/user/dvc/dvc/dependency/repo.py:84: in download
    for odb, objs in self.get_used_objs().items():
/home/user/dvc/dvc/dependency/repo.py:111: in get_used_objs
    used, _, _ = self._get_used_and_obj(**kwargs)
/home/user/dvc/dvc/dependency/repo.py:148: in _get_used_and_obj
    object_store, meta, obj = build(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:244: in build
    meta, obj = _build_tree(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:126: in _build_tree
    for root, _, fnames in walk_iter:
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:282: in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:391: in ls
    return self.fs.ls(path, detail=detail, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ad5ecece60>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:42:18,070 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo211/dir' to gitignore file.
2023-05-15 22:42:18,441 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-15 22:42:18,460 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:42:18,794 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-15 22:42:18,812 DEBUG: Preparing to transfer data from 'memory://dvc-staging/f7f3f8b9ef7999fadaa843e79b95b8cc0b5b152456917b2b1bb39fe536fc2fa6' to '/tmp/pytest-of-user/pytest-384/erepo211/.dvc/cache'
2023-05-15 22:42:18,823 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo211/.dvc/cache'
2023-05-15 22:42:18,854 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo211/.dvc/cache'
2023-05-15 22:42:18,995 DEBUG: Preparing to collect status from 'memory://dvc-staging/f7f3f8b9ef7999fadaa843e79b95b8cc0b5b152456917b2b1bb39fe536fc2fa6'
2023-05-15 22:42:19,736 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-15 22:42:19,782 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-15 22:42:19,792 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo211/.Gktqc2x59XUPhAAzKU79wP.tmp'
2023-05-15 22:42:19,836 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo211/.Gktqc2x59XUPhAAzKU79wP.tmp'
2023-05-15 22:42:19,846 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo211/.dvc/cache/.FAofhUi8i5Krsmw4wEoyGj.tmp'
2023-05-15 22:42:19,863 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo211/dir/foo'
2023-05-15 22:42:19,932 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/erepo211/dir/bar'
2023-05-15 22:42:20,130 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:42:22,523 DEBUG: Removing output 'dir_imported' of stage: 'dir_imported.dvc'.
2023-05-15 22:42:22,548 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_circular_import0/dir_imported'
Importing 'dir (/tmp/pytest-of-user/pytest-384/erepo211)' -> 'dir_imported'
2023-05-15 22:42:22,712 DEBUG: Computed stage: 'dir_imported.dvc' md5: '0f321d3ecb6e3cbb8d06bc77dd0a3336'
2023-05-15 22:42:22,721 DEBUG: 'md5' of stage: 'dir_imported.dvc' changed.
2023-05-15 22:42:22,737 DEBUG: Creating external repo /tmp/pytest-of-user/pytest-384/erepo211@None
2023-05-15 22:42:22,748 DEBUG: erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo211' to a temporary dir
2023-05-15 22:42:24,769 DEBUG: Checking if stage '/dir' is in 'dvc.yaml'
2023-05-15 22:42:25,144 DEBUG: Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/erepo211/.dvc/cache' to '/tmp/pytest-of-user/pytest-384/test_circular_import0/.dvc/cache'
2023-05-15 22:42:25,159 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_circular_import0/.dvc/cache'
2023-05-15 22:42:25,175 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_circular_import0/.dvc/cache'
2023-05-15 22:42:25,275 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo211/.dvc/cache'
2023-05-15 22:42:25,291 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/erepo211/.dvc/cache'
2023-05-15 22:42:25,362 DEBUG: Querying 1 oids via object_exists
2023-05-15 22:42:25,458 DEBUG: Indexing new .dir '5ea40360f5b4ec688df672a4db9c17d1.dir' with '2' nested files
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  2.20file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |2.00 [00:00,   18.8obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/2 [00:00<?,     ?file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 17.26file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 17.26file/s][A

![A[A

  0%|          |memory://.HECLfS6yCE9Boz9k3ffryG.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.HECLfS6yCE9Boz9k3ffryG.0.00/126 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.33s/file]100% Adding...|██████████|1/1 [00:02,  2.36s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Cloning erepo211|          |0.00/? [00:00,      ?obj/s]                                                       !  0% |          |0/? [00:00<?,    ?files/s]                                           !  0% Querying remote cache|          |0/1 [00:00<?,    ?files/s]                                                                !  0% Transferring|          |0/? [00:00<?,     ?file/s]  0% Transferring|          |0/1 [00:00<?,     ?file/s]
![A
  0%|          |/tmp/pytest-of-user/pytest-384/erep0.00/? [00:00<?,        ?B/s][A
  0%|          |/tmp/pytest-of-user/pytest-384/er0.00/126 [00:00<?,        ?B/s][A
                                                                                [A100% Transferring|██████████|1/1 [00:00<00:00,  4.83file/s]                                                           !Building data objects from dir          |0.00 [00:00,      ?obj/s]                                                                  
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo211/dir' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/f7f3f8b9ef7999fadaa843e79b95b8cc0b5b152456917b2b1bb39fe536fc2fa6' to '/tmp/pytest-of-user/pytest-384/erepo211/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo211/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo211/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/f7f3f8b9ef7999fadaa843e79b95b8cc0b5b152456917b2b1bb39fe536fc2fa6'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo211/.Gktqc2x59XUPhAAzKU79wP.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo211/.Gktqc2x59XUPhAAzKU79wP.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo211/.dvc/cache/.FAofhUi8i5Krsmw4wEoyGj.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo211/dir/foo'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/erepo211/dir/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.stage:__init__.py:387 Removing output 'dir_imported' of stage: 'dir_imported.dvc'.
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_circular_import0/dir_imported'
INFO     dvc.stage.imports:imports.py:49 Importing 'dir (/tmp/pytest-of-user/pytest-384/erepo211)' -> 'dir_imported'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir_imported.dvc' md5: '0f321d3ecb6e3cbb8d06bc77dd0a3336'
DEBUG    dvc.stage:__init__.py:363 'md5' of stage: 'dir_imported.dvc' changed.
DEBUG    dvc.external_repo:external_repo.py:33 Creating external repo /tmp/pytest-of-user/pytest-384/erepo211@None
DEBUG    dvc.external_repo:external_repo.py:195 erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo211' to a temporary dir
DEBUG    scmrepo.git.backend.pygit2:pygit2.py:505 fetch_refspecs: []
DEBUG    dvc.repo.stage:stage.py:80 Checking if stage '/dir' is in 'dvc.yaml'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from '/tmp/pytest-of-user/pytest-384/erepo211/.dvc/cache' to '/tmp/pytest-of-user/pytest-384/test_circular_import0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_circular_import0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_circular_import0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/erepo211/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/erepo211/.dvc/cache'
DEBUG    dvc_objects.db:db.py:349 Querying 1 oids via object_exists
DEBUG    dvc_data.hashfile.status:status.py:73 Indexing new .dir '5ea40360f5b4ec688df672a4db9c17d1.dir' with '2' nested files
________________________ test_ls_repo_with_new_path_dir ________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_ls_repo_with_new_path_dir0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_ls_repo_with_new_path_dir0'
scm = Git: '/tmp/pytest-of-user/pytest-384/test_ls_repo_with_new_path_dir0/.git'

    def test_ls_repo_with_new_path_dir(tmp_dir, dvc, scm):
        tmp_dir.scm_gen(FS_STRUCTURE, commit="init")
        tmp_dir.dvc_gen({"mysub": {}}, commit="dvc")
        tmp_dir.gen({"mysub/sub": {"foo": "content"}})
    
>       files = Repo.ls(os.fspath(tmp_dir), path="mysub/sub")

/home/user/dvc/tests/func/test_ls.py:122: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/ls.py:43: in ls
    ret = _ls(repo, path, recursive, dvc_only)
/home/user/dvc/dvc/repo/ls.py:62: in _ls
    fs_path = fs.info(fs_path)["name"]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:467: in info
    return self.fs.info(path, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:330: in info
    return self._info(key, path, ignore_subrepos=ignore_subrepos)
/home/user/dvc/dvc/fs/dvc.py:340: in _info
    dvc_info = dvc_fs.fs.index.info(subkey)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:413: in info
    entry = self[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:464: in __getitem__
    self._load(dir_key, dir_entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ad0f4d3960>
key = ('mysub',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:49:57,462 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_ls_repo_with_new_path_dir0/mysub' to gitignore file.
2023-05-15 22:49:57,604 DEBUG: Computed stage: 'mysub.dvc' md5: 'None'
2023-05-15 22:49:58,440 DEBUG: Saving information to 'mysub.dvc'.

To track the changes with git, run:

	git add .gitignore mysub.dvc

To enable auto staging, run:

	dvc config core.autostage true
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  2.87file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           2023-05-15 22:49:57,414 WARNING: 'mysub' is empty.
100% Adding...|██████████|1/1 [00:01<00:00,  1.28s/file]100% Adding...|██████████|1/1 [00:01,  1.31s/file]      
------------------------------ Captured log call -------------------------------
WARNING  dvc.output:output.py:665 'mysub' is empty.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_ls_repo_with_new_path_dir0/mysub' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'mysub.dvc' md5: 'None'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'mysub.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore mysub.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
__________________ test_ls_repo_with_path_dir_dvc_only_empty ___________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_ls_repo_with_path_dir_dvc0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_ls_repo_with_path_dir_dvc0'
scm = Git: '/tmp/pytest-of-user/pytest-384/test_ls_repo_with_path_dir_dvc0/.git'

    def test_ls_repo_with_path_dir_dvc_only_empty(tmp_dir, dvc, scm):
        tmp_dir.scm_gen(FS_STRUCTURE, commit="init")
        tmp_dir.dvc_gen(DVC_STRUCTURE, commit="dvc")
        tmp_dir.scm_gen({"folder/.keep": "content"}, commit="add .keep")
        tmp_dir.scm_gen({"empty_scm_folder/": {}}, commit="add scm empty")
        tmp_dir.dvc_gen({"empty_dvc_folder": {}}, commit="empty dvc folder")
    
        with pytest.raises(FileNotFoundError):
            Repo.ls(os.fspath(tmp_dir), path="not_exist_folder")
    
        assert Repo.ls(os.fspath(tmp_dir), path="empty_scm_folder") == []
    
        assert Repo.ls(os.fspath(tmp_dir), path="folder", dvc_only=True) == []
    
>       assert Repo.ls(os.fspath(tmp_dir), path="empty_dvc_folder", dvc_only=True) == []

/home/user/dvc/tests/func/test_ls.py:160: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/ls.py:43: in ls
    ret = _ls(repo, path, recursive, dvc_only)
/home/user/dvc/dvc/repo/ls.py:65: in _ls
    for root, dirs, files in fs.walk(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:282: in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:391: in ls
    return self.fs.ls(path, detail=detail, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ad0c01d460>
key = ('empty_dvc_folder',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:50:21,369 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_ls_repo_with_path_dir_dvc0/structure.xml' to gitignore file.
2023-05-15 22:50:21,502 DEBUG: Computed stage: 'structure.xml.dvc' md5: 'None'
2023-05-15 22:50:22,043 DEBUG: Saving information to 'structure.xml.dvc'.
2023-05-15 22:50:22,264 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_ls_repo_with_path_dir_dvc0/data/subcontent/data.xml' to gitignore file.
2023-05-15 22:50:22,393 DEBUG: Computed stage: 'data/subcontent/data.xml.dvc' md5: 'None'
2023-05-15 22:50:22,869 DEBUG: Saving information to 'data/subcontent/data.xml.dvc'.
2023-05-15 22:50:23,098 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_ls_repo_with_path_dir_dvc0/data/subcontent/statistics/data.csv' to gitignore file.
2023-05-15 22:50:23,209 DEBUG: Computed stage: 'data/subcontent/statistics/data.csv.dvc' md5: 'None'
2023-05-15 22:50:23,733 DEBUG: Saving information to 'data/subcontent/statistics/data.csv.dvc'.
2023-05-15 22:50:23,968 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_ls_repo_with_path_dir_dvc0/model/people.csv' to gitignore file.
2023-05-15 22:50:24,085 DEBUG: Computed stage: 'model/people.csv.dvc' md5: 'None'
2023-05-15 22:50:24,555 DEBUG: Saving information to 'model/people.csv.dvc'.

To track the changes with git, run:

	git add data/subcontent/data.xml.dvc data/subcontent/statistics/data.csv.dvc model/.gitignore .gitignore data/subcontent/.gitignore model/people.csv.dvc data/subcontent/statistics/.gitignore structure.xml.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:50:31,960 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_ls_repo_with_path_dir_dvc0/empty_dvc_folder' to gitignore file.
2023-05-15 22:50:32,119 DEBUG: Computed stage: 'empty_dvc_folder.dvc' md5: 'None'
2023-05-15 22:50:33,137 DEBUG: Saving information to 'empty_dvc_folder.dvc'.

To track the changes with git, run:

	git add .gitignore empty_dvc_folder.dvc

To enable auto staging, run:

	dvc config core.autostage true
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.62file/s]Collecting targets          |2.00 [00:00,  4.24file/s]Collecting targets          |3.00 [00:00,  4.89file/s]Collecting targets          |4.00 [00:00,  4.88file/s]                                                      !  0% Adding...|          |0/4 [00:00<?,     ?file/s] 25% Adding...|██▌       | structure.xml |1/4 [00:00<00:02,  1.11file/s] 50% |█████     | data/subcontent/data.xml |2/4 [00:01<00:01,  1.17file/s] 75% |███████▌  | data/subcontent/statistics/data.csv |3/4 [00:02<00:00,  1.16file/s]100% Adding...|██████████| model/people.csv |4/4 [00:03<00:00,  1.18file/s]          100% Adding...|██████████|4/4 [00:03,  1.16file/s]                         
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.56file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           2023-05-15 22:50:31,906 WARNING: 'empty_dvc_folder' is empty.
100% Adding...|██████████|1/1 [00:01<00:00,  1.48s/file]100% Adding...|██████████|1/1 [00:01,  1.51s/file]      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_ls_repo_with_path_dir_dvc0/structure.xml' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'structure.xml.dvc' md5: 'None'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'structure.xml.dvc'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_ls_repo_with_path_dir_dvc0/data/subcontent/data.xml' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'data/subcontent/data.xml.dvc' md5: 'None'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'data/subcontent/data.xml.dvc'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_ls_repo_with_path_dir_dvc0/data/subcontent/statistics/data.csv' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'data/subcontent/statistics/data.csv.dvc' md5: 'None'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'data/subcontent/statistics/data.csv.dvc'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_ls_repo_with_path_dir_dvc0/model/people.csv' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'model/people.csv.dvc' md5: 'None'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'model/people.csv.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add data/subcontent/data.xml.dvc data/subcontent/statistics/data.csv.dvc model/.gitignore .gitignore data/subcontent/.gitignore model/people.csv.dvc data/subcontent/statistics/.gitignore structure.xml.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
WARNING  dvc.output:output.py:665 'empty_dvc_folder' is empty.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_ls_repo_with_path_dir_dvc0/empty_dvc_folder' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'empty_dvc_folder.dvc' md5: 'None'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'empty_dvc_folder.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore empty_dvc_folder.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
_______________________________ test_ls_granular _______________________________

erepo_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/erepo225')

    def test_ls_granular(erepo_dir):
        with erepo_dir.chdir():
            erepo_dir.dvc_gen(
                {
                    "dir": {
                        "1": "1",
                        "2": "2",
                        "subdir": {"foo": "foo", "bar": "bar"},
                    }
                },
                commit="create dir",
            )
    
>       entries = Repo.ls(os.fspath(erepo_dir), os.path.join("dir", "subdir"))

tests/func/test_ls.py:475: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
dvc/repo/ls.py:43: in ls
    ret = _ls(repo, path, recursive, dvc_only)
dvc/repo/ls.py:62: in _ls
    fs_path = fs.info(fs_path)["name"]
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:467: in info
    return self.fs.info(path, **kwargs)
dvc/fs/dvc.py:330: in info
    return self._info(key, path, ignore_subrepos=ignore_subrepos)
dvc/fs/dvc.py:340: in _info
    dvc_info = dvc_fs.fs.index.info(subkey)
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:413: in info
    entry = self[key]
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:464: in __getitem__
    self._load(dir_key, dir_entry)
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ad26bb0a50>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:54:36,091 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo225/dir' to gitignore file.
2023-05-15 22:54:36,512 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:54:38,095 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.58file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           100% Adding...|██████████|1/1 [00:02<00:00,  2.27s/file]100% Adding...|██████████|1/1 [00:02,  2.30s/file]      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo225/dir' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
____________________________ test_ls_target[False] _____________________________

erepo_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/erepo227')
use_scm = False

    @pytest.mark.parametrize("use_scm", [True, False])
    def test_ls_target(erepo_dir, use_scm):
        with erepo_dir.chdir():
            gen = erepo_dir.scm_gen if use_scm else erepo_dir.dvc_gen
            gen(
                {
                    "dir": {
                        "1": "1",
                        "2": "2",
                        "subdir": {"foo": "foo", "bar": "bar"},
                    }
                },
                commit="create dir",
            )
    
        isout = not use_scm
    
        def _ls(path):
            return Repo.ls(os.fspath(erepo_dir), path)
    
>       assert _ls(os.path.join("dir", "1")) == [
            {"isout": isout, "isdir": False, "isexec": False, "path": "1"}
        ]

tests/func/test_ls.py:509: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/func/test_ls.py:507: in _ls
    return Repo.ls(os.fspath(erepo_dir), path)
dvc/repo/ls.py:43: in ls
    ret = _ls(repo, path, recursive, dvc_only)
dvc/repo/ls.py:62: in _ls
    fs_path = fs.info(fs_path)["name"]
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:467: in info
    return self.fs.info(path, **kwargs)
dvc/fs/dvc.py:330: in info
    return self._info(key, path, ignore_subrepos=ignore_subrepos)
dvc/fs/dvc.py:340: in _info
    dvc_info = dvc_fs.fs.index.info(subkey)
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:413: in info
    entry = self[key]
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:464: in __getitem__
    self._load(dir_key, dir_entry)
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ad066e0b40>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:54:53,722 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo227/dir' to gitignore file.
2023-05-15 22:54:54,154 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 22:54:55,847 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  4.28file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           100% Adding...|██████████|1/1 [00:02<00:00,  2.38s/file]100% Adding...|██████████|1/1 [00:02,  2.42s/file]      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo227/dir' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
_________________________ test_subrepo[True-erepo_dir] _________________________

dvc_top_level = True
erepo = PosixTmpDir('/tmp/pytest-of-user/pytest-384/erepo228')

    @pytest.mark.parametrize(
        "dvc_top_level, erepo",
        [
            (True, pytest.lazy_fixture("erepo_dir")),
            (False, pytest.lazy_fixture("git_dir")),
        ],
    )
    def test_subrepo(dvc_top_level, erepo):
        from tests.func.test_get import make_subrepo
    
        dvc_files = {"foo.txt": "foo.txt", "dvc_dir": {"lorem": "lorem"}}
        scm_files = {"bar.txt": "bar.txt", "scm_dir": {"ipsum": "ipsum"}}
        subrepo = erepo / "subrepo"
        make_subrepo(subrepo, erepo.scm)
    
        for repo in [erepo, subrepo]:
            with repo.chdir():
                repo.scm_gen(scm_files, commit=f"scm track for top {repo}")
                if hasattr(repo, "dvc"):
                    repo.dvc_gen(dvc_files, commit=f"dvc track for {repo}")
    
        def _list_files(repo, path=None):
            return set(map(itemgetter("path"), Repo.ls(os.fspath(repo), path)))
    
        extras = {".dvcignore", ".gitignore"}
        git_tracked_outputs = {"bar.txt", "scm_dir"}
        dvc_files = {"dvc_dir", "foo.txt", "foo.txt.dvc", "dvc_dir.dvc"}
        common_outputs = git_tracked_outputs | extras | dvc_files
    
        top_level_outputs = common_outputs if dvc_top_level else git_tracked_outputs
        assert _list_files(erepo) == top_level_outputs
        assert _list_files(erepo, "scm_dir") == {"ipsum"}
        if dvc_top_level:
>           assert _list_files(erepo, "dvc_dir") == {"lorem"}

tests/func/test_ls.py:554: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/func/test_ls.py:543: in _list_files
    return set(map(itemgetter("path"), Repo.ls(os.fspath(repo), path)))
dvc/repo/ls.py:43: in ls
    ret = _ls(repo, path, recursive, dvc_only)
dvc/repo/ls.py:65: in _ls
    for root, dirs, files in fs.walk(
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
dvc/fs/dvc.py:282: in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:391: in ls
    return self.fs.ls(path, detail=detail, **kwargs)
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ad61b663c0>
key = ('dvc_dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:55:05,198 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo228/subrepo/.dvc/config.local' to gitignore file.
2023-05-15 22:55:05,229 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo228/subrepo/.dvc/tmp' to gitignore file.
2023-05-15 22:55:05,254 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo228/subrepo/.dvc/cache' to gitignore file.
2023-05-15 22:55:05,289 DEBUG: Removing '/var/tmp/dvc/repo/110b5eb0e4e96f398afcc72eee20a514'
2023-05-15 22:55:06,101 DEBUG: Staging files: {'/tmp/pytest-of-user/pytest-384/erepo228/subrepo/.dvc/.gitignore', '/tmp/pytest-of-user/pytest-384/erepo228/subrepo/.dvcignore', '/tmp/pytest-of-user/pytest-384/erepo228/subrepo/.dvc/config'}
Initialized DVC repository.

You can now commit the changes to git.

2023-05-15 22:55:10,897 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo228/foo.txt' to gitignore file.
2023-05-15 22:55:11,021 DEBUG: Computed stage: 'foo.txt.dvc' md5: 'None'
2023-05-15 22:55:11,716 DEBUG: Saving information to 'foo.txt.dvc'.
2023-05-15 22:55:12,060 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo228/dvc_dir' to gitignore file.
2023-05-15 22:55:12,347 DEBUG: Computed stage: 'dvc_dir.dvc' md5: 'None'
2023-05-15 22:55:13,525 DEBUG: Saving information to 'dvc_dir.dvc'.

To track the changes with git, run:

	git add .gitignore dvc_dir.dvc foo.txt.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 22:55:18,710 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo228/subrepo/foo.txt' to gitignore file.
2023-05-15 22:55:18,829 DEBUG: Computed stage: 'foo.txt.dvc' md5: 'None'
2023-05-15 22:55:19,470 DEBUG: Saving information to 'foo.txt.dvc'.
2023-05-15 22:55:19,709 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo228/subrepo/dvc_dir' to gitignore file.
2023-05-15 22:55:19,936 DEBUG: Computed stage: 'dvc_dir.dvc' md5: 'None'
2023-05-15 22:55:20,891 DEBUG: Saving information to 'dvc_dir.dvc'.

To track the changes with git, run:

	git add .gitignore dvc_dir.dvc foo.txt.dvc

To enable auto staging, run:

	dvc config core.autostage true
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  2.85file/s]Collecting targets          |2.00 [00:00,  4.52file/s]                                                      !  0% Adding...|          |0/2 [00:00<?,     ?file/s] 50% Adding...|█████     | foo.txt |1/2 [00:01<00:01,  1.11s/file]100% Adding...|██████████| dvc_dir |2/2 [00:02<00:00,  1.51s/file]100% Adding...|██████████|2/2 [00:02,  1.47s/file]                
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  2.85file/s]Collecting targets          |2.00 [00:00,  3.81file/s]                                                      !  0% Adding...|          |0/2 [00:00<?,     ?file/s] 50% Adding...|█████     | foo.txt |1/2 [00:00<00:00,  1.01file/s]100% Adding...|██████████| dvc_dir |2/2 [00:02<00:00,  1.25s/file]100% Adding...|██████████|2/2 [00:02,  1.23s/file]                
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo228/subrepo/.dvc/config.local' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo228/subrepo/.dvc/tmp' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo228/subrepo/.dvc/cache' to gitignore file.
DEBUG    dvc.utils.fs:fs.py:63 Removing '/var/tmp/dvc/repo/110b5eb0e4e96f398afcc72eee20a514'
DEBUG    dvc.repo.scm_context:scm_context.py:68 Staging files: {'/tmp/pytest-of-user/pytest-384/erepo228/subrepo/.dvc/.gitignore', '/tmp/pytest-of-user/pytest-384/erepo228/subrepo/.dvcignore', '/tmp/pytest-of-user/pytest-384/erepo228/subrepo/.dvc/config'}
INFO     dvc.repo.init:init.py:93 Initialized DVC repository.

INFO     dvc.repo.init:init.py:95 You can now commit the changes to git.

DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo228/foo.txt' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'foo.txt.dvc' md5: 'None'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'foo.txt.dvc'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo228/dvc_dir' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dvc_dir.dvc' md5: 'None'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dvc_dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dvc_dir.dvc foo.txt.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo228/subrepo/foo.txt' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'foo.txt.dvc' md5: 'None'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'foo.txt.dvc'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo228/subrepo/dvc_dir' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dvc_dir.dvc' md5: 'None'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dvc_dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dvc_dir.dvc foo.txt.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
_________________________ test_subrepo[False-git_dir] __________________________

dvc_top_level = False
erepo = PosixTmpDir('/tmp/pytest-of-user/pytest-384/git-erepo12')

    @pytest.mark.parametrize(
        "dvc_top_level, erepo",
        [
            (True, pytest.lazy_fixture("erepo_dir")),
            (False, pytest.lazy_fixture("git_dir")),
        ],
    )
    def test_subrepo(dvc_top_level, erepo):
        from tests.func.test_get import make_subrepo
    
        dvc_files = {"foo.txt": "foo.txt", "dvc_dir": {"lorem": "lorem"}}
        scm_files = {"bar.txt": "bar.txt", "scm_dir": {"ipsum": "ipsum"}}
        subrepo = erepo / "subrepo"
        make_subrepo(subrepo, erepo.scm)
    
        for repo in [erepo, subrepo]:
            with repo.chdir():
                repo.scm_gen(scm_files, commit=f"scm track for top {repo}")
                if hasattr(repo, "dvc"):
                    repo.dvc_gen(dvc_files, commit=f"dvc track for {repo}")
    
        def _list_files(repo, path=None):
            return set(map(itemgetter("path"), Repo.ls(os.fspath(repo), path)))
    
        extras = {".dvcignore", ".gitignore"}
        git_tracked_outputs = {"bar.txt", "scm_dir"}
        dvc_files = {"dvc_dir", "foo.txt", "foo.txt.dvc", "dvc_dir.dvc"}
        common_outputs = git_tracked_outputs | extras | dvc_files
    
        top_level_outputs = common_outputs if dvc_top_level else git_tracked_outputs
        assert _list_files(erepo) == top_level_outputs
        assert _list_files(erepo, "scm_dir") == {"ipsum"}
        if dvc_top_level:
            assert _list_files(erepo, "dvc_dir") == {"lorem"}
    
        assert _list_files(subrepo, ".") == common_outputs
        assert _list_files(subrepo, "scm_dir") == {"ipsum"}
>       assert _list_files(subrepo, "dvc_dir") == {"lorem"}

tests/func/test_ls.py:558: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/func/test_ls.py:543: in _list_files
    return set(map(itemgetter("path"), Repo.ls(os.fspath(repo), path)))
dvc/repo/ls.py:43: in ls
    ret = _ls(repo, path, recursive, dvc_only)
dvc/repo/ls.py:65: in _ls
    for root, dirs, files in fs.walk(
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
dvc/fs/dvc.py:282: in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:391: in ls
    return self.fs.ls(path, detail=detail, **kwargs)
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ad0a3cd5f0>
key = ('dvc_dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

../purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 22:55:35,711 DEBUG: Added '/tmp/pytest-of-user/pytest-384/git-erepo12/subrepo/.dvc/config.local' to gitignore file.
2023-05-15 22:55:35,740 DEBUG: Added '/tmp/pytest-of-user/pytest-384/git-erepo12/subrepo/.dvc/tmp' to gitignore file.
2023-05-15 22:55:35,766 DEBUG: Added '/tmp/pytest-of-user/pytest-384/git-erepo12/subrepo/.dvc/cache' to gitignore file.
2023-05-15 22:55:35,805 DEBUG: Removing '/var/tmp/dvc/repo/d823d579c0f439bb914edd52da0220c0'
2023-05-15 22:55:36,709 DEBUG: Staging files: {'/tmp/pytest-of-user/pytest-384/git-erepo12/subrepo/.dvc/.gitignore', '/tmp/pytest-of-user/pytest-384/git-erepo12/subrepo/.dvcignore', '/tmp/pytest-of-user/pytest-384/git-erepo12/subrepo/.dvc/config'}
Initialized DVC repository.

You can now commit the changes to git.

2023-05-15 22:55:43,113 DEBUG: Added '/tmp/pytest-of-user/pytest-384/git-erepo12/subrepo/foo.txt' to gitignore file.
2023-05-15 22:55:43,208 DEBUG: Computed stage: 'foo.txt.dvc' md5: 'None'
2023-05-15 22:55:43,735 DEBUG: Saving information to 'foo.txt.dvc'.
2023-05-15 22:55:43,974 DEBUG: Added '/tmp/pytest-of-user/pytest-384/git-erepo12/subrepo/dvc_dir' to gitignore file.
2023-05-15 22:55:44,188 DEBUG: Computed stage: 'dvc_dir.dvc' md5: 'None'
2023-05-15 22:55:45,232 DEBUG: Saving information to 'dvc_dir.dvc'.

To track the changes with git, run:

	git add .gitignore dvc_dir.dvc foo.txt.dvc

To enable auto staging, run:

	dvc config core.autostage true
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.65file/s]Collecting targets          |2.00 [00:00,  5.20file/s]                                                      !  0% Adding...|          |0/2 [00:00<?,     ?file/s] 50% Adding...|█████     | foo.txt |1/2 [00:00<00:00,  1.21file/s]100% Adding...|██████████| dvc_dir |2/2 [00:02<00:00,  1.23s/file]100% Adding...|██████████|2/2 [00:02,  1.19s/file]                
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/git-erepo12/subrepo/.dvc/config.local' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/git-erepo12/subrepo/.dvc/tmp' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/git-erepo12/subrepo/.dvc/cache' to gitignore file.
DEBUG    dvc.utils.fs:fs.py:63 Removing '/var/tmp/dvc/repo/d823d579c0f439bb914edd52da0220c0'
DEBUG    dvc.repo.scm_context:scm_context.py:68 Staging files: {'/tmp/pytest-of-user/pytest-384/git-erepo12/subrepo/.dvc/.gitignore', '/tmp/pytest-of-user/pytest-384/git-erepo12/subrepo/.dvcignore', '/tmp/pytest-of-user/pytest-384/git-erepo12/subrepo/.dvc/config'}
INFO     dvc.repo.init:init.py:93 Initialized DVC repository.

INFO     dvc.repo.init:init.py:95 You can now commit the changes to git.

DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/git-erepo12/subrepo/foo.txt' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'foo.txt.dvc' md5: 'None'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'foo.txt.dvc'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/git-erepo12/subrepo/dvc_dir' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dvc_dir.dvc' md5: 'None'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dvc_dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dvc_dir.dvc foo.txt.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
____________________________ test_view_granular_dir ____________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_view_granular_dir0')
scm = Git: '/tmp/pytest-of-user/pytest-384/test_view_granular_dir0/.git'
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_view_granular_dir0'
run_copy = <function run_copy.<locals>.run_copy at 0x14ac36be2050>

    def test_view_granular_dir(tmp_dir, scm, dvc, run_copy):
        tmp_dir.dvc_gen(
            {"dir": {"subdir": {"in-subdir": "in-subdir"}, "in-dir": "in-dir"}},
            commit="init",
        )
        index = Index.from_repo(dvc)
    
        # view should include the specific target, parent dirs, and children
        # view should exclude any siblings of the target
        view = index.targets_view("dir/subdir")
    
        assert view.data_keys == {
            "repo": {
                ("dir", "subdir"),
            }
        }
    
        data_index = view.data["repo"]
        assert ("dir",) in data_index
>       assert (
            "dir",
            "subdir",
        ) in data_index

/home/user/dvc/tests/func/test_repo_index.py:209: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/purepython/cpython-3.9/Lib/_collections_abc.py:769: in __contains__
    self[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/view.py:31: in __getitem__
    return self._index[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:464: in __getitem__
    self._load(dir_key, dir_entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ac3bfd5230>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 23:06:01,325 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_view_granular_dir0/dir' to gitignore file.
2023-05-15 23:06:01,609 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 23:06:02,774 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 23:06:05,404 DEBUG: Checking if stage 'dir/subdir' is in 'dvc.yaml'
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.54file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           100% Adding...|██████████|1/1 [00:01<00:00,  1.69s/file]100% Adding...|██████████|1/1 [00:01,  1.72s/file]      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_view_granular_dir0/dir' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.repo.stage:stage.py:80 Checking if stage 'dir/subdir' is in 'dvc.yaml'
___________________________ test_update_import[True] ___________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_update_import_True_0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_update_import_True_0'
erepo_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/erepo230')
cached = True

    @pytest.mark.parametrize("cached", [True, False])
    def test_update_import(tmp_dir, dvc, erepo_dir, cached):
        gen = erepo_dir.dvc_gen if cached else erepo_dir.scm_gen
    
        with erepo_dir.branch("branch", new=True), erepo_dir.chdir():
            gen(
                {
                    "version": "branch",
                    "dir": {"version": "branch", "subdir": {"file": "file"}},
                },
                commit="add version file",
            )
            old_rev = erepo_dir.scm.get_rev()
    
        stage = dvc.imp(os.fspath(erepo_dir), "version", "version", rev="branch")
>       dir_stage = dvc.imp(os.fspath(erepo_dir), "dir", "dir", rev="branch")

/home/user/dvc/tests/func/test_update.py:26: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/repo/imp.py:6: in imp
    return self.imp_url(path, out=out, fname=fname, erepo=erepo, frozen=True, **kwargs)
/home/user/dvc/dvc/repo/__init__.py:65: in wrapper
    return f(repo, *args, **kwargs)
/home/user/dvc/dvc/repo/scm_context.py:151: in run
    return method(repo, *args, **kw)
/home/user/dvc/dvc/repo/imp_url.py:91: in imp_url
    stage.run(jobs=jobs, no_download=no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:577: in run
    self._sync_import(dry, force, kwargs.get("jobs", None), no_download)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:45: in wrapper
    return deco(call, *dargs, **dkwargs)
/home/user/dvc/dvc/stage/decorators.py:43: in rwlocked
    return call()
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/funcy/decorators.py:66: in __call__
    return self._func(*self._args, **self._kwargs)
/home/user/dvc/dvc/stage/__init__.py:611: in _sync_import
    sync_import(self, dry, force, jobs, no_download)
/home/user/dvc/dvc/stage/imports.py:61: in sync_import
    stage.deps[0].download(
/home/user/dvc/dvc/dependency/repo.py:84: in download
    for odb, objs in self.get_used_objs().items():
/home/user/dvc/dvc/dependency/repo.py:111: in get_used_objs
    used, _, _ = self._get_used_and_obj(**kwargs)
/home/user/dvc/dvc/dependency/repo.py:148: in _get_used_and_obj
    object_store, meta, obj = build(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:244: in build
    meta, obj = _build_tree(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:126: in _build_tree
    for root, _, fnames in walk_iter:
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:282: in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:391: in ls
    return self.fs.ls(path, detail=detail, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ab59e13640>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-15 23:54:15,023 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo230/version' to gitignore file.
2023-05-15 23:54:15,129 DEBUG: Computed stage: 'version.dvc' md5: 'None'
2023-05-15 23:54:15,609 DEBUG: Saving information to 'version.dvc'.
2023-05-15 23:54:15,815 DEBUG: Added '/tmp/pytest-of-user/pytest-384/erepo230/dir' to gitignore file.
2023-05-15 23:54:16,071 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-15 23:54:17,115 DEBUG: Saving information to 'dir.dvc'.

To track the changes with git, run:

	git add .gitignore dir.dvc version.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-15 23:54:20,427 DEBUG: Removing output 'version' of stage: 'version.dvc'.
Importing 'version (/tmp/pytest-of-user/pytest-384/erepo230)' -> 'version'
2023-05-15 23:54:20,620 DEBUG: Computed stage: 'version.dvc' md5: '87ac1d484b648704f8360b179dbaed89'
2023-05-15 23:54:20,634 DEBUG: 'md5' of stage: 'version.dvc' changed.
2023-05-15 23:54:20,651 DEBUG: Creating external repo /tmp/pytest-of-user/pytest-384/erepo230@branch
2023-05-15 23:54:20,664 DEBUG: erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo230' to a temporary dir
2023-05-15 23:54:22,645 DEBUG: Checking if stage '/version' is in 'dvc.yaml'
2023-05-15 23:54:23,808 DEBUG: Computed stage: 'version.dvc' md5: '6aa98040ce67e1171d72609ad95ae2e9'
2023-05-15 23:54:24,273 DEBUG: Saving information to 'version.dvc'.
2023-05-15 23:54:25,145 DEBUG: Removing output 'dir' of stage: 'dir.dvc'.
Importing 'dir (/tmp/pytest-of-user/pytest-384/erepo230)' -> 'dir'
2023-05-15 23:54:25,327 DEBUG: Computed stage: 'dir.dvc' md5: '02b585030745bac0d0d71138ac74c0f8'
2023-05-15 23:54:25,340 DEBUG: 'md5' of stage: 'dir.dvc' changed.
2023-05-15 23:54:25,358 DEBUG: Creating external repo /tmp/pytest-of-user/pytest-384/erepo230@branch
2023-05-15 23:54:25,393 DEBUG: erepo: git pull '/tmp/pytest-of-user/pytest-384/erepo230'
2023-05-15 23:54:27,128 DEBUG: Checking if stage '/dir' is in 'dvc.yaml'
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  5.15file/s]Collecting targets          |2.00 [00:00,  6.52file/s]                                                      !  0% Adding...|          |0/2 [00:00<?,     ?file/s] 50% Adding...|█████     | version |1/2 [00:00<00:00,  1.22file/s]100% Adding...|██████████| dir |2/2 [00:02<00:00,  1.22s/file]    100% Adding...|██████████|2/2 [00:02,  1.18s/file]            
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Cloning erepo230|          |0.00/? [00:00,      ?obj/s]                                                       !If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo230/version' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'version.dvc' md5: 'None'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'version.dvc'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/erepo230/dir' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir.dvc version.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.stage:__init__.py:387 Removing output 'version' of stage: 'version.dvc'.
INFO     dvc.stage.imports:imports.py:49 Importing 'version (/tmp/pytest-of-user/pytest-384/erepo230)' -> 'version'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'version.dvc' md5: '87ac1d484b648704f8360b179dbaed89'
DEBUG    dvc.stage:__init__.py:363 'md5' of stage: 'version.dvc' changed.
DEBUG    dvc.external_repo:external_repo.py:33 Creating external repo /tmp/pytest-of-user/pytest-384/erepo230@branch
DEBUG    dvc.external_repo:external_repo.py:195 erepo: git clone '/tmp/pytest-of-user/pytest-384/erepo230' to a temporary dir
DEBUG    dvc.repo.stage:stage.py:80 Checking if stage '/version' is in 'dvc.yaml'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'version.dvc' md5: '6aa98040ce67e1171d72609ad95ae2e9'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'version.dvc'.
DEBUG    dvc.stage:__init__.py:387 Removing output 'dir' of stage: 'dir.dvc'.
INFO     dvc.stage.imports:imports.py:49 Importing 'dir (/tmp/pytest-of-user/pytest-384/erepo230)' -> 'dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: '02b585030745bac0d0d71138ac74c0f8'
DEBUG    dvc.stage:__init__.py:363 'md5' of stage: 'dir.dvc' changed.
DEBUG    dvc.external_repo:external_repo.py:33 Creating external repo /tmp/pytest-of-user/pytest-384/erepo230@branch
DEBUG    dvc.external_repo:external_repo.py:190 erepo: git pull '/tmp/pytest-of-user/pytest-384/erepo230'
DEBUG    scmrepo.git.backend.pygit2:pygit2.py:505 fetch_refspecs: []
DEBUG    dvc.repo.stage:stage.py:80 Checking if stage '/dir' is in 'dvc.yaml'
________________________________ test_dir_plots ________________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_dir_plots0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_dir_plots0'
run_copy_metrics = <function run_copy_metrics.<locals>.run at 0x14ab37f7b410>

    def test_dir_plots(tmp_dir, dvc, run_copy_metrics):
        subdir = tmp_dir / "subdir"
        subdir.mkdir()
    
        metric = [{"first_val": 100, "val": 2}, {"first_val": 200, "val": 3}]
    
        fname = "file.json"
        (tmp_dir / fname).dump_json(metric, sort_keys=True)
    
        p1 = "subdir/p1.json"
        p2 = "subdir/p2.json"
        tmp_dir.dvc.run(
            cmd=(
                f"mkdir subdir && python copy.py {fname} {p1} && "
                f"python copy.py {fname} {p2}"
            ),
            deps=[fname],
            single_stage=False,
            plots=["subdir"],
            name="copy_double",
        )
        dvc.plots.modify("subdir", {"title": "TITLE"})
    
        result = dvc.plots.show()
>       assert get_plot(result, "workspace", typ="definitions", file="") == {
            p1: {"title": "TITLE"},
            p2: {"title": "TITLE"},
        }

/home/user/dvc/tests/func/plots/test_modify.py:91: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/tests/utils/plots.py:8: in get_plot
    return dpath.get(plots_data, [revision, typ, "data", file, endkey])
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

obj = {'workspace': {'definitions': {'data': {'': {'error': OperationalError('no such column: False')}}}, 'sources': {'data'...or("'subdir' - file type error\nOnly JSON, YAML, CSV and TSV formats are supported."), 'props': {'title': 'TITLE'}}}}}}
glob = ['workspace', 'definitions', 'data', '', 'data'], separator = '/'
default = <object object at 0x14aef08ddb20>

    def get(
            obj: MutableMapping,
            glob: Glob,
            separator="/",
            default: Any = _DEFAULT_SENTINEL
    ) -> Union[MutableMapping, object, Callable]:
        """
        Given an object which contains only one possible match for the given glob,
        return the value for the leaf matching the given glob.
        If the glob is not found and a default is provided,
        the default is returned.
    
        If more than one leaf matches the glob, ValueError is raised. If the glob is
        not found and a default is not provided, KeyError is raised.
        """
        if glob == "/":
            return obj
    
        globlist = _split_path(glob, separator)
    
        def f(_, pair, results):
            (path_segments, found) = pair
    
            if segments.match(path_segments, globlist):
                results.append(found)
            if len(results) > 1:
                return False
    
        results = segments.fold(obj, f, [])
    
        if len(results) == 0:
            if default is not _DEFAULT_SENTINEL:
                return default
    
>           raise KeyError(glob)
E           KeyError: ['workspace', 'definitions', 'data', '', 'data']

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dpath/__init__.py:189: KeyError
----------------------------- Captured stdout call -----------------------------
2023-05-16 00:08:38,448 DEBUG: Removing output 'subdir' of stage: 'copy_double'.
2023-05-16 00:08:38,774 DEBUG: {'file.json': 'modified'}
Running stage 'copy_double':
> mkdir subdir && python copy.py file.json subdir/p1.json && python copy.py file.json subdir/p2.json
2023-05-16 00:08:41,139 DEBUG: Computed stage: 'copy_double' md5: '34b533efbd7fc956b32cfc88461c6920'
Creating 'dvc.yaml'
Adding stage 'copy_double' in 'dvc.yaml'
Generating lock file 'dvc.lock'
Updating lock file 'dvc.lock'
Modifying stage 'copy_double' in 'dvc.yaml'
2023-05-16 00:08:44,722 DEBUG: no such column: False
Traceback (most recent call last):
  File "/home/user/dvc/dvc/utils/__init__.py", line 400, in wrapper
    vals = func(*args, **kwargs)
  File "/home/user/dvc/dvc/repo/plots/__init__.py", line 67, in _unpack_dir_files
    ret = list(fs.find(path))
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py", line 401, in find
    yield from self.fs.find(path)
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py", line 454, in find
    for _, dirs, files in self.walk(path, maxdepth, detail=True, **kwargs):
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py", line 393, in walk
    listing = self.ls(path, detail=True, **kwargs)
  File "/home/user/dvc/dvc/fs/dvc.py", line 282, in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py", line 391, in ls
    return self.fs.ls(path, detail=detail, **kwargs)
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py", line 102, in ls
    for key, info in self.index.ls(root_key, detail=True):
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py", line 582, in ls
    self._ensure_loaded(root_key)
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py", line 577, in _ensure_loaded
    self._load(prefix, entry)
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py", line 525, in _load
    del self._trie[key]
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py", line 109, in __delitem__
    super().__delitem__(key)
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py", line 62, in __delitem__
    del self._trie[key]
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py", line 214, in __delitem__
    self._conn.execute(
sqlite3.OperationalError: no such column: False

2023-05-16 00:08:44,855 DEBUG: 'subdir' - file type error
Only JSON, YAML, CSV and TSV formats are supported.
Traceback (most recent call last):
  File "/home/user/dvc/dvc/utils/__init__.py", line 400, in wrapper
    vals = func(*args, **kwargs)
  File "/home/user/dvc/dvc/repo/plots/__init__.py", line 555, in parse
    raise PlotMetricTypeError(path)
dvc.repo.plots.PlotMetricTypeError: 'subdir' - file type error
Only JSON, YAML, CSV and TSV formats are supported.

----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !  0% Reading plot's data from workspace|          |0/1 [00:00<?,    ?files/s]100% |██████████|1/1 [00:00<00:00,  9.20files/s]                                                                             DVC failed to load some plots for following revisions: 'workspace'.
------------------------------ Captured log call -------------------------------
DEBUG    dvc.stage:__init__.py:387 Removing output 'subdir' of stage: 'copy_double'.
DEBUG    dvc.output:output.py:615 {'file.json': 'modified'}
INFO     dvc.stage.run:run.py:120 Running stage 'copy_double':
INFO     dvc.stage.run:run.py:71 > mkdir subdir && python copy.py file.json subdir/p1.json && python copy.py file.json subdir/p2.json
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'copy_double' md5: '34b533efbd7fc956b32cfc88461c6920'
INFO     dvc.dvcfile:dvcfile.py:276 Creating 'dvc.yaml'
INFO     dvc.dvcfile:dvcfile.py:281 Adding stage 'copy_double' in 'dvc.yaml'
INFO     dvc.dvcfile:dvcfile.py:415 Generating lock file 'dvc.lock'
INFO     dvc.dvcfile:dvcfile.py:422 Updating lock file 'dvc.lock'
INFO     dvc.dvcfile:dvcfile.py:281 Modifying stage 'copy_double' in 'dvc.yaml'
DEBUG    dvc.utils:__init__.py:412 
Traceback (most recent call last):
  File "/home/user/dvc/dvc/utils/__init__.py", line 400, in wrapper
    vals = func(*args, **kwargs)
  File "/home/user/dvc/dvc/repo/plots/__init__.py", line 67, in _unpack_dir_files
    ret = list(fs.find(path))
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py", line 401, in find
    yield from self.fs.find(path)
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py", line 454, in find
    for _, dirs, files in self.walk(path, maxdepth, detail=True, **kwargs):
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py", line 393, in walk
    listing = self.ls(path, detail=True, **kwargs)
  File "/home/user/dvc/dvc/fs/dvc.py", line 282, in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py", line 391, in ls
    return self.fs.ls(path, detail=detail, **kwargs)
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py", line 102, in ls
    for key, info in self.index.ls(root_key, detail=True):
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py", line 582, in ls
    self._ensure_loaded(root_key)
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py", line 577, in _ensure_loaded
    self._load(prefix, entry)
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py", line 525, in _load
    del self._trie[key]
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py", line 109, in __delitem__
    super().__delitem__(key)
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py", line 62, in __delitem__
    del self._trie[key]
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py", line 214, in __delitem__
    self._conn.execute(
sqlite3.OperationalError: no such column: False
DEBUG    dvc.utils:__init__.py:412 
Traceback (most recent call last):
  File "/home/user/dvc/dvc/utils/__init__.py", line 400, in wrapper
    vals = func(*args, **kwargs)
  File "/home/user/dvc/dvc/repo/plots/__init__.py", line 555, in parse
    raise PlotMetricTypeError(path)
dvc.repo.plots.PlotMetricTypeError: 'subdir' - file type error
Only JSON, YAML, CSV and TSV formats are supported.
________________________________ test_dir_plots ________________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_dir_plots1')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_dir_plots1'
run_copy_metrics = <function run_copy_metrics.<locals>.run at 0x14ab257a5690>

    def test_dir_plots(tmp_dir, dvc, run_copy_metrics):
        subdir = tmp_dir / "subdir"
        subdir.mkdir()
    
        metric = [{"first_val": 100, "val": 2}, {"first_val": 200, "val": 3}]
    
        fname = "file.json"
        (tmp_dir / fname).dump_json(metric, sort_keys=True)
    
        p1 = "subdir/p1.json"
        p2 = "subdir/p2.json"
        tmp_dir.dvc.run(
            cmd=(
                f"mkdir subdir && python copy.py {fname} {p1} && "
                f"python copy.py {fname} {p2}"
            ),
            deps=[fname],
            single_stage=False,
            plots=["subdir"],
            name="copy_double",
        )
        props = {"title": "TITLE"}
        dvc.plots.modify("subdir", props)
    
        result = dvc.plots.show()
    
>       assert set(get_plot(result, "workspace")) == {p1, p2}
E       AssertionError: assert {'subdir'} == {'subdir/p1.j...bdir/p2.json'}
E         Extra items in the left set:
E         'subdir'
E         Extra items in the right set:
E         'subdir/p2.json'
E         'subdir/p1.json'
E         Use -v to get more diff

/home/user/dvc/tests/func/plots/test_show.py:202: AssertionError
----------------------------- Captured stdout call -----------------------------
2023-05-16 00:10:03,212 DEBUG: Removing output 'subdir' of stage: 'copy_double'.
2023-05-16 00:10:03,530 DEBUG: {'file.json': 'modified'}
Running stage 'copy_double':
> mkdir subdir && python copy.py file.json subdir/p1.json && python copy.py file.json subdir/p2.json
2023-05-16 00:10:05,995 DEBUG: Computed stage: 'copy_double' md5: '34b533efbd7fc956b32cfc88461c6920'
Creating 'dvc.yaml'
Adding stage 'copy_double' in 'dvc.yaml'
Generating lock file 'dvc.lock'
Updating lock file 'dvc.lock'
Modifying stage 'copy_double' in 'dvc.yaml'
2023-05-16 00:10:09,451 DEBUG: no such column: False
Traceback (most recent call last):
  File "/home/user/dvc/dvc/utils/__init__.py", line 400, in wrapper
    vals = func(*args, **kwargs)
  File "/home/user/dvc/dvc/repo/plots/__init__.py", line 67, in _unpack_dir_files
    ret = list(fs.find(path))
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py", line 401, in find
    yield from self.fs.find(path)
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py", line 454, in find
    for _, dirs, files in self.walk(path, maxdepth, detail=True, **kwargs):
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py", line 393, in walk
    listing = self.ls(path, detail=True, **kwargs)
  File "/home/user/dvc/dvc/fs/dvc.py", line 282, in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py", line 391, in ls
    return self.fs.ls(path, detail=detail, **kwargs)
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py", line 102, in ls
    for key, info in self.index.ls(root_key, detail=True):
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py", line 582, in ls
    self._ensure_loaded(root_key)
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py", line 577, in _ensure_loaded
    self._load(prefix, entry)
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py", line 525, in _load
    del self._trie[key]
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py", line 109, in __delitem__
    super().__delitem__(key)
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py", line 62, in __delitem__
    del self._trie[key]
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py", line 214, in __delitem__
    self._conn.execute(
sqlite3.OperationalError: no such column: False

2023-05-16 00:10:09,564 DEBUG: 'subdir' - file type error
Only JSON, YAML, CSV and TSV formats are supported.
Traceback (most recent call last):
  File "/home/user/dvc/dvc/utils/__init__.py", line 400, in wrapper
    vals = func(*args, **kwargs)
  File "/home/user/dvc/dvc/repo/plots/__init__.py", line 555, in parse
    raise PlotMetricTypeError(path)
dvc.repo.plots.PlotMetricTypeError: 'subdir' - file type error
Only JSON, YAML, CSV and TSV formats are supported.

----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !  0% Reading plot's data from workspace|          |0/1 [00:00<?,    ?files/s]                                                                             DVC failed to load some plots for following revisions: 'workspace'.
------------------------------ Captured log call -------------------------------
DEBUG    dvc.stage:__init__.py:387 Removing output 'subdir' of stage: 'copy_double'.
DEBUG    dvc.output:output.py:615 {'file.json': 'modified'}
INFO     dvc.stage.run:run.py:120 Running stage 'copy_double':
INFO     dvc.stage.run:run.py:71 > mkdir subdir && python copy.py file.json subdir/p1.json && python copy.py file.json subdir/p2.json
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'copy_double' md5: '34b533efbd7fc956b32cfc88461c6920'
INFO     dvc.dvcfile:dvcfile.py:276 Creating 'dvc.yaml'
INFO     dvc.dvcfile:dvcfile.py:281 Adding stage 'copy_double' in 'dvc.yaml'
INFO     dvc.dvcfile:dvcfile.py:415 Generating lock file 'dvc.lock'
INFO     dvc.dvcfile:dvcfile.py:422 Updating lock file 'dvc.lock'
INFO     dvc.dvcfile:dvcfile.py:281 Modifying stage 'copy_double' in 'dvc.yaml'
DEBUG    dvc.utils:__init__.py:412 
Traceback (most recent call last):
  File "/home/user/dvc/dvc/utils/__init__.py", line 400, in wrapper
    vals = func(*args, **kwargs)
  File "/home/user/dvc/dvc/repo/plots/__init__.py", line 67, in _unpack_dir_files
    ret = list(fs.find(path))
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py", line 401, in find
    yield from self.fs.find(path)
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py", line 454, in find
    for _, dirs, files in self.walk(path, maxdepth, detail=True, **kwargs):
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py", line 393, in walk
    listing = self.ls(path, detail=True, **kwargs)
  File "/home/user/dvc/dvc/fs/dvc.py", line 282, in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py", line 391, in ls
    return self.fs.ls(path, detail=detail, **kwargs)
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py", line 102, in ls
    for key, info in self.index.ls(root_key, detail=True):
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py", line 582, in ls
    self._ensure_loaded(root_key)
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py", line 577, in _ensure_loaded
    self._load(prefix, entry)
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py", line 525, in _load
    del self._trie[key]
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py", line 109, in __delitem__
    super().__delitem__(key)
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py", line 62, in __delitem__
    del self._trie[key]
  File "/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py", line 214, in __delitem__
    self._conn.execute(
sqlite3.OperationalError: no such column: False
DEBUG    dvc.utils:__init__.py:412 
Traceback (most recent call last):
  File "/home/user/dvc/dvc/utils/__init__.py", line 400, in wrapper
    vals = func(*args, **kwargs)
  File "/home/user/dvc/dvc/repo/plots/__init__.py", line 555, in parse
    raise PlotMetricTypeError(path)
dvc.repo.plots.PlotMetricTypeError: 'subdir' - file type error
Only JSON, YAML, CSV and TSV formats are supported.
________________________________ test_walk_dir _________________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_walk_dir0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_walk_dir0'

    def test_walk_dir(tmp_dir, dvc):
        tmp_dir.gen(
            {
                "dir": {
                    "subdir1": {"foo1": "foo1", "bar1": "bar1"},
                    "subdir2": {"foo2": "foo2"},
                    "foo": "foo",
                    "bar": "bar",
                }
            }
        )
    
        dvc.add("dir")
        fs = DataFileSystem(index=dvc.index.data["repo"])
    
        expected = [
            "dir/subdir1",
            "dir/subdir2",
            "dir/subdir1/foo1",
            "dir/subdir1/bar1",
            "dir/subdir2/foo2",
            "dir/foo",
            "dir/bar",
        ]
    
        actual = []
>       for root, dirs, files in fs.walk("dir"):

/home/user/dvc/tests/unit/fs/test_data.py:188: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14aa71b110f0>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-16 00:45:00,173 DEBUG: built tree 'object df09b691efe81ba4cd6ac989a08be804.dir'
2023-05-16 00:45:00,189 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-16 00:45:00,607 DEBUG: built tree 'object df09b691efe81ba4cd6ac989a08be804.dir'
2023-05-16 00:45:00,625 DEBUG: Preparing to transfer data from 'memory://dvc-staging/d56d2e9e9ea6ade9a07de3537bdaeeb36240daedb9f1f512bbb08f8285db5683' to '/tmp/pytest-of-user/pytest-384/test_walk_dir0/.dvc/cache'
2023-05-16 00:45:00,636 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_dir0/.dvc/cache'
2023-05-16 00:45:00,680 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_dir0/.dvc/cache'
2023-05-16 00:45:00,888 DEBUG: Preparing to collect status from 'memory://dvc-staging/d56d2e9e9ea6ade9a07de3537bdaeeb36240daedb9f1f512bbb08f8285db5683'
2023-05-16 00:45:01,831 DEBUG: built tree 'object df09b691efe81ba4cd6ac989a08be804.dir'
2023-05-16 00:45:01,973 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:45:02,009 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_dir0/.XUUppcBguGnjtcGgAqMJJd.tmp'
2023-05-16 00:45:02,051 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_dir0/.XUUppcBguGnjtcGgAqMJJd.tmp'
2023-05-16 00:45:02,065 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_dir0/.dvc/cache/.3bX398akm8h5UxkDBs4Jzk.tmp'
2023-05-16 00:45:02,084 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_dir0/dir/foo'
2023-05-16 00:45:02,164 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_dir0/dir/subdir1/foo1'
2023-05-16 00:45:02,236 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_dir0/dir/bar'
2023-05-16 00:45:02,308 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_dir0/dir/subdir2/foo2'
2023-05-16 00:45:02,381 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_dir0/dir/subdir1/bar1'
2023-05-16 00:45:02,624 DEBUG: Saving information to 'dir.dvc'.
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  5.06file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |2.00 [00:00,   19.2obj/s][A
Building data objects from dir          |4.00 [00:00,   16.2obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |4.00 [00:00,   38.8obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
 83% |████████▎ |5/6 [00:00<00:00, 49.71files/s][A
                                                [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/5 [00:00<?,     ?file/s][A
  0%|          |Transferring                      5/? [00:00<00:00, 24.99file/s][A
  0%|          |Transferring                      5/? [00:00<00:00, 24.99file/s][A

![A[A

  0%|          |memory://.9xxmcS2rNdvthjMVCj7Gc2.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.9xxmcS2rNdvthjMVCj7Gc2.0.00/342 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |5.00 [00:00,   41.8obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:03<00:00,  3.25s/file]100% Adding...|██████████|1/1 [00:03,  3.28s/file]      
------------------------------ Captured log call -------------------------------
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object df09b691efe81ba4cd6ac989a08be804.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object df09b691efe81ba4cd6ac989a08be804.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/d56d2e9e9ea6ade9a07de3537bdaeeb36240daedb9f1f512bbb08f8285db5683' to '/tmp/pytest-of-user/pytest-384/test_walk_dir0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_dir0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_dir0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/d56d2e9e9ea6ade9a07de3537bdaeeb36240daedb9f1f512bbb08f8285db5683'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object df09b691efe81ba4cd6ac989a08be804.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_dir0/.XUUppcBguGnjtcGgAqMJJd.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_dir0/.XUUppcBguGnjtcGgAqMJJd.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_dir0/.dvc/cache/.3bX398akm8h5UxkDBs4Jzk.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_dir0/dir/foo'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_dir0/dir/subdir1/foo1'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_dir0/dir/bar'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_dir0/dir/subdir2/foo2'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_dir0/dir/subdir1/bar1'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
____________________________ test_get_hash_granular ____________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_get_hash_granular0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_get_hash_granular0'

    def test_get_hash_granular(tmp_dir, dvc):
        tmp_dir.dvc_gen({"dir": {"foo": "foo", "bar": "bar", "subdir": {"data": "data"}}})
        fs = DataFileSystem(index=dvc.index.data["repo"])
        subdir = "dir/subdir"
>       assert fs.info(subdir).get("md5") is None

/home/user/dvc/tests/unit/fs/test_data.py:237: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:467: in info
    return self.fs.info(path, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:121: in info
    info = self.index.info(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:413: in info
    entry = self[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:464: in __getitem__
    self._load(dir_key, dir_entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14a9c1bc5370>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-16 00:45:25,585 DEBUG: built tree 'object 8761c4e9acad696bee718615e23e22db.dir'
2023-05-16 00:45:25,599 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-16 00:45:25,955 DEBUG: built tree 'object 8761c4e9acad696bee718615e23e22db.dir'
2023-05-16 00:45:25,973 DEBUG: Preparing to transfer data from 'memory://dvc-staging/2e906ce976ce855f3cf336f96ac3f2e5bed77e8e108673c64869eacd5743d403' to '/tmp/pytest-of-user/pytest-384/test_get_hash_granular0/.dvc/cache'
2023-05-16 00:45:25,985 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_get_hash_granular0/.dvc/cache'
2023-05-16 00:45:26,022 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_get_hash_granular0/.dvc/cache'
2023-05-16 00:45:26,174 DEBUG: Preparing to collect status from 'memory://dvc-staging/2e906ce976ce855f3cf336f96ac3f2e5bed77e8e108673c64869eacd5743d403'
2023-05-16 00:45:26,985 DEBUG: built tree 'object 8761c4e9acad696bee718615e23e22db.dir'
2023-05-16 00:45:27,045 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:45:27,058 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_granular0/.RTxj8MRd5E7m4hbX2iXDfG.tmp'
2023-05-16 00:45:27,103 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_granular0/.RTxj8MRd5E7m4hbX2iXDfG.tmp'
2023-05-16 00:45:27,119 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_granular0/.dvc/cache/.DkC3tvhiCXNALSutx6KgCS.tmp'
2023-05-16 00:45:27,140 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_granular0/dir/foo'
2023-05-16 00:45:27,216 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_granular0/dir/bar'
2023-05-16 00:45:27,292 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_granular0/dir/subdir/data'
2023-05-16 00:45:27,521 DEBUG: Saving information to 'dir.dvc'.
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  5.15file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |2.00 [00:00,   14.8obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/3 [00:00<?,     ?file/s][A
  0%|          |Transferring                      3/? [00:00<00:00, 20.05file/s][A
  0%|          |Transferring                      3/? [00:00<00:00, 20.05file/s][A

![A[A

  0%|          |memory://.nDD9eoUvrhGCpXVRQmr7Gd.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.nDD9eoUvrhGCpXVRQmr7Gd.0.00/197 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.64s/file]100% Adding...|██████████|1/1 [00:02,  2.67s/file]      
------------------------------ Captured log call -------------------------------
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 8761c4e9acad696bee718615e23e22db.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 8761c4e9acad696bee718615e23e22db.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/2e906ce976ce855f3cf336f96ac3f2e5bed77e8e108673c64869eacd5743d403' to '/tmp/pytest-of-user/pytest-384/test_get_hash_granular0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_get_hash_granular0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_get_hash_granular0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/2e906ce976ce855f3cf336f96ac3f2e5bed77e8e108673c64869eacd5743d403'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 8761c4e9acad696bee718615e23e22db.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_granular0/.RTxj8MRd5E7m4hbX2iXDfG.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_granular0/.RTxj8MRd5E7m4hbX2iXDfG.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_granular0/.dvc/cache/.DkC3tvhiCXNALSutx6KgCS.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_granular0/dir/foo'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_granular0/dir/bar'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_granular0/dir/subdir/data'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
___________________________ test_get_hash_dirty_dir ____________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir0'

    def test_get_hash_dirty_dir(tmp_dir, dvc):
        tmp_dir.dvc_gen({"dir": {"foo": "foo", "bar": "bar"}})
        (tmp_dir / "dir" / "baz").write_text("baz")
    
        fs = DataFileSystem(index=dvc.index.data["repo"])
        expected = "5ea40360f5b4ec688df672a4db9c17d1.dir"
        assert fs.info("dir").get("md5") == expected
>       _, _, obj = build(dvc.cache.local, "dir", fs, "md5", dry_run=True)

/home/user/dvc/tests/unit/fs/test_data.py:264: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:244: in build
    meta, obj = _build_tree(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:126: in _build_tree
    for root, _, fnames in walk_iter:
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14a986819500>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-16 00:45:36,673 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-16 00:45:36,688 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-16 00:45:36,997 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-16 00:45:37,016 DEBUG: Preparing to transfer data from 'memory://dvc-staging/fb2f723c69825a42e941565cc15230adb545b3faf45b8d9ddeea7029039b2ba1' to '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir0/.dvc/cache'
2023-05-16 00:45:37,028 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir0/.dvc/cache'
2023-05-16 00:45:37,062 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir0/.dvc/cache'
2023-05-16 00:45:37,199 DEBUG: Preparing to collect status from 'memory://dvc-staging/fb2f723c69825a42e941565cc15230adb545b3faf45b8d9ddeea7029039b2ba1'
2023-05-16 00:45:37,949 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-16 00:45:37,995 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:45:38,008 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir0/.Jc74sGsWrbNJmkrMMDeGDh.tmp'
2023-05-16 00:45:38,051 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir0/.Jc74sGsWrbNJmkrMMDeGDh.tmp'
2023-05-16 00:45:38,066 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir0/.dvc/cache/.YGRDfP3Nn7q9AyWfingYdP.tmp'
2023-05-16 00:45:38,086 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir0/dir/foo'
2023-05-16 00:45:38,161 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir0/dir/bar'
2023-05-16 00:45:38,358 DEBUG: Saving information to 'dir.dvc'.
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  5.20file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/2 [00:00<?,     ?file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 16.56file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 16.56file/s][A

![A[A

  0%|          |memory://.NZsmyqHMGCWFiZsob2WXkF.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.NZsmyqHMGCWFiZsob2WXkF.0.00/126 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.22s/file]100% Adding...|██████████|1/1 [00:02,  2.25s/file]      
!Building data objects from dir          |0.00 [00:00,      ?obj/s]                                                                  
------------------------------ Captured log call -------------------------------
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/fb2f723c69825a42e941565cc15230adb545b3faf45b8d9ddeea7029039b2ba1' to '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/fb2f723c69825a42e941565cc15230adb545b3faf45b8d9ddeea7029039b2ba1'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir0/.Jc74sGsWrbNJmkrMMDeGDh.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir0/.Jc74sGsWrbNJmkrMMDeGDh.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir0/.dvc/cache/.YGRDfP3Nn7q9AyWfingYdP.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir0/dir/foo'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir0/dir/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
________________________ test_exists_isdir_isfile_dirty ________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0'

    def test_exists_isdir_isfile_dirty(tmp_dir, dvc):
        tmp_dir.dvc_gen({"datafile": "data", "datadir": {"foo": "foo", "bar": "bar"}})
    
        fs = DVCFileSystem(repo=dvc)
        shutil.rmtree(tmp_dir / "datadir")
        (tmp_dir / "datafile").unlink()
    
        assert fs.exists("datafile")
        assert fs.exists("datadir")
>       assert fs.exists("datadir/foo")
E       AssertionError: assert False
E        +  where False = <bound method FileSystem.exists of <dvc.fs.dvc.DVCFileSystem object at 0x14a9dfab0960>>('datadir/foo')
E        +    where <bound method FileSystem.exists of <dvc.fs.dvc.DVCFileSystem object at 0x14a9dfab0960>> = <dvc.fs.dvc.DVCFileSystem object at 0x14a9dfab0960>.exists

/home/user/dvc/tests/unit/fs/test_dvc.py:131: AssertionError
----------------------------- Captured stdout call -----------------------------
2023-05-16 00:46:22,118 DEBUG: Computed stage: 'datafile.dvc' md5: 'None'
2023-05-16 00:46:22,254 DEBUG: Preparing to transfer data from 'memory://dvc-staging/af9b47f2fe8422ea87dee781dae1302bfd927c45926564004c1ba659b0fcccc6' to '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/.dvc/cache'
2023-05-16 00:46:22,267 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/.dvc/cache'
2023-05-16 00:46:22,280 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/.dvc/cache'
2023-05-16 00:46:22,382 DEBUG: Preparing to collect status from 'memory://dvc-staging/af9b47f2fe8422ea87dee781dae1302bfd927c45926564004c1ba659b0fcccc6'
2023-05-16 00:46:22,636 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:46:22,651 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/.45EdrxKumRyU29Xxap88MD.tmp'
2023-05-16 00:46:22,691 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/.45EdrxKumRyU29Xxap88MD.tmp'
2023-05-16 00:46:22,706 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/.dvc/cache/.eexgsSe8LmmUPTXbEwy5Kd.tmp'
2023-05-16 00:46:22,725 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/datafile'
2023-05-16 00:46:22,915 DEBUG: Saving information to 'datafile.dvc'.
2023-05-16 00:46:23,516 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-16 00:46:23,532 DEBUG: Computed stage: 'datadir.dvc' md5: 'None'
2023-05-16 00:46:23,873 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-16 00:46:23,892 DEBUG: Preparing to transfer data from 'memory://dvc-staging/af9b47f2fe8422ea87dee781dae1302bfd927c45926564004c1ba659b0fcccc6' to '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/.dvc/cache'
2023-05-16 00:46:23,907 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/.dvc/cache'
2023-05-16 00:46:23,948 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/.dvc/cache'
2023-05-16 00:46:24,077 DEBUG: Preparing to collect status from 'memory://dvc-staging/af9b47f2fe8422ea87dee781dae1302bfd927c45926564004c1ba659b0fcccc6'
2023-05-16 00:46:24,826 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-16 00:46:24,876 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:46:24,890 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/.8Nq8zuXqD8nDxsox2V2LSC.tmp'
2023-05-16 00:46:24,936 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/.8Nq8zuXqD8nDxsox2V2LSC.tmp'
2023-05-16 00:46:24,950 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/.dvc/cache/.N3sThe37sAQhpBmuzYF2UX.tmp'
2023-05-16 00:46:24,970 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/datadir/foo'
2023-05-16 00:46:25,045 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/datadir/bar'
2023-05-16 00:46:25,249 DEBUG: Saving information to 'datadir.dvc'.
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  5.09file/s]Collecting targets          |2.00 [00:00,  6.45file/s]                                                      !  0% Adding...|          |0/2 [00:00<?,     ?file/s]
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
                                                                                [A 50% Adding...|█████     | datafile |1/2 [00:01<00:01,  1.09s/file]
![A
Building data objects from datadir          |0.00 [00:00,      ?obj/s][A
Building data objects from datadir          |2.00 [00:00,   19.0obj/s][A
                                                                      [A
![A
Building data objects from datadir          |0.00 [00:00,      ?obj/s][A
                                                                      [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/2 [00:00<?,     ?file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 16.10file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 16.10file/s][A

![A[A

  0%|          |memory://.fohXNV6d3MVfeEwka4CbAQ.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.fohXNV6d3MVfeEwka4CbAQ.0.00/126 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from datadir          |0.00 [00:00,      ?obj/s][A
                                                                      [A100% Adding...|██████████| datadir |2/2 [00:03<00:00,  1.83s/file] 100% Adding...|██████████|2/2 [00:03,  1.73s/file]                
------------------------------ Captured log call -------------------------------
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'datafile.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/af9b47f2fe8422ea87dee781dae1302bfd927c45926564004c1ba659b0fcccc6' to '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/af9b47f2fe8422ea87dee781dae1302bfd927c45926564004c1ba659b0fcccc6'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/.45EdrxKumRyU29Xxap88MD.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/.45EdrxKumRyU29Xxap88MD.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/.dvc/cache/.eexgsSe8LmmUPTXbEwy5Kd.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/datafile'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'datafile.dvc'.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'datadir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/af9b47f2fe8422ea87dee781dae1302bfd927c45926564004c1ba659b0fcccc6' to '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/af9b47f2fe8422ea87dee781dae1302bfd927c45926564004c1ba659b0fcccc6'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/.8Nq8zuXqD8nDxsox2V2LSC.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/.8Nq8zuXqD8nDxsox2V2LSC.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/.dvc/cache/.N3sThe37sAQhpBmuzYF2UX.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/datadir/foo'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_exists_isdir_isfile_dirty0/datadir/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'datadir.dvc'.
_______________________________ test_walk_dirty ________________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_walk_dirty0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_walk_dirty0'

    def test_walk_dirty(tmp_dir, dvc):
        tmp_dir.dvc_gen(
            {
                "dir": {
                    "foo": "foo",
                    "subdir1": {"foo1": "foo1", "bar1": "bar1"},
                    "subdir2": {"foo2": "foo2"},
                }
            }
        )
        tmp_dir.gen({"dir": {"bar": "bar", "subdir3": {"foo3": "foo3"}}})
        (tmp_dir / "dir" / "foo").unlink()
    
        fs = DVCFileSystem(repo=dvc)
        expected = [
            "dir/subdir1",
            "dir/subdir2",
            "dir/subdir3",
            "dir/subdir1/foo1",
            "dir/subdir1/bar1",
            "dir/subdir2/foo2",
            "dir/subdir3/foo3",
            "dir/bar",
            "dir/foo",
        ]
    
        actual = []
>       for root, dirs, files in fs.walk("dir"):

/home/user/dvc/tests/unit/fs/test_dvc.py:239: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:282: in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:391: in ls
    return self.fs.ls(path, detail=detail, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14a9b684b5f0>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-16 00:46:47,199 DEBUG: built tree 'object cd32b406bcdded0d46c81402e1ec024f.dir'
2023-05-16 00:46:47,214 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-16 00:46:47,635 DEBUG: built tree 'object cd32b406bcdded0d46c81402e1ec024f.dir'
2023-05-16 00:46:47,653 DEBUG: Preparing to transfer data from 'memory://dvc-staging/47ddad81cb15b41105c39960494f6ec37586e3bed3fc72472c031a7f47db4db8' to '/tmp/pytest-of-user/pytest-384/test_walk_dirty0/.dvc/cache'
2023-05-16 00:46:47,666 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_dirty0/.dvc/cache'
2023-05-16 00:46:47,709 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_dirty0/.dvc/cache'
2023-05-16 00:46:47,902 DEBUG: Preparing to collect status from 'memory://dvc-staging/47ddad81cb15b41105c39960494f6ec37586e3bed3fc72472c031a7f47db4db8'
2023-05-16 00:46:48,741 DEBUG: built tree 'object cd32b406bcdded0d46c81402e1ec024f.dir'
2023-05-16 00:46:48,801 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:46:48,814 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_dirty0/.m44jD2HmU2S8ALTtjanee9.tmp'
2023-05-16 00:46:48,860 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_dirty0/.m44jD2HmU2S8ALTtjanee9.tmp'
2023-05-16 00:46:48,875 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_dirty0/.dvc/cache/.RhaxPkVFo46dYUptsWBvHf.tmp'
2023-05-16 00:46:48,895 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_dirty0/dir/foo'
2023-05-16 00:46:48,973 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_dirty0/dir/subdir1/foo1'
2023-05-16 00:46:49,049 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_dirty0/dir/subdir2/foo2'
2023-05-16 00:46:49,129 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_dirty0/dir/subdir1/bar1'
2023-05-16 00:46:49,380 DEBUG: Saving information to 'dir.dvc'.
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  5.15file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |2.00 [00:00,   17.6obj/s][A
Building data objects from dir          |4.00 [00:00,   15.5obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |4.00 [00:00,   35.2obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
100% |██████████|5/5 [00:00<00:00, 48.10files/s][A
                                                [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/4 [00:00<?,     ?file/s][A
  0%|          |Transferring                      4/? [00:00<00:00, 22.72file/s][A
  0%|          |Transferring                      4/? [00:00<00:00, 22.72file/s][A

![A[A

  0%|          |memory://.StSvz3PdgKByLwToBMK7PX.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.StSvz3PdgKByLwToBMK7PX.0.00/279 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |4.00 [00:00,   39.7obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.92s/file]100% Adding...|██████████|1/1 [00:02,  2.95s/file]      
------------------------------ Captured log call -------------------------------
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object cd32b406bcdded0d46c81402e1ec024f.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object cd32b406bcdded0d46c81402e1ec024f.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/47ddad81cb15b41105c39960494f6ec37586e3bed3fc72472c031a7f47db4db8' to '/tmp/pytest-of-user/pytest-384/test_walk_dirty0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_dirty0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_dirty0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/47ddad81cb15b41105c39960494f6ec37586e3bed3fc72472c031a7f47db4db8'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object cd32b406bcdded0d46c81402e1ec024f.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_dirty0/.m44jD2HmU2S8ALTtjanee9.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_dirty0/.m44jD2HmU2S8ALTtjanee9.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_dirty0/.dvc/cache/.RhaxPkVFo46dYUptsWBvHf.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_dirty0/dir/foo'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_dirty0/dir/subdir1/foo1'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_dirty0/dir/subdir2/foo2'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_dirty0/dir/subdir1/bar1'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
__________________________ test_walk_dirty_cached_dir __________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_walk_dirty_cached_dir0')
scm = Git: '/tmp/pytest-of-user/pytest-384/test_walk_dirty_cached_dir0/.git'
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_walk_dirty_cached_dir0'

    def test_walk_dirty_cached_dir(tmp_dir, scm, dvc):
        tmp_dir.dvc_gen({"data": {"foo": "foo", "bar": "bar"}}, commit="add data")
        (tmp_dir / "data" / "foo").unlink()
    
        fs = DVCFileSystem(repo=dvc)
    
        actual = []
>       for root, dirs, files in fs.walk("data"):

/home/user/dvc/tests/unit/fs/test_dvc.py:254: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:282: in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:391: in ls
    return self.fs.ls(path, detail=detail, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14a98cf3ce10>
key = ('data',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-16 00:46:56,460 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_dirty_cached_dir0/data' to gitignore file.
2023-05-16 00:46:56,740 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-16 00:46:56,755 DEBUG: Computed stage: 'data.dvc' md5: 'None'
2023-05-16 00:46:57,080 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-16 00:46:57,096 DEBUG: Preparing to transfer data from 'memory://dvc-staging/c5a1779203afaf65d67aa54180eff1076dbf35b82859a15754216c9c8d252196' to '/tmp/pytest-of-user/pytest-384/test_walk_dirty_cached_dir0/.dvc/cache'
2023-05-16 00:46:57,109 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_dirty_cached_dir0/.dvc/cache'
2023-05-16 00:46:57,142 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_dirty_cached_dir0/.dvc/cache'
2023-05-16 00:46:57,280 DEBUG: Preparing to collect status from 'memory://dvc-staging/c5a1779203afaf65d67aa54180eff1076dbf35b82859a15754216c9c8d252196'
2023-05-16 00:46:58,027 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-16 00:46:58,073 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:46:58,085 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_dirty_cached_dir0/.Cs6HjhmVnB2S3reS5tUanP.tmp'
2023-05-16 00:46:58,129 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_dirty_cached_dir0/.Cs6HjhmVnB2S3reS5tUanP.tmp'
2023-05-16 00:46:58,144 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_dirty_cached_dir0/.dvc/cache/.cbBPpSqxDVQ8LFG3DCziv2.tmp'
2023-05-16 00:46:58,163 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_dirty_cached_dir0/data/foo'
2023-05-16 00:46:58,235 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_dirty_cached_dir0/data/bar'
2023-05-16 00:46:58,429 DEBUG: Saving information to 'data.dvc'.

To track the changes with git, run:

	git add .gitignore data.dvc

To enable auto staging, run:

	dvc config core.autostage true
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  4.25file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from data          |0.00 [00:00,      ?obj/s][A
                                                                   [A
![A
Building data objects from data          |0.00 [00:00,      ?obj/s][A
                                                                   [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/2 [00:00<?,     ?file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 16.37file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 16.37file/s][A

![A[A

  0%|          |memory://.8wzKdcMeBZkTA9XT484Sbw.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.8wzKdcMeBZkTA9XT484Sbw.0.00/126 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from data          |0.00 [00:00,      ?obj/s][A
                                                                   [A100% Adding...|██████████|1/1 [00:02<00:00,  2.19s/file]100% Adding...|██████████|1/1 [00:02,  2.22s/file]      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_dirty_cached_dir0/data' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'data.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/c5a1779203afaf65d67aa54180eff1076dbf35b82859a15754216c9c8d252196' to '/tmp/pytest-of-user/pytest-384/test_walk_dirty_cached_dir0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_dirty_cached_dir0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_dirty_cached_dir0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/c5a1779203afaf65d67aa54180eff1076dbf35b82859a15754216c9c8d252196'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_dirty_cached_dir0/.Cs6HjhmVnB2S3reS5tUanP.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_dirty_cached_dir0/.Cs6HjhmVnB2S3reS5tUanP.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_dirty_cached_dir0/.dvc/cache/.cbBPpSqxDVQ8LFG3DCziv2.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_dirty_cached_dir0/data/foo'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_dirty_cached_dir0/data/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'data.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore data.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
__________________________________ test_isdvc __________________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_isdvc1')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_isdvc1'

    def test_isdvc(tmp_dir, dvc):
        tmp_dir.gen({"foo": "foo", "bar": "bar", "dir": {"baz": "baz"}})
        dvc.add("foo")
        dvc.add("dir")
        fs = DVCFileSystem(repo=dvc)
        assert fs.isdvc("foo")
        assert not fs.isdvc("bar")
        assert fs.isdvc("dir")
>       assert fs.isdvc("dir/baz")

/home/user/dvc/tests/unit/fs/test_dvc.py:314: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/dvc/dvc/fs/dvc.py:404: in isdvc
    return self.fs.isdvc(path, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:269: in isdvc
    return dvc_fs is not None and dvc_fs.isdvc(dvc_path, **kwargs)
/home/user/dvc/dvc/fs/data.py:33: in isdvc
    return self.fs.isdvc(path, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:109: in isdvc
    info = self.info(path)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:121: in info
    info = self.index.info(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:413: in info
    entry = self[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:464: in __getitem__
    self._load(dir_key, dir_entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14a9c71eec80>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-16 00:47:21,309 DEBUG: Computed stage: 'foo.dvc' md5: 'None'
2023-05-16 00:47:21,423 DEBUG: Preparing to transfer data from 'memory://dvc-staging/4913f75efead48d8cddc29c82e9b8833b6b2cd497ffadbd2d236f4c932792e7f' to '/tmp/pytest-of-user/pytest-384/test_isdvc1/.dvc/cache'
2023-05-16 00:47:21,435 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_isdvc1/.dvc/cache'
2023-05-16 00:47:21,447 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_isdvc1/.dvc/cache'
2023-05-16 00:47:21,550 DEBUG: Preparing to collect status from 'memory://dvc-staging/4913f75efead48d8cddc29c82e9b8833b6b2cd497ffadbd2d236f4c932792e7f'
2023-05-16 00:47:21,805 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:47:21,847 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_isdvc1/.eYgE72omBMmqdEfFMAPdvc.tmp'
2023-05-16 00:47:21,890 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_isdvc1/.eYgE72omBMmqdEfFMAPdvc.tmp'
2023-05-16 00:47:21,904 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_isdvc1/.dvc/cache/.BjZgDe8hbmz3Px8AR8RsFL.tmp'
2023-05-16 00:47:21,924 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_isdvc1/foo'
2023-05-16 00:47:22,091 DEBUG: Saving information to 'foo.dvc'.
2023-05-16 00:47:23,284 DEBUG: built tree 'object 630bd47b538d2a513c7d267d07e0bc44.dir'
2023-05-16 00:47:23,299 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-16 00:47:23,616 DEBUG: built tree 'object 630bd47b538d2a513c7d267d07e0bc44.dir'
2023-05-16 00:47:23,634 DEBUG: Preparing to transfer data from 'memory://dvc-staging/4913f75efead48d8cddc29c82e9b8833b6b2cd497ffadbd2d236f4c932792e7f' to '/tmp/pytest-of-user/pytest-384/test_isdvc1/.dvc/cache'
2023-05-16 00:47:23,645 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_isdvc1/.dvc/cache'
2023-05-16 00:47:23,675 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_isdvc1/.dvc/cache'
2023-05-16 00:47:23,799 DEBUG: Preparing to collect status from 'memory://dvc-staging/4913f75efead48d8cddc29c82e9b8833b6b2cd497ffadbd2d236f4c932792e7f'
2023-05-16 00:47:24,507 DEBUG: built tree 'object 630bd47b538d2a513c7d267d07e0bc44.dir'
2023-05-16 00:47:24,546 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:47:24,560 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_isdvc1/.iZ8nKpfDGucPbxfhD6QFAc.tmp'
2023-05-16 00:47:24,607 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_isdvc1/.iZ8nKpfDGucPbxfhD6QFAc.tmp'
2023-05-16 00:47:24,621 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_isdvc1/.dvc/cache/.PQqghSCBHC3Yk5kNiH4r9y.tmp'
2023-05-16 00:47:24,642 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_isdvc1/dir/baz'
2023-05-16 00:47:24,831 DEBUG: Saving information to 'dir.dvc'.
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  6.00file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
                                                                                [A100% Adding...|██████████|1/1 [00:01<00:00,  1.06s/file]100% Adding...|██████████|1/1 [00:01,  1.09s/file]      
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  4.91file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.64file/s][A

![A[A

  0%|          |memory://.MYFwmDZ2RpNuHrJ3DNVLLL.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.MYFwmDZ2RpNuHrJ3DNVLLL0.00/63.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  6.67file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.05s/file]100% Adding...|██████████|1/1 [00:02,  2.08s/file]      
------------------------------ Captured log call -------------------------------
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'foo.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/4913f75efead48d8cddc29c82e9b8833b6b2cd497ffadbd2d236f4c932792e7f' to '/tmp/pytest-of-user/pytest-384/test_isdvc1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_isdvc1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_isdvc1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/4913f75efead48d8cddc29c82e9b8833b6b2cd497ffadbd2d236f4c932792e7f'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_isdvc1/.eYgE72omBMmqdEfFMAPdvc.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_isdvc1/.eYgE72omBMmqdEfFMAPdvc.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_isdvc1/.dvc/cache/.BjZgDe8hbmz3Px8AR8RsFL.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_isdvc1/foo'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'foo.dvc'.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 630bd47b538d2a513c7d267d07e0bc44.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 630bd47b538d2a513c7d267d07e0bc44.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/4913f75efead48d8cddc29c82e9b8833b6b2cd497ffadbd2d236f4c932792e7f' to '/tmp/pytest-of-user/pytest-384/test_isdvc1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_isdvc1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_isdvc1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/4913f75efead48d8cddc29c82e9b8833b6b2cd497ffadbd2d236f4c932792e7f'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 630bd47b538d2a513c7d267d07e0bc44.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_isdvc1/.iZ8nKpfDGucPbxfhD6QFAc.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_isdvc1/.iZ8nKpfDGucPbxfhD6QFAc.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_isdvc1/.dvc/cache/.PQqghSCBHC3Yk5kNiH4r9y.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_isdvc1/dir/baz'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
________________________________ test_subrepos _________________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_subrepos0')
scm = Git: '/tmp/pytest-of-user/pytest-384/test_subrepos0/.git'
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_subrepos0'
mocker = <pytest_mock.plugin.MockerFixture object at 0x14a988fc7140>

    def test_subrepos(tmp_dir, scm, dvc, mocker):
        tmp_dir.scm_gen(
            {"dir": {"repo.txt": "file to confuse DVCFileSystem"}},
            commit="dir/repo.txt",
        )
    
        subrepo1 = tmp_dir / "dir" / "repo"
        subrepo2 = tmp_dir / "dir" / "repo2"
    
        for repo in [subrepo1, subrepo2]:
            make_subrepo(repo, scm)
    
        with subrepo1.chdir():
            subrepo1.dvc_gen({"foo": "foo", "dir1": {"bar": "bar"}}, commit="FOO")
        with subrepo2.chdir():
            subrepo2.dvc_gen({"lorem": "lorem", "dir2": {"ipsum": "ipsum"}}, commit="BAR")
    
        dvc._reset()
        fs = DVCFileSystem(repo=dvc, subrepos=True)
    
        def assert_fs_belongs_to_repo(ret_val):
            method = fs.fs._get_repo
    
            def f(*args, **kwargs):
                r = method(*args, **kwargs)
                assert r.root_dir == ret_val.root_dir
                return r
    
            return f
    
        with mock.patch.object(
            fs.fs, "_get_repo", side_effect=assert_fs_belongs_to_repo(subrepo1.dvc)
        ):
            assert fs.exists("dir/repo/foo") is True
            assert fs.exists("dir/repo/bar") is False
    
            assert fs.isfile("dir/repo/foo") is True
>           assert fs.isfile("dir/repo/dir1/bar") is True
E           AssertionError: assert False is True
E            +  where False = <bound method FileSystem.isfile of <dvc.fs.dvc.DVCFileSystem object at 0x14a989534cd0>>('dir/repo/dir1/bar')
E            +    where <bound method FileSystem.isfile of <dvc.fs.dvc.DVCFileSystem object at 0x14a989534cd0>> = <dvc.fs.dvc.DVCFileSystem object at 0x14a989534cd0>.isfile

/home/user/dvc/tests/unit/fs/test_dvc.py:355: AssertionError
----------------------------- Captured stdout call -----------------------------
2023-05-16 00:47:35,214 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/config.local' to gitignore file.
2023-05-16 00:47:35,239 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/tmp' to gitignore file.
2023-05-16 00:47:35,262 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/cache' to gitignore file.
2023-05-16 00:47:35,300 DEBUG: Removing '/var/tmp/dvc/repo/6ce4aa4aa702ce35263ceddfae95a3e0'
2023-05-16 00:47:36,011 DEBUG: Staging files: {'/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvcignore', '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/.gitignore', '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/config'}
Initialized DVC repository.

You can now commit the changes to git.

2023-05-16 00:47:40,891 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/config.local' to gitignore file.
2023-05-16 00:47:40,921 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/tmp' to gitignore file.
2023-05-16 00:47:40,949 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/cache' to gitignore file.
2023-05-16 00:47:40,987 DEBUG: Removing '/var/tmp/dvc/repo/b0783daf44cc944be91092282a3f3df0'
2023-05-16 00:47:41,691 DEBUG: Staging files: {'/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/.gitignore', '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvcignore', '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/config'}
Initialized DVC repository.

You can now commit the changes to git.

2023-05-16 00:47:46,245 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/foo' to gitignore file.
2023-05-16 00:47:46,362 DEBUG: Computed stage: 'foo.dvc' md5: 'None'
2023-05-16 00:47:46,500 DEBUG: Preparing to transfer data from 'memory://dvc-staging/0aadce86f571e78bfc4faf33fa75138779162a6631e2be547c2ca140a6f6c0bb' to '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/cache'
2023-05-16 00:47:46,512 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/cache'
2023-05-16 00:47:46,525 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/cache'
2023-05-16 00:47:46,628 DEBUG: Preparing to collect status from 'memory://dvc-staging/0aadce86f571e78bfc4faf33fa75138779162a6631e2be547c2ca140a6f6c0bb'
2023-05-16 00:47:46,867 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:47:46,881 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.afppNp5XNr53AsWCNPFHbq.tmp'
2023-05-16 00:47:46,920 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.afppNp5XNr53AsWCNPFHbq.tmp'
2023-05-16 00:47:46,935 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/cache/.V3SePGjTYZPK4Zw3ZBX4vr.tmp'
2023-05-16 00:47:46,955 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/foo'
2023-05-16 00:47:47,128 DEBUG: Saving information to 'foo.dvc'.
2023-05-16 00:47:47,356 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/dir1' to gitignore file.
2023-05-16 00:47:47,635 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-16 00:47:47,650 DEBUG: Computed stage: 'dir1.dvc' md5: 'None'
2023-05-16 00:47:47,991 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-16 00:47:48,010 DEBUG: Preparing to transfer data from 'memory://dvc-staging/0aadce86f571e78bfc4faf33fa75138779162a6631e2be547c2ca140a6f6c0bb' to '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/cache'
2023-05-16 00:47:48,023 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/cache'
2023-05-16 00:47:48,056 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/cache'
2023-05-16 00:47:48,193 DEBUG: Preparing to collect status from 'memory://dvc-staging/0aadce86f571e78bfc4faf33fa75138779162a6631e2be547c2ca140a6f6c0bb'
2023-05-16 00:47:48,824 DEBUG: built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
2023-05-16 00:47:48,867 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:47:48,880 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.iWk2zStp4UryNgfyrDgbo6.tmp'
2023-05-16 00:47:48,923 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.iWk2zStp4UryNgfyrDgbo6.tmp'
2023-05-16 00:47:48,938 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/cache/.5F2xfwwdF3wL84XViTUN3J.tmp'
2023-05-16 00:47:48,959 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/dir1/bar'
2023-05-16 00:47:49,153 DEBUG: Saving information to 'dir1.dvc'.

To track the changes with git, run:

	git add .gitignore foo.dvc dir1.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-16 00:47:54,508 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/lorem' to gitignore file.
2023-05-16 00:47:54,700 DEBUG: Computed stage: 'lorem.dvc' md5: 'None'
2023-05-16 00:47:54,934 DEBUG: Preparing to transfer data from 'memory://dvc-staging/bc2c4568883dc610b26653f754120be42a81f964fd374f6ab530cd0374491af0' to '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/cache'
2023-05-16 00:47:54,958 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/cache'
2023-05-16 00:47:54,980 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/cache'
2023-05-16 00:47:55,154 DEBUG: Preparing to collect status from 'memory://dvc-staging/bc2c4568883dc610b26653f754120be42a81f964fd374f6ab530cd0374491af0'
2023-05-16 00:47:55,660 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:47:55,684 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.a9QmLmSkYQGVwREPpRTV6g.tmp'
2023-05-16 00:47:55,760 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.a9QmLmSkYQGVwREPpRTV6g.tmp'
2023-05-16 00:47:55,786 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/cache/.bTMdNmnVvrhJnynWZ524D5.tmp'
2023-05-16 00:47:55,821 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/lorem'
2023-05-16 00:47:56,112 DEBUG: Saving information to 'lorem.dvc'.
2023-05-16 00:47:56,520 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/dir2' to gitignore file.
2023-05-16 00:47:56,983 DEBUG: built tree 'object d38df0450c6e8aee3989e9d22eb2cacc.dir'
2023-05-16 00:47:57,011 DEBUG: Computed stage: 'dir2.dvc' md5: 'None'
2023-05-16 00:47:57,536 DEBUG: built tree 'object d38df0450c6e8aee3989e9d22eb2cacc.dir'
2023-05-16 00:47:57,575 DEBUG: Preparing to transfer data from 'memory://dvc-staging/bc2c4568883dc610b26653f754120be42a81f964fd374f6ab530cd0374491af0' to '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/cache'
2023-05-16 00:47:57,598 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/cache'
2023-05-16 00:47:57,654 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/cache'
2023-05-16 00:47:57,864 DEBUG: Preparing to collect status from 'memory://dvc-staging/bc2c4568883dc610b26653f754120be42a81f964fd374f6ab530cd0374491af0'
2023-05-16 00:47:58,972 DEBUG: built tree 'object d38df0450c6e8aee3989e9d22eb2cacc.dir'
2023-05-16 00:47:59,011 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:47:59,024 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.RhiWQGvRztyWSBwGtVyJ5n.tmp'
2023-05-16 00:47:59,067 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.RhiWQGvRztyWSBwGtVyJ5n.tmp'
2023-05-16 00:47:59,082 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/cache/.6yTqes7owLT5TGA7QbYN2w.tmp'
2023-05-16 00:47:59,106 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/dir2/ipsum'
2023-05-16 00:47:59,308 DEBUG: Saving information to 'dir2.dvc'.

To track the changes with git, run:

	git add .gitignore dir2.dvc lorem.dvc

To enable auto staging, run:

	dvc config core.autostage true
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.45file/s]Collecting targets          |2.00 [00:00,  4.96file/s]                                                      !  0% Adding...|          |0/2 [00:00<?,     ?file/s]
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
                                                                                [A 50% Adding...|█████     | foo |1/2 [00:01<00:01,  1.10s/file]
![A
Building data objects from dir1          |0.00 [00:00,      ?obj/s][A
                                                                   [A
![A
Building data objects from dir1          |0.00 [00:00,      ?obj/s][A
                                                                   [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00, 10.70file/s][A

![A[A

  0%|          |memory://.MeJzjTLoCRuyPonfpEVyti.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.MeJzjTLoCRuyPonfpEVyti0.00/63.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  8.49file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir1          |0.00 [00:00,      ?obj/s][A
                                                                   [A100% Adding...|██████████| dir1 |2/2 [00:03<00:00,  1.65s/file]100% Adding...|██████████|2/2 [00:03,  1.58s/file]             
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  2.19file/s]Collecting targets          |2.00 [00:00,  2.99file/s]                                                      !  0% Adding...|          |0/2 [00:00<?,     ?file/s]
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  6.38file/s][A
                                                                                [A 50% Adding...|█████     | lorem |1/2 [00:01<00:01,  1.99s/file]
![A
Building data objects from dir2          |0.00 [00:00,      ?obj/s][A
                                                                   [A
![A
Building data objects from dir2          |0.00 [00:00,      ?obj/s][A
                                                                   [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  8.49file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  8.49file/s][A

![A[A

  0%|          |memory://.NEXj9LKLEJsVnBUH5ts8cc.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.NEXj9LKLEJsVnBUH5ts8cc0.00/65.0 [00:00<?,        ?B/s][A[A

100%|██████████|memory://.NEXj9LKLEJsVnBUH5t65.0/65.0 [00:00<00:00,      597B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  3.21file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir2          |0.00 [00:00,      ?obj/s][A
                                                                   [A100% Adding...|██████████| dir2 |2/2 [00:05<00:00,  2.65s/file] 100% Adding...|██████████|2/2 [00:05,  2.57s/file]             
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/config.local' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/tmp' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/cache' to gitignore file.
DEBUG    dvc.utils.fs:fs.py:63 Removing '/var/tmp/dvc/repo/6ce4aa4aa702ce35263ceddfae95a3e0'
DEBUG    dvc.repo.scm_context:scm_context.py:68 Staging files: {'/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvcignore', '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/.gitignore', '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/config'}
INFO     dvc.repo.init:init.py:93 Initialized DVC repository.

INFO     dvc.repo.init:init.py:95 You can now commit the changes to git.

DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/config.local' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/tmp' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/cache' to gitignore file.
DEBUG    dvc.utils.fs:fs.py:63 Removing '/var/tmp/dvc/repo/b0783daf44cc944be91092282a3f3df0'
DEBUG    dvc.repo.scm_context:scm_context.py:68 Staging files: {'/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/.gitignore', '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvcignore', '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/config'}
INFO     dvc.repo.init:init.py:93 Initialized DVC repository.

INFO     dvc.repo.init:init.py:95 You can now commit the changes to git.

DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/foo' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'foo.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/0aadce86f571e78bfc4faf33fa75138779162a6631e2be547c2ca140a6f6c0bb' to '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/0aadce86f571e78bfc4faf33fa75138779162a6631e2be547c2ca140a6f6c0bb'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.afppNp5XNr53AsWCNPFHbq.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.afppNp5XNr53AsWCNPFHbq.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/cache/.V3SePGjTYZPK4Zw3ZBX4vr.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/foo'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'foo.dvc'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/dir1' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir1.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/0aadce86f571e78bfc4faf33fa75138779162a6631e2be547c2ca140a6f6c0bb' to '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/0aadce86f571e78bfc4faf33fa75138779162a6631e2be547c2ca140a6f6c0bb'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 91aaa9bb58b657d623ef143b195a67e4.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.iWk2zStp4UryNgfyrDgbo6.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.iWk2zStp4UryNgfyrDgbo6.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/.dvc/cache/.5F2xfwwdF3wL84XViTUN3J.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo/dir1/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir1.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore foo.dvc dir1.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/lorem' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'lorem.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/bc2c4568883dc610b26653f754120be42a81f964fd374f6ab530cd0374491af0' to '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/bc2c4568883dc610b26653f754120be42a81f964fd374f6ab530cd0374491af0'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.a9QmLmSkYQGVwREPpRTV6g.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.a9QmLmSkYQGVwREPpRTV6g.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/cache/.bTMdNmnVvrhJnynWZ524D5.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/lorem'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'lorem.dvc'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/dir2' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object d38df0450c6e8aee3989e9d22eb2cacc.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir2.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object d38df0450c6e8aee3989e9d22eb2cacc.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/bc2c4568883dc610b26653f754120be42a81f964fd374f6ab530cd0374491af0' to '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/bc2c4568883dc610b26653f754120be42a81f964fd374f6ab530cd0374491af0'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object d38df0450c6e8aee3989e9d22eb2cacc.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.RhiWQGvRztyWSBwGtVyJ5n.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.RhiWQGvRztyWSBwGtVyJ5n.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/.dvc/cache/.6yTqes7owLT5TGA7QbYN2w.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_subrepos0/dir/repo2/dir2/ipsum'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir2.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dir2.dvc lorem.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
___________________________ test_get_hash_cached_dir ___________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_get_hash_cached_dir0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_dir0'
mocker = <pytest_mock.plugin.MockerFixture object at 0x14a98d53f8c0>

    def test_get_hash_cached_dir(tmp_dir, dvc, mocker):
        tmp_dir.dvc_gen({"dir": {"foo": "foo", "bar": "bar", "subdir": {"data": "data"}}})
        fs = DVCFileSystem(repo=dvc)
        expected = "8761c4e9acad696bee718615e23e22db.dir"
        assert fs.info("dir").get("md5") is None
>       _, _, obj = build(dvc.cache.local, "dir", fs, "md5")

/home/user/dvc/tests/unit/fs/test_dvc.py:504: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:244: in build
    meta, obj = _build_tree(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:126: in _build_tree
    for root, _, fnames in walk_iter:
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:282: in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:391: in ls
    return self.fs.ls(path, detail=detail, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14a9d02cc4b0>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-16 00:49:47,743 DEBUG: built tree 'object 8761c4e9acad696bee718615e23e22db.dir'
2023-05-16 00:49:47,754 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-16 00:49:48,089 DEBUG: built tree 'object 8761c4e9acad696bee718615e23e22db.dir'
2023-05-16 00:49:48,106 DEBUG: Preparing to transfer data from 'memory://dvc-staging/9526f5ebca25f880e14bf9b4f1cb007d53b70fa6c1cd41eccfb9956257dace42' to '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_dir0/.dvc/cache'
2023-05-16 00:49:48,117 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_dir0/.dvc/cache'
2023-05-16 00:49:48,151 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_dir0/.dvc/cache'
2023-05-16 00:49:48,298 DEBUG: Preparing to collect status from 'memory://dvc-staging/9526f5ebca25f880e14bf9b4f1cb007d53b70fa6c1cd41eccfb9956257dace42'
2023-05-16 00:49:49,143 DEBUG: built tree 'object 8761c4e9acad696bee718615e23e22db.dir'
2023-05-16 00:49:49,197 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:49:49,211 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_dir0/.CWeDMETw6MptDSmnhr8ZJp.tmp'
2023-05-16 00:49:49,258 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_dir0/.CWeDMETw6MptDSmnhr8ZJp.tmp'
2023-05-16 00:49:49,273 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_dir0/.dvc/cache/.QkK5uWXxX9FGhXixwNgsYu.tmp'
2023-05-16 00:49:49,294 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_dir0/dir/foo'
2023-05-16 00:49:49,369 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_dir0/dir/bar'
2023-05-16 00:49:49,446 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_dir0/dir/subdir/data'
2023-05-16 00:49:49,681 DEBUG: Saving information to 'dir.dvc'.
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  5.12file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |2.00 [00:00,   17.8obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/3 [00:00<?,     ?file/s][A
  0%|          |Transferring                      3/? [00:00<00:00, 19.78file/s][A
  0%|          |Transferring                      3/? [00:00<00:00, 19.78file/s][A

![A[A

  0%|          |memory://.9YHGAtMkEyAgJboFGa5uWj.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.9YHGAtMkEyAgJboFGa5uWj.0.00/197 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.61s/file]100% Adding...|██████████|1/1 [00:02,  2.64s/file]      
!Building data objects from dir          |0.00 [00:00,      ?obj/s]                                                                  
------------------------------ Captured log call -------------------------------
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 8761c4e9acad696bee718615e23e22db.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 8761c4e9acad696bee718615e23e22db.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/9526f5ebca25f880e14bf9b4f1cb007d53b70fa6c1cd41eccfb9956257dace42' to '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_dir0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_dir0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_dir0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/9526f5ebca25f880e14bf9b4f1cb007d53b70fa6c1cd41eccfb9956257dace42'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 8761c4e9acad696bee718615e23e22db.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_dir0/.CWeDMETw6MptDSmnhr8ZJp.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_dir0/.CWeDMETw6MptDSmnhr8ZJp.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_dir0/.dvc/cache/.QkK5uWXxX9FGhXixwNgsYu.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_dir0/dir/foo'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_dir0/dir/bar'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_dir0/dir/subdir/data'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
________________________ test_get_hash_cached_granular _________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_get_hash_cached_granular0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_granular0'
mocker = <pytest_mock.plugin.MockerFixture object at 0x14a98de3de60>

    def test_get_hash_cached_granular(tmp_dir, dvc, mocker):
        tmp_dir.dvc_gen({"dir": {"foo": "foo", "bar": "bar", "subdir": {"data": "data"}}})
        fs = DVCFileSystem(repo=dvc)
        subdir = "dir/subdir"
>       assert fs.info(subdir).get("md5") is None

/home/user/dvc/tests/unit/fs/test_dvc.py:517: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:467: in info
    return self.fs.info(path, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:330: in info
    return self._info(key, path, ignore_subrepos=ignore_subrepos)
/home/user/dvc/dvc/fs/dvc.py:340: in _info
    dvc_info = dvc_fs.fs.index.info(subkey)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:413: in info
    entry = self[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:464: in __getitem__
    self._load(dir_key, dir_entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14aa860bc820>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-16 00:49:58,837 DEBUG: built tree 'object 8761c4e9acad696bee718615e23e22db.dir'
2023-05-16 00:49:58,852 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-16 00:49:59,205 DEBUG: built tree 'object 8761c4e9acad696bee718615e23e22db.dir'
2023-05-16 00:49:59,223 DEBUG: Preparing to transfer data from 'memory://dvc-staging/6c6240281112d29436896e7b3f90f64c4e09eb825a47f8b9f88d0dce667358b5' to '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_granular0/.dvc/cache'
2023-05-16 00:49:59,235 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_granular0/.dvc/cache'
2023-05-16 00:49:59,271 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_granular0/.dvc/cache'
2023-05-16 00:49:59,420 DEBUG: Preparing to collect status from 'memory://dvc-staging/6c6240281112d29436896e7b3f90f64c4e09eb825a47f8b9f88d0dce667358b5'
2023-05-16 00:50:00,217 DEBUG: built tree 'object 8761c4e9acad696bee718615e23e22db.dir'
2023-05-16 00:50:00,271 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:50:00,284 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_granular0/.XCVmJ8wo3qdQ9a39eSNmwu.tmp'
2023-05-16 00:50:00,327 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_granular0/.XCVmJ8wo3qdQ9a39eSNmwu.tmp'
2023-05-16 00:50:00,341 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_granular0/.dvc/cache/.P4koFRgRgBA7mH6Fe9x759.tmp'
2023-05-16 00:50:00,361 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_granular0/dir/foo'
2023-05-16 00:50:00,432 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_granular0/dir/bar'
2023-05-16 00:50:00,503 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_granular0/dir/subdir/data'
2023-05-16 00:50:00,718 DEBUG: Saving information to 'dir.dvc'.
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  5.13file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
Building data objects from dir          |2.00 [00:00,   15.5obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/3 [00:00<?,     ?file/s][A
  0%|          |Transferring                      3/? [00:00<00:00, 20.53file/s][A
  0%|          |Transferring                      3/? [00:00<00:00, 20.53file/s][A

![A[A

  0%|          |memory://.LT8Ejt2QY6owyVsWw4bZZp.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.LT8Ejt2QY6owyVsWw4bZZp.0.00/197 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:02<00:00,  2.54s/file]100% Adding...|██████████|1/1 [00:02,  2.57s/file]      
------------------------------ Captured log call -------------------------------
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 8761c4e9acad696bee718615e23e22db.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 8761c4e9acad696bee718615e23e22db.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/6c6240281112d29436896e7b3f90f64c4e09eb825a47f8b9f88d0dce667358b5' to '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_granular0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_granular0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_granular0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/6c6240281112d29436896e7b3f90f64c4e09eb825a47f8b9f88d0dce667358b5'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 8761c4e9acad696bee718615e23e22db.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_granular0/.XCVmJ8wo3qdQ9a39eSNmwu.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_granular0/.XCVmJ8wo3qdQ9a39eSNmwu.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_granular0/.dvc/cache/.P4koFRgRgBA7mH6Fe9x759.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_granular0/dir/foo'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_granular0/dir/bar'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_cached_granular0/dir/subdir/data'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
___________________________ test_get_hash_dirty_dir ____________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir1')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir1'

    def test_get_hash_dirty_dir(tmp_dir, dvc):
        tmp_dir.dvc_gen({"dir": {"foo": "foo", "bar": "bar"}})
        (tmp_dir / "dir" / "baz").write_text("baz")
    
        fs = DVCFileSystem(repo=dvc)
>       _, meta, obj = build(dvc.cache.local, "dir", fs, "md5")

/home/user/dvc/tests/unit/fs/test_dvc.py:582: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:244: in build
    meta, obj = _build_tree(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/hashfile/build.py:126: in _build_tree
    for root, _, fnames in walk_iter:
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:282: in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:391: in ls
    return self.fs.ls(path, detail=detail, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14a9a8774fa0>
key = ('dir',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-16 00:50:18,479 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-16 00:50:18,488 DEBUG: Computed stage: 'dir.dvc' md5: 'None'
2023-05-16 00:50:18,818 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-16 00:50:18,835 DEBUG: Preparing to transfer data from 'memory://dvc-staging/24e39368870bbb57e83b052f2de5ca86d95c8412b49829a3b39afa3b2b0ba85f' to '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir1/.dvc/cache'
2023-05-16 00:50:18,847 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir1/.dvc/cache'
2023-05-16 00:50:18,876 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir1/.dvc/cache'
2023-05-16 00:50:18,992 DEBUG: Preparing to collect status from 'memory://dvc-staging/24e39368870bbb57e83b052f2de5ca86d95c8412b49829a3b39afa3b2b0ba85f'
2023-05-16 00:50:19,582 DEBUG: built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
2023-05-16 00:50:19,630 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:50:19,643 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir1/.a6Ay9JkvUQk8YhcL86CEcN.tmp'
2023-05-16 00:50:19,684 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir1/.a6Ay9JkvUQk8YhcL86CEcN.tmp'
2023-05-16 00:50:19,699 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir1/.dvc/cache/.hqAwZHJWeQaGVCwzxZKJSV.tmp'
2023-05-16 00:50:19,719 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir1/dir/foo'
2023-05-16 00:50:19,791 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir1/dir/bar'
2023-05-16 00:50:19,985 DEBUG: Saving information to 'dir.dvc'.
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  7.48file/s]                                                      !  0% Adding...|          |0/1 [00:00<?,     ?file/s]Adding...                                           
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/2 [00:00<?,     ?file/s][A
  0%|          |Transferring                      2/? [00:00<00:00, 20.55file/s][A

![A[A

  0%|          |memory://.DbQBehLQGtULt4ckookMRA.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.DbQBehLQGtULt4ckookMRA.0.00/126 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      3/? [00:00<00:00, 13.73file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dir          |0.00 [00:00,      ?obj/s][A
                                                                  [A100% Adding...|██████████|1/1 [00:01<00:00,  1.95s/file]100% Adding...|██████████|1/1 [00:01,  1.99s/file]      
!Building data objects from dir          |0.00 [00:00,      ?obj/s]                                                                  
------------------------------ Captured log call -------------------------------
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dir.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/24e39368870bbb57e83b052f2de5ca86d95c8412b49829a3b39afa3b2b0ba85f' to '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/24e39368870bbb57e83b052f2de5ca86d95c8412b49829a3b39afa3b2b0ba85f'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 5ea40360f5b4ec688df672a4db9c17d1.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir1/.a6Ay9JkvUQk8YhcL86CEcN.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir1/.a6Ay9JkvUQk8YhcL86CEcN.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir1/.dvc/cache/.hqAwZHJWeQaGVCwzxZKJSV.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir1/dir/foo'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_get_hash_dirty_dir1/dir/bar'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dir.dvc'.
_______________________ test_walk_nested_subrepos[True] ________________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0'
scm = Git: '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/.git'
traverse_subrepos = True

    @pytest.mark.parametrize("traverse_subrepos", [True, False])
    def test_walk_nested_subrepos(tmp_dir, dvc, scm, traverse_subrepos):
        # generate a dvc and fs structure, with suffix based on repo's basename
        def fs_structure(suffix):
            return {
                f"foo-{suffix}": f"foo-{suffix}",
                f"dir-{suffix}": {f"bar-{suffix}": f"bar-{suffix}"},
            }
    
        def dvc_structure(suffix):
            return {
                f"lorem-{suffix}": f"lorem-{suffix}",
                f"dvc-{suffix}": {f"ipsum-{suffix}": f"ipsum-{suffix}"},
            }
    
        paths = ["subrepo1", "subrepo2", os.path.join("subrepo1", "subrepo3")]
        subrepos = [tmp_dir / path for path in paths]
        for repo_dir in subrepos:
            make_subrepo(repo_dir, scm)
    
        extras = {".gitignore"}  # these files are always there
        expected = {}
        for repo_dir in [*subrepos, tmp_dir]:
            base = os.path.basename(repo_dir)
            scm_files = fs_structure(base)
            dvc_files = dvc_structure(base)
            with repo_dir.chdir():
                repo_dir.scm_gen(scm_files, commit=f"git add in {repo_dir}")
                repo_dir.dvc_gen(dvc_files, commit=f"dvc add in {repo_dir}")
    
            if traverse_subrepos or repo_dir == tmp_dir:
                repo_dir_path = (
                    "/" + repo_dir.relative_to(tmp_dir).as_posix()
                    if repo_dir != tmp_dir
                    else "/"
                )
                expected[repo_dir_path] = set(scm_files.keys() | dvc_files.keys() | extras)
                # files inside a dvc directory
                expected[posixpath.join(repo_dir_path, f"dvc-{base}")] = {f"ipsum-{base}"}
                # files inside a git directory
                expected[posixpath.join(repo_dir_path, f"dir-{base}")] = {f"bar-{base}"}
    
        if traverse_subrepos:
            # update subrepos
            expected["/"].update(["subrepo1", "subrepo2"])
            expected["/subrepo1"].add("subrepo3")
    
        actual = {}
        fs = DVCFileSystem(repo=dvc)
>       for root, dirs, files in fs.walk("/", ignore_subrepos=not traverse_subrepos):

/home/user/dvc/tests/unit/fs/test_dvc.py:636: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:428: in walk
    yield from self.walk(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:282: in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:391: in ls
    return self.fs.ls(path, detail=detail, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ad03ba8b90>
key = ('dvc-test_walk_nested_subrepos_True0',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-16 00:50:27,378 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/config.local' to gitignore file.
2023-05-16 00:50:27,403 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/tmp' to gitignore file.
2023-05-16 00:50:27,425 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/cache' to gitignore file.
2023-05-16 00:50:27,464 DEBUG: Removing '/var/tmp/dvc/repo/c4dcc2082fa0e198fdac91c678e125bd'
2023-05-16 00:50:28,124 DEBUG: Staging files: {'/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/.gitignore', '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvcignore', '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/config'}
Initialized DVC repository.

You can now commit the changes to git.

2023-05-16 00:50:32,548 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/config.local' to gitignore file.
2023-05-16 00:50:32,572 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/tmp' to gitignore file.
2023-05-16 00:50:32,595 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/cache' to gitignore file.
2023-05-16 00:50:32,631 DEBUG: Removing '/var/tmp/dvc/repo/99bc502ae28fd74378d245be71414d73'
2023-05-16 00:50:33,308 DEBUG: Staging files: {'/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvcignore', '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/.gitignore', '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/config'}
Initialized DVC repository.

You can now commit the changes to git.

2023-05-16 00:50:38,315 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/config.local' to gitignore file.
2023-05-16 00:50:38,340 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/tmp' to gitignore file.
2023-05-16 00:50:38,362 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/cache' to gitignore file.
2023-05-16 00:50:38,403 DEBUG: Removing '/var/tmp/dvc/repo/1c9e964c25d04f38f830d84607849467'
2023-05-16 00:50:39,114 DEBUG: Staging files: {'/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/config', '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvcignore', '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/.gitignore'}
Initialized DVC repository.

You can now commit the changes to git.

2023-05-16 00:50:48,088 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/lorem-subrepo1' to gitignore file.
2023-05-16 00:50:48,276 DEBUG: Computed stage: 'lorem-subrepo1.dvc' md5: 'None'
2023-05-16 00:50:48,509 DEBUG: Preparing to transfer data from 'memory://dvc-staging/48bf850b3b4a41ff4772ff49fb18e644ef42297b1782e4e6d727b6927a792f31' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/cache'
2023-05-16 00:50:48,531 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/cache'
2023-05-16 00:50:48,554 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/cache'
2023-05-16 00:50:48,724 DEBUG: Preparing to collect status from 'memory://dvc-staging/48bf850b3b4a41ff4772ff49fb18e644ef42297b1782e4e6d727b6927a792f31'
2023-05-16 00:50:49,229 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:50:49,251 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.m6NkK8zCt3qoJvKXBfaNip.tmp'
2023-05-16 00:50:49,327 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.m6NkK8zCt3qoJvKXBfaNip.tmp'
2023-05-16 00:50:49,351 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/cache/.Ucsh5Ufj5zNMnpJ6tDfNqM.tmp'
2023-05-16 00:50:49,386 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/lorem-subrepo1'
2023-05-16 00:50:49,671 DEBUG: Saving information to 'lorem-subrepo1.dvc'.
2023-05-16 00:50:50,088 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/dvc-subrepo1' to gitignore file.
2023-05-16 00:50:50,550 DEBUG: built tree 'object 18c6b0f1355b604822890e9d9f7c4fad.dir'
2023-05-16 00:50:50,574 DEBUG: Computed stage: 'dvc-subrepo1.dvc' md5: 'None'
2023-05-16 00:50:51,090 DEBUG: built tree 'object 18c6b0f1355b604822890e9d9f7c4fad.dir'
2023-05-16 00:50:51,120 DEBUG: Preparing to transfer data from 'memory://dvc-staging/48bf850b3b4a41ff4772ff49fb18e644ef42297b1782e4e6d727b6927a792f31' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/cache'
2023-05-16 00:50:51,144 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/cache'
2023-05-16 00:50:51,194 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/cache'
2023-05-16 00:50:51,400 DEBUG: Preparing to collect status from 'memory://dvc-staging/48bf850b3b4a41ff4772ff49fb18e644ef42297b1782e4e6d727b6927a792f31'
2023-05-16 00:50:52,648 DEBUG: built tree 'object 18c6b0f1355b604822890e9d9f7c4fad.dir'
2023-05-16 00:50:52,724 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:50:52,749 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.AHfzc4NSRAWRtfbth76evX.tmp'
2023-05-16 00:50:52,824 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.AHfzc4NSRAWRtfbth76evX.tmp'
2023-05-16 00:50:52,849 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/cache/.QeuRmYEw5ZFe3yj5WN3BRW.tmp'
2023-05-16 00:50:52,889 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/dvc-subrepo1/ipsum-subrepo1'
2023-05-16 00:50:53,086 DEBUG: Saving information to 'dvc-subrepo1.dvc'.

To track the changes with git, run:

	git add .gitignore lorem-subrepo1.dvc dvc-subrepo1.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-16 00:51:01,676 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/lorem-subrepo2' to gitignore file.
2023-05-16 00:51:01,757 DEBUG: Computed stage: 'lorem-subrepo2.dvc' md5: 'None'
2023-05-16 00:51:01,853 DEBUG: Preparing to transfer data from 'memory://dvc-staging/323fd2d12ddaab5c4739170a3bff2872e9b4eed48079a98d1975f26f5c875561' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/cache'
2023-05-16 00:51:01,862 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/cache'
2023-05-16 00:51:01,870 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/cache'
2023-05-16 00:51:01,949 DEBUG: Preparing to collect status from 'memory://dvc-staging/323fd2d12ddaab5c4739170a3bff2872e9b4eed48079a98d1975f26f5c875561'
2023-05-16 00:51:02,182 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:51:02,194 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.nA3QBTVzSqcWsB5bCVNMzj.tmp'
2023-05-16 00:51:02,233 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.nA3QBTVzSqcWsB5bCVNMzj.tmp'
2023-05-16 00:51:02,251 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/cache/.nvCDAUyBCsUS9g2JgaJyxb.tmp'
2023-05-16 00:51:02,270 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/lorem-subrepo2'
2023-05-16 00:51:02,436 DEBUG: Saving information to 'lorem-subrepo2.dvc'.
2023-05-16 00:51:02,667 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/dvc-subrepo2' to gitignore file.
2023-05-16 00:51:02,940 DEBUG: built tree 'object d57fb6e19d2ac1a2c135329778adaeed.dir'
2023-05-16 00:51:02,958 DEBUG: Computed stage: 'dvc-subrepo2.dvc' md5: 'None'
2023-05-16 00:51:03,256 DEBUG: built tree 'object d57fb6e19d2ac1a2c135329778adaeed.dir'
2023-05-16 00:51:03,273 DEBUG: Preparing to transfer data from 'memory://dvc-staging/323fd2d12ddaab5c4739170a3bff2872e9b4eed48079a98d1975f26f5c875561' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/cache'
2023-05-16 00:51:03,285 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/cache'
2023-05-16 00:51:03,313 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/cache'
2023-05-16 00:51:03,438 DEBUG: Preparing to collect status from 'memory://dvc-staging/323fd2d12ddaab5c4739170a3bff2872e9b4eed48079a98d1975f26f5c875561'
2023-05-16 00:51:04,188 DEBUG: built tree 'object d57fb6e19d2ac1a2c135329778adaeed.dir'
2023-05-16 00:51:04,227 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:51:04,240 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.UqZPQP45eAGDqhWun5RTzE.tmp'
2023-05-16 00:51:04,282 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.UqZPQP45eAGDqhWun5RTzE.tmp'
2023-05-16 00:51:04,298 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/cache/.3uMG4hgQbUa2dHGWBhQsTw.tmp'
2023-05-16 00:51:04,319 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/dvc-subrepo2/ipsum-subrepo2'
2023-05-16 00:51:04,516 DEBUG: Saving information to 'dvc-subrepo2.dvc'.

To track the changes with git, run:

	git add .gitignore dvc-subrepo2.dvc lorem-subrepo2.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-16 00:51:14,029 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/lorem-subrepo3' to gitignore file.
2023-05-16 00:51:14,157 DEBUG: Computed stage: 'lorem-subrepo3.dvc' md5: 'None'
2023-05-16 00:51:14,292 DEBUG: Preparing to transfer data from 'memory://dvc-staging/0b2fde32225b864f13a4fb9373e83ce64795d3ba7d0479a146f4e24c9e3d1dfc' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/cache'
2023-05-16 00:51:14,306 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/cache'
2023-05-16 00:51:14,320 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/cache'
2023-05-16 00:51:14,461 DEBUG: Preparing to collect status from 'memory://dvc-staging/0b2fde32225b864f13a4fb9373e83ce64795d3ba7d0479a146f4e24c9e3d1dfc'
2023-05-16 00:51:14,695 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:51:14,707 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.DRF4He6gXvKSuYn4ScWiYb.tmp'
2023-05-16 00:51:14,746 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.DRF4He6gXvKSuYn4ScWiYb.tmp'
2023-05-16 00:51:14,761 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/cache/.WrpvgZBwV7TDPFCLUxVBgi.tmp'
2023-05-16 00:51:14,782 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/lorem-subrepo3'
2023-05-16 00:51:14,946 DEBUG: Saving information to 'lorem-subrepo3.dvc'.
2023-05-16 00:51:15,166 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/dvc-subrepo3' to gitignore file.
2023-05-16 00:51:15,451 DEBUG: built tree 'object f45ad0ac42134c36aea67c91c12a8067.dir'
2023-05-16 00:51:15,466 DEBUG: Computed stage: 'dvc-subrepo3.dvc' md5: 'None'
2023-05-16 00:51:15,771 DEBUG: built tree 'object f45ad0ac42134c36aea67c91c12a8067.dir'
2023-05-16 00:51:15,789 DEBUG: Preparing to transfer data from 'memory://dvc-staging/0b2fde32225b864f13a4fb9373e83ce64795d3ba7d0479a146f4e24c9e3d1dfc' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/cache'
2023-05-16 00:51:15,801 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/cache'
2023-05-16 00:51:15,829 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/cache'
2023-05-16 00:51:15,947 DEBUG: Preparing to collect status from 'memory://dvc-staging/0b2fde32225b864f13a4fb9373e83ce64795d3ba7d0479a146f4e24c9e3d1dfc'
2023-05-16 00:51:16,615 DEBUG: built tree 'object f45ad0ac42134c36aea67c91c12a8067.dir'
2023-05-16 00:51:16,654 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:51:16,670 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.afiYq7c2UDM2DF3qoRyJ64.tmp'
2023-05-16 00:51:16,713 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.afiYq7c2UDM2DF3qoRyJ64.tmp'
2023-05-16 00:51:16,727 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/cache/.GFYuaxrinA3dh8MHeB52fF.tmp'
2023-05-16 00:51:16,749 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/dvc-subrepo3/ipsum-subrepo3'
2023-05-16 00:51:16,940 DEBUG: Saving information to 'dvc-subrepo3.dvc'.

To track the changes with git, run:

	git add .gitignore dvc-subrepo3.dvc lorem-subrepo3.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-16 00:51:25,113 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/lorem-test_walk_nested_subrepos_True0' to gitignore file.
2023-05-16 00:51:25,222 DEBUG: Computed stage: 'lorem-test_walk_nested_subrepos_True0.dvc' md5: 'None'
2023-05-16 00:51:25,357 DEBUG: Preparing to transfer data from 'memory://dvc-staging/f7a6b45d467c0ee9013b492e09ca9d29451e0698e6a77603322bf381a5ba2c6d' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/.dvc/cache'
2023-05-16 00:51:25,370 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/.dvc/cache'
2023-05-16 00:51:25,383 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/.dvc/cache'
2023-05-16 00:51:25,490 DEBUG: Preparing to collect status from 'memory://dvc-staging/f7a6b45d467c0ee9013b492e09ca9d29451e0698e6a77603322bf381a5ba2c6d'
2023-05-16 00:51:25,722 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:51:25,735 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/.YYsaxEhcrfWUfNUy6n6G9z.tmp'
2023-05-16 00:51:25,773 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/.YYsaxEhcrfWUfNUy6n6G9z.tmp'
2023-05-16 00:51:25,787 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/.dvc/cache/.a4jBS4bHMyYPCFoLJtMMrr.tmp'
2023-05-16 00:51:25,806 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/lorem-test_walk_nested_subrepos_True0'
2023-05-16 00:51:25,970 DEBUG: Saving information to 'lorem-test_walk_nested_subrepos_True0.dvc'.
2023-05-16 00:51:26,217 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/dvc-test_walk_nested_subrepos_True0' to gitignore file.
2023-05-16 00:51:26,494 DEBUG: built tree 'object 300ad8f80f3ed585073c511adf82dbb6.dir'
2023-05-16 00:51:26,509 DEBUG: Computed stage: 'dvc-test_walk_nested_subrepos_True0.dvc' md5: 'None'
2023-05-16 00:51:26,813 DEBUG: built tree 'object 300ad8f80f3ed585073c511adf82dbb6.dir'
2023-05-16 00:51:26,830 DEBUG: Preparing to transfer data from 'memory://dvc-staging/f7a6b45d467c0ee9013b492e09ca9d29451e0698e6a77603322bf381a5ba2c6d' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/.dvc/cache'
2023-05-16 00:51:26,843 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/.dvc/cache'
2023-05-16 00:51:26,877 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/.dvc/cache'
2023-05-16 00:51:26,998 DEBUG: Preparing to collect status from 'memory://dvc-staging/f7a6b45d467c0ee9013b492e09ca9d29451e0698e6a77603322bf381a5ba2c6d'
2023-05-16 00:51:27,673 DEBUG: built tree 'object 300ad8f80f3ed585073c511adf82dbb6.dir'
2023-05-16 00:51:27,712 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:51:27,724 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/.dtrZA3hGxKx9pkyDrMxsPz.tmp'
2023-05-16 00:51:27,767 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/.dtrZA3hGxKx9pkyDrMxsPz.tmp'
2023-05-16 00:51:27,782 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/.dvc/cache/.Rg3MegM4anQAD5h2Ly6EQm.tmp'
2023-05-16 00:51:27,802 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/dvc-test_walk_nested_subrepos_True0/ipsum-test_walk_nested_subrepos_True0'
2023-05-16 00:51:27,996 DEBUG: Saving information to 'dvc-test_walk_nested_subrepos_True0.dvc'.

To track the changes with git, run:

	git add .gitignore dvc-test_walk_nested_subrepos_True0.dvc lorem-test_walk_nested_subrepos_True0.dvc

To enable auto staging, run:

	dvc config core.autostage true
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  1.84file/s]Collecting targets          |2.00 [00:00,  2.65file/s]                                                      !  0% Adding...|          |0/2 [00:00<?,     ?file/s]
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  8.51file/s][A
                                                                                [A 50% Adding...|█████     | lorem-subrepo1 |1/2 [00:01<00:01,  1.96s/file]
![A
Building data objects from dvc-subrepo1          |0.00 [00:00,      ?obj/s][A
                                                                           [A
![A
Building data objects from dvc-subrepo1          |0.00 [00:00,      ?obj/s][A
                                                                           [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  8.77file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  8.77file/s][A

![A[A

  0%|          |memory://.TJN4CHVCsKiQzWPqtzLt2n.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.TJN4CHVCsKiQzWPqtzLt2n0.00/74.0 [00:00<?,        ?B/s][A[A

100%|██████████|memory://.TJN4CHVCsKiQzWPqtz74.0/74.0 [00:00<00:00,      690B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  3.28file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dvc-subrepo1          |0.00 [00:00,      ?obj/s][A
                                                                           [A100% Adding...|██████████| dvc-subrepo1 |2/2 [00:05<00:00,  2.76s/file]  100% Adding...|██████████|2/2 [00:05,  2.66s/file]                     
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.48file/s]Collecting targets          |2.00 [00:00,  4.98file/s]                                                      !  0% Adding...|          |0/2 [00:00<?,     ?file/s]
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
                                                                                [A 50% Adding...|█████     | lorem-subrepo2 |1/2 [00:00<00:00,  1.02file/s]
![A
Building data objects from dvc-subrepo2          |0.00 [00:00,      ?obj/s][A
                                                                           [A
![A
Building data objects from dvc-subrepo2          |0.00 [00:00,      ?obj/s][A
                                                                           [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  7.99file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  7.99file/s][A

![A[A

  0%|          |memory://.UEQem7LmRBP9ayYwNJmpZd.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.UEQem7LmRBP9ayYwNJmpZd0.00/74.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  5.77file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dvc-subrepo2          |0.00 [00:00,      ?obj/s][A
                                                                           [A100% Adding...|██████████| dvc-subrepo2 |2/2 [00:03<00:00,  1.63s/file]  100% Adding...|██████████|2/2 [00:03,  1.55s/file]                     
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  1.90file/s]Collecting targets          |2.00 [00:00,  2.76file/s]                                                      !  0% Adding...|          |0/2 [00:00<?,     ?file/s]
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
                                                                                [A 50% Adding...|█████     | lorem-subrepo3 |1/2 [00:01<00:01,  1.21s/file]
![A
Building data objects from dvc-subrepo3          |0.00 [00:00,      ?obj/s][A
                                                                           [A
![A
Building data objects from dvc-subrepo3          |0.00 [00:00,      ?obj/s][A
                                                                           [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00, 10.03file/s][A

![A[A

  0%|          |memory://.YccXFEUpvxVKGywCHi9Ffs.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.YccXFEUpvxVKGywCHi9Ffs0.00/74.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  7.55file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dvc-subrepo3          |0.00 [00:00,      ?obj/s][A
                                                                           [A100% Adding...|██████████| dvc-subrepo3 |2/2 [00:03<00:00,  1.68s/file]  100% Adding...|██████████|2/2 [00:03,  1.63s/file]                     
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  4.11file/s]                                                      !  0% Adding...|          |0/2 [00:00<?,     ?file/s]
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
                                                                                [A 50% |█████     | lorem-test_walk_nested_subrepos_True0 |1/2 [00:01<00:01,  1.10s/file]
![A
          |0.00 [00:00,      ?obj/s][A
                                    [A
![A
          |0.00 [00:00,      ?obj/s][A
                                    [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.90file/s][A

![A[A

  0%|          |memory://.fbjADo8WBXcA95q9GRmeRL.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.fbjADo8WBXcA95q9GRmeRL0.00/97.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  7.49file/s][A

                                                                                [A[A
                                                                                [A
![A
          |0.00 [00:00,      ?obj/s][A
                                    [A100% |██████████| dvc-test_walk_nested_subrepos_True0 |2/2 [00:03<00:00,  1.64s/file]  100% Adding...|██████████|2/2 [00:03,  1.57s/file]                                   
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/config.local' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/tmp' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/cache' to gitignore file.
DEBUG    dvc.utils.fs:fs.py:63 Removing '/var/tmp/dvc/repo/c4dcc2082fa0e198fdac91c678e125bd'
DEBUG    dvc.repo.scm_context:scm_context.py:68 Staging files: {'/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/.gitignore', '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvcignore', '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/config'}
INFO     dvc.repo.init:init.py:93 Initialized DVC repository.

INFO     dvc.repo.init:init.py:95 You can now commit the changes to git.

DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/config.local' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/tmp' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/cache' to gitignore file.
DEBUG    dvc.utils.fs:fs.py:63 Removing '/var/tmp/dvc/repo/99bc502ae28fd74378d245be71414d73'
DEBUG    dvc.repo.scm_context:scm_context.py:68 Staging files: {'/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvcignore', '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/.gitignore', '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/config'}
INFO     dvc.repo.init:init.py:93 Initialized DVC repository.

INFO     dvc.repo.init:init.py:95 You can now commit the changes to git.

DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/config.local' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/tmp' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/cache' to gitignore file.
DEBUG    dvc.utils.fs:fs.py:63 Removing '/var/tmp/dvc/repo/1c9e964c25d04f38f830d84607849467'
DEBUG    dvc.repo.scm_context:scm_context.py:68 Staging files: {'/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/config', '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvcignore', '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/.gitignore'}
INFO     dvc.repo.init:init.py:93 Initialized DVC repository.

INFO     dvc.repo.init:init.py:95 You can now commit the changes to git.

DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/lorem-subrepo1' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'lorem-subrepo1.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/48bf850b3b4a41ff4772ff49fb18e644ef42297b1782e4e6d727b6927a792f31' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/48bf850b3b4a41ff4772ff49fb18e644ef42297b1782e4e6d727b6927a792f31'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.m6NkK8zCt3qoJvKXBfaNip.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.m6NkK8zCt3qoJvKXBfaNip.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/cache/.Ucsh5Ufj5zNMnpJ6tDfNqM.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/lorem-subrepo1'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'lorem-subrepo1.dvc'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/dvc-subrepo1' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 18c6b0f1355b604822890e9d9f7c4fad.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dvc-subrepo1.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 18c6b0f1355b604822890e9d9f7c4fad.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/48bf850b3b4a41ff4772ff49fb18e644ef42297b1782e4e6d727b6927a792f31' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/48bf850b3b4a41ff4772ff49fb18e644ef42297b1782e4e6d727b6927a792f31'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 18c6b0f1355b604822890e9d9f7c4fad.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.AHfzc4NSRAWRtfbth76evX.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.AHfzc4NSRAWRtfbth76evX.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/.dvc/cache/.QeuRmYEw5ZFe3yj5WN3BRW.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/dvc-subrepo1/ipsum-subrepo1'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dvc-subrepo1.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore lorem-subrepo1.dvc dvc-subrepo1.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/lorem-subrepo2' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'lorem-subrepo2.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/323fd2d12ddaab5c4739170a3bff2872e9b4eed48079a98d1975f26f5c875561' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/323fd2d12ddaab5c4739170a3bff2872e9b4eed48079a98d1975f26f5c875561'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.nA3QBTVzSqcWsB5bCVNMzj.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.nA3QBTVzSqcWsB5bCVNMzj.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/cache/.nvCDAUyBCsUS9g2JgaJyxb.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/lorem-subrepo2'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'lorem-subrepo2.dvc'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/dvc-subrepo2' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object d57fb6e19d2ac1a2c135329778adaeed.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dvc-subrepo2.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object d57fb6e19d2ac1a2c135329778adaeed.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/323fd2d12ddaab5c4739170a3bff2872e9b4eed48079a98d1975f26f5c875561' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/323fd2d12ddaab5c4739170a3bff2872e9b4eed48079a98d1975f26f5c875561'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object d57fb6e19d2ac1a2c135329778adaeed.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.UqZPQP45eAGDqhWun5RTzE.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.UqZPQP45eAGDqhWun5RTzE.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/.dvc/cache/.3uMG4hgQbUa2dHGWBhQsTw.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo2/dvc-subrepo2/ipsum-subrepo2'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dvc-subrepo2.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dvc-subrepo2.dvc lorem-subrepo2.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/lorem-subrepo3' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'lorem-subrepo3.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/0b2fde32225b864f13a4fb9373e83ce64795d3ba7d0479a146f4e24c9e3d1dfc' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/0b2fde32225b864f13a4fb9373e83ce64795d3ba7d0479a146f4e24c9e3d1dfc'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.DRF4He6gXvKSuYn4ScWiYb.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.DRF4He6gXvKSuYn4ScWiYb.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/cache/.WrpvgZBwV7TDPFCLUxVBgi.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/lorem-subrepo3'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'lorem-subrepo3.dvc'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/dvc-subrepo3' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object f45ad0ac42134c36aea67c91c12a8067.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dvc-subrepo3.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object f45ad0ac42134c36aea67c91c12a8067.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/0b2fde32225b864f13a4fb9373e83ce64795d3ba7d0479a146f4e24c9e3d1dfc' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/0b2fde32225b864f13a4fb9373e83ce64795d3ba7d0479a146f4e24c9e3d1dfc'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object f45ad0ac42134c36aea67c91c12a8067.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.afiYq7c2UDM2DF3qoRyJ64.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.afiYq7c2UDM2DF3qoRyJ64.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/.dvc/cache/.GFYuaxrinA3dh8MHeB52fF.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/subrepo1/subrepo3/dvc-subrepo3/ipsum-subrepo3'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dvc-subrepo3.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dvc-subrepo3.dvc lorem-subrepo3.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/lorem-test_walk_nested_subrepos_True0' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'lorem-test_walk_nested_subrepos_True0.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/f7a6b45d467c0ee9013b492e09ca9d29451e0698e6a77603322bf381a5ba2c6d' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/f7a6b45d467c0ee9013b492e09ca9d29451e0698e6a77603322bf381a5ba2c6d'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/.YYsaxEhcrfWUfNUy6n6G9z.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/.YYsaxEhcrfWUfNUy6n6G9z.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/.dvc/cache/.a4jBS4bHMyYPCFoLJtMMrr.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/lorem-test_walk_nested_subrepos_True0'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'lorem-test_walk_nested_subrepos_True0.dvc'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/dvc-test_walk_nested_subrepos_True0' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 300ad8f80f3ed585073c511adf82dbb6.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dvc-test_walk_nested_subrepos_True0.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 300ad8f80f3ed585073c511adf82dbb6.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/f7a6b45d467c0ee9013b492e09ca9d29451e0698e6a77603322bf381a5ba2c6d' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/f7a6b45d467c0ee9013b492e09ca9d29451e0698e6a77603322bf381a5ba2c6d'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 300ad8f80f3ed585073c511adf82dbb6.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/.dtrZA3hGxKx9pkyDrMxsPz.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/.dtrZA3hGxKx9pkyDrMxsPz.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/.dvc/cache/.Rg3MegM4anQAD5h2Ly6EQm.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_True0/dvc-test_walk_nested_subrepos_True0/ipsum-test_walk_nested_subrepos_True0'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dvc-test_walk_nested_subrepos_True0.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dvc-test_walk_nested_subrepos_True0.dvc lorem-test_walk_nested_subrepos_True0.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
_______________________ test_walk_nested_subrepos[False] _______________________

tmp_dir = PosixTmpDir('/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0')
dvc = Repo: '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0'
scm = Git: '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/.git'
traverse_subrepos = False

    @pytest.mark.parametrize("traverse_subrepos", [True, False])
    def test_walk_nested_subrepos(tmp_dir, dvc, scm, traverse_subrepos):
        # generate a dvc and fs structure, with suffix based on repo's basename
        def fs_structure(suffix):
            return {
                f"foo-{suffix}": f"foo-{suffix}",
                f"dir-{suffix}": {f"bar-{suffix}": f"bar-{suffix}"},
            }
    
        def dvc_structure(suffix):
            return {
                f"lorem-{suffix}": f"lorem-{suffix}",
                f"dvc-{suffix}": {f"ipsum-{suffix}": f"ipsum-{suffix}"},
            }
    
        paths = ["subrepo1", "subrepo2", os.path.join("subrepo1", "subrepo3")]
        subrepos = [tmp_dir / path for path in paths]
        for repo_dir in subrepos:
            make_subrepo(repo_dir, scm)
    
        extras = {".gitignore"}  # these files are always there
        expected = {}
        for repo_dir in [*subrepos, tmp_dir]:
            base = os.path.basename(repo_dir)
            scm_files = fs_structure(base)
            dvc_files = dvc_structure(base)
            with repo_dir.chdir():
                repo_dir.scm_gen(scm_files, commit=f"git add in {repo_dir}")
                repo_dir.dvc_gen(dvc_files, commit=f"dvc add in {repo_dir}")
    
            if traverse_subrepos or repo_dir == tmp_dir:
                repo_dir_path = (
                    "/" + repo_dir.relative_to(tmp_dir).as_posix()
                    if repo_dir != tmp_dir
                    else "/"
                )
                expected[repo_dir_path] = set(scm_files.keys() | dvc_files.keys() | extras)
                # files inside a dvc directory
                expected[posixpath.join(repo_dir_path, f"dvc-{base}")] = {f"ipsum-{base}"}
                # files inside a git directory
                expected[posixpath.join(repo_dir_path, f"dir-{base}")] = {f"bar-{base}"}
    
        if traverse_subrepos:
            # update subrepos
            expected["/"].update(["subrepo1", "subrepo2"])
            expected["/subrepo1"].add("subrepo3")
    
        actual = {}
        fs = DVCFileSystem(repo=dvc)
>       for root, dirs, files in fs.walk("/", ignore_subrepos=not traverse_subrepos):

/home/user/dvc/tests/unit/fs/test_dvc.py:636: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:428: in walk
    yield from self.walk(
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/fsspec/spec.py:393: in walk
    listing = self.ls(path, detail=True, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:282: in ls
    for info in dvc_fs.ls(dvc_path, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:391: in ls
    return self.fs.ls(path, detail=detail, **kwargs)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/fs.py:102: in ls
    for key, info in self.index.ls(root_key, detail=True):
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:582: in ls
    self._ensure_loaded(root_key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:577: in _ensure_loaded
    self._load(prefix, entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14ad03a9bd20>
key = ('dvc-test_walk_nested_subrepos_Fals0',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
----------------------------- Captured stdout call -----------------------------
2023-05-16 00:51:41,297 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/config.local' to gitignore file.
2023-05-16 00:51:41,321 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/tmp' to gitignore file.
2023-05-16 00:51:41,343 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/cache' to gitignore file.
2023-05-16 00:51:41,382 DEBUG: Removing '/var/tmp/dvc/repo/b46b29e8fada91e0da98a0abf1087ba1'
2023-05-16 00:51:42,057 DEBUG: Staging files: {'/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvcignore', '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/.gitignore', '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/config'}
Initialized DVC repository.

You can now commit the changes to git.

2023-05-16 00:51:47,435 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/config.local' to gitignore file.
2023-05-16 00:51:47,461 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/tmp' to gitignore file.
2023-05-16 00:51:47,487 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/cache' to gitignore file.
2023-05-16 00:51:47,528 DEBUG: Removing '/var/tmp/dvc/repo/fcab36b5e492fa2689edfcb8526200fb'
2023-05-16 00:51:48,210 DEBUG: Staging files: {'/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/config', '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvcignore', '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/.gitignore'}
Initialized DVC repository.

You can now commit the changes to git.

2023-05-16 00:51:53,263 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/config.local' to gitignore file.
2023-05-16 00:51:53,296 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/tmp' to gitignore file.
2023-05-16 00:51:53,323 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/cache' to gitignore file.
2023-05-16 00:51:53,366 DEBUG: Removing '/var/tmp/dvc/repo/218ff1d63f7bf2968e73db422ee3d055'
2023-05-16 00:51:54,023 DEBUG: Staging files: {'/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/.gitignore', '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvcignore', '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/config'}
Initialized DVC repository.

You can now commit the changes to git.

2023-05-16 00:52:02,109 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/lorem-subrepo1' to gitignore file.
2023-05-16 00:52:02,220 DEBUG: Computed stage: 'lorem-subrepo1.dvc' md5: 'None'
2023-05-16 00:52:02,355 DEBUG: Preparing to transfer data from 'memory://dvc-staging/473ee20a845e798915dfd23ecbb4e8421f0cea64d5d62bc0006a9dfac9683dbc' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/cache'
2023-05-16 00:52:02,368 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/cache'
2023-05-16 00:52:02,379 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/cache'
2023-05-16 00:52:02,487 DEBUG: Preparing to collect status from 'memory://dvc-staging/473ee20a845e798915dfd23ecbb4e8421f0cea64d5d62bc0006a9dfac9683dbc'
2023-05-16 00:52:02,727 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:52:02,741 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.CgsDuSjfD37p3wkKR8ro7L.tmp'
2023-05-16 00:52:02,784 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.CgsDuSjfD37p3wkKR8ro7L.tmp'
2023-05-16 00:52:02,799 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/cache/.bHCy9VuZG7K4gAWAMxgeFX.tmp'
2023-05-16 00:52:02,818 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/lorem-subrepo1'
2023-05-16 00:52:02,986 DEBUG: Saving information to 'lorem-subrepo1.dvc'.
2023-05-16 00:52:03,220 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/dvc-subrepo1' to gitignore file.
2023-05-16 00:52:03,491 DEBUG: built tree 'object 18c6b0f1355b604822890e9d9f7c4fad.dir'
2023-05-16 00:52:03,507 DEBUG: Computed stage: 'dvc-subrepo1.dvc' md5: 'None'
2023-05-16 00:52:03,805 DEBUG: built tree 'object 18c6b0f1355b604822890e9d9f7c4fad.dir'
2023-05-16 00:52:03,823 DEBUG: Preparing to transfer data from 'memory://dvc-staging/473ee20a845e798915dfd23ecbb4e8421f0cea64d5d62bc0006a9dfac9683dbc' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/cache'
2023-05-16 00:52:03,835 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/cache'
2023-05-16 00:52:03,865 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/cache'
2023-05-16 00:52:03,983 DEBUG: Preparing to collect status from 'memory://dvc-staging/473ee20a845e798915dfd23ecbb4e8421f0cea64d5d62bc0006a9dfac9683dbc'
2023-05-16 00:52:04,727 DEBUG: built tree 'object 18c6b0f1355b604822890e9d9f7c4fad.dir'
2023-05-16 00:52:04,767 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:52:04,781 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.CWsZnPzgHtuc8VEJHfymnp.tmp'
2023-05-16 00:52:04,825 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.CWsZnPzgHtuc8VEJHfymnp.tmp'
2023-05-16 00:52:04,836 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/cache/.N5uAccbxNxjcapjfTQfPCN.tmp'
2023-05-16 00:52:04,855 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/dvc-subrepo1/ipsum-subrepo1'
2023-05-16 00:52:05,031 DEBUG: Saving information to 'dvc-subrepo1.dvc'.

To track the changes with git, run:

	git add .gitignore lorem-subrepo1.dvc dvc-subrepo1.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-16 00:52:13,652 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/lorem-subrepo2' to gitignore file.
2023-05-16 00:52:13,758 DEBUG: Computed stage: 'lorem-subrepo2.dvc' md5: 'None'
2023-05-16 00:52:13,891 DEBUG: Preparing to transfer data from 'memory://dvc-staging/feb2958c03ec4ddce04cc42a48c7e71078da4e138027fbf734ca2025945cc2b3' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/cache'
2023-05-16 00:52:13,904 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/cache'
2023-05-16 00:52:13,917 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/cache'
2023-05-16 00:52:14,018 DEBUG: Preparing to collect status from 'memory://dvc-staging/feb2958c03ec4ddce04cc42a48c7e71078da4e138027fbf734ca2025945cc2b3'
2023-05-16 00:52:14,275 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:52:14,289 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.bQx8gyGouitc6JeueAYR8B.tmp'
2023-05-16 00:52:14,328 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.bQx8gyGouitc6JeueAYR8B.tmp'
2023-05-16 00:52:14,343 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/cache/.QRiirhAmkwjWTYmWZCSS5M.tmp'
2023-05-16 00:52:14,361 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/lorem-subrepo2'
2023-05-16 00:52:14,528 DEBUG: Saving information to 'lorem-subrepo2.dvc'.
2023-05-16 00:52:14,780 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/dvc-subrepo2' to gitignore file.
2023-05-16 00:52:15,057 DEBUG: built tree 'object d57fb6e19d2ac1a2c135329778adaeed.dir'
2023-05-16 00:52:15,072 DEBUG: Computed stage: 'dvc-subrepo2.dvc' md5: 'None'
2023-05-16 00:52:15,378 DEBUG: built tree 'object d57fb6e19d2ac1a2c135329778adaeed.dir'
2023-05-16 00:52:15,395 DEBUG: Preparing to transfer data from 'memory://dvc-staging/feb2958c03ec4ddce04cc42a48c7e71078da4e138027fbf734ca2025945cc2b3' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/cache'
2023-05-16 00:52:15,408 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/cache'
2023-05-16 00:52:15,437 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/cache'
2023-05-16 00:52:15,557 DEBUG: Preparing to collect status from 'memory://dvc-staging/feb2958c03ec4ddce04cc42a48c7e71078da4e138027fbf734ca2025945cc2b3'
2023-05-16 00:52:16,254 DEBUG: built tree 'object d57fb6e19d2ac1a2c135329778adaeed.dir'
2023-05-16 00:52:16,295 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:52:16,307 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.mZbYiHks3RRJdNPtHSbQ3y.tmp'
2023-05-16 00:52:16,350 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.mZbYiHks3RRJdNPtHSbQ3y.tmp'
2023-05-16 00:52:16,365 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/cache/.ETyC5aEJEQX7hgfRq8BX43.tmp'
2023-05-16 00:52:16,386 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/dvc-subrepo2/ipsum-subrepo2'
2023-05-16 00:52:16,577 DEBUG: Saving information to 'dvc-subrepo2.dvc'.

To track the changes with git, run:

	git add .gitignore dvc-subrepo2.dvc lorem-subrepo2.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-16 00:52:24,896 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/lorem-subrepo3' to gitignore file.
2023-05-16 00:52:25,013 DEBUG: Computed stage: 'lorem-subrepo3.dvc' md5: 'None'
2023-05-16 00:52:25,182 DEBUG: Preparing to transfer data from 'memory://dvc-staging/6e8004a8c80b059883fa94a9ad21e0bc3e6c67f53640b3b482f6654db2cc97ce' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/cache'
2023-05-16 00:52:25,193 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/cache'
2023-05-16 00:52:25,203 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/cache'
2023-05-16 00:52:25,287 DEBUG: Preparing to collect status from 'memory://dvc-staging/6e8004a8c80b059883fa94a9ad21e0bc3e6c67f53640b3b482f6654db2cc97ce'
2023-05-16 00:52:25,524 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:52:25,536 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.DGytdFAzmizEoJFtx4wdQY.tmp'
2023-05-16 00:52:25,578 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.DGytdFAzmizEoJFtx4wdQY.tmp'
2023-05-16 00:52:25,593 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/cache/.imDz8nzdZZJ7ZdiXorndYG.tmp'
2023-05-16 00:52:25,614 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/lorem-subrepo3'
2023-05-16 00:52:25,789 DEBUG: Saving information to 'lorem-subrepo3.dvc'.
2023-05-16 00:52:26,018 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/dvc-subrepo3' to gitignore file.
2023-05-16 00:52:26,307 DEBUG: built tree 'object f45ad0ac42134c36aea67c91c12a8067.dir'
2023-05-16 00:52:26,322 DEBUG: Computed stage: 'dvc-subrepo3.dvc' md5: 'None'
2023-05-16 00:52:26,621 DEBUG: built tree 'object f45ad0ac42134c36aea67c91c12a8067.dir'
2023-05-16 00:52:26,637 DEBUG: Preparing to transfer data from 'memory://dvc-staging/6e8004a8c80b059883fa94a9ad21e0bc3e6c67f53640b3b482f6654db2cc97ce' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/cache'
2023-05-16 00:52:26,650 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/cache'
2023-05-16 00:52:26,682 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/cache'
2023-05-16 00:52:26,800 DEBUG: Preparing to collect status from 'memory://dvc-staging/6e8004a8c80b059883fa94a9ad21e0bc3e6c67f53640b3b482f6654db2cc97ce'
2023-05-16 00:52:27,464 DEBUG: built tree 'object f45ad0ac42134c36aea67c91c12a8067.dir'
2023-05-16 00:52:27,504 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:52:27,516 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.URWcWyGnLQzU6cQXpxompa.tmp'
2023-05-16 00:52:27,562 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.URWcWyGnLQzU6cQXpxompa.tmp'
2023-05-16 00:52:27,576 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/cache/.fjrpzDz8kr5aMbmYYzR6cb.tmp'
2023-05-16 00:52:27,597 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/dvc-subrepo3/ipsum-subrepo3'
2023-05-16 00:52:27,786 DEBUG: Saving information to 'dvc-subrepo3.dvc'.

To track the changes with git, run:

	git add .gitignore dvc-subrepo3.dvc lorem-subrepo3.dvc

To enable auto staging, run:

	dvc config core.autostage true
2023-05-16 00:52:36,366 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/lorem-test_walk_nested_subrepos_Fals0' to gitignore file.
2023-05-16 00:52:36,472 DEBUG: Computed stage: 'lorem-test_walk_nested_subrepos_Fals0.dvc' md5: 'None'
2023-05-16 00:52:36,601 DEBUG: Preparing to transfer data from 'memory://dvc-staging/9f653e280fd7f577509c99dec9e25f152a3c0513103a05d604645d1a28aa6459' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/.dvc/cache'
2023-05-16 00:52:36,613 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/.dvc/cache'
2023-05-16 00:52:36,626 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/.dvc/cache'
2023-05-16 00:52:36,726 DEBUG: Preparing to collect status from 'memory://dvc-staging/9f653e280fd7f577509c99dec9e25f152a3c0513103a05d604645d1a28aa6459'
2023-05-16 00:52:36,958 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:52:36,970 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/.LKyJSFb7BM6QRVKfcBQaQD.tmp'
2023-05-16 00:52:37,011 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/.LKyJSFb7BM6QRVKfcBQaQD.tmp'
2023-05-16 00:52:37,027 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/.dvc/cache/.ceFMRfjXmDCM3SKwqKbrf2.tmp'
2023-05-16 00:52:37,045 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/lorem-test_walk_nested_subrepos_Fals0'
2023-05-16 00:52:37,212 DEBUG: Saving information to 'lorem-test_walk_nested_subrepos_Fals0.dvc'.
2023-05-16 00:52:37,443 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/dvc-test_walk_nested_subrepos_Fals0' to gitignore file.
2023-05-16 00:52:37,743 DEBUG: built tree 'object d5b81865df474e8f6151b41a8570624b.dir'
2023-05-16 00:52:37,758 DEBUG: Computed stage: 'dvc-test_walk_nested_subrepos_Fals0.dvc' md5: 'None'
2023-05-16 00:52:38,064 DEBUG: built tree 'object d5b81865df474e8f6151b41a8570624b.dir'
2023-05-16 00:52:38,082 DEBUG: Preparing to transfer data from 'memory://dvc-staging/9f653e280fd7f577509c99dec9e25f152a3c0513103a05d604645d1a28aa6459' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/.dvc/cache'
2023-05-16 00:52:38,094 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/.dvc/cache'
2023-05-16 00:52:38,122 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/.dvc/cache'
2023-05-16 00:52:38,238 DEBUG: Preparing to collect status from 'memory://dvc-staging/9f653e280fd7f577509c99dec9e25f152a3c0513103a05d604645d1a28aa6459'
2023-05-16 00:52:38,915 DEBUG: built tree 'object d5b81865df474e8f6151b41a8570624b.dir'
2023-05-16 00:52:38,954 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:52:38,966 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/.NSRxUcZtY78p2uEBBRh5dF.tmp'
2023-05-16 00:52:39,008 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/.NSRxUcZtY78p2uEBBRh5dF.tmp'
2023-05-16 00:52:39,023 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/.dvc/cache/.Cum4wn2W7Bnqi3LHnZhHxY.tmp'
2023-05-16 00:52:39,044 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/dvc-test_walk_nested_subrepos_Fals0/ipsum-test_walk_nested_subrepos_Fals0'
2023-05-16 00:52:39,237 DEBUG: Saving information to 'dvc-test_walk_nested_subrepos_Fals0.dvc'.

To track the changes with git, run:

	git add .gitignore dvc-test_walk_nested_subrepos_Fals0.dvc lorem-test_walk_nested_subrepos_Fals0.dvc

To enable auto staging, run:

	dvc config core.autostage true
----------------------------- Captured stderr call -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.78file/s]Collecting targets          |2.00 [00:00,  5.25file/s]                                                      !  0% Adding...|          |0/2 [00:00<?,     ?file/s]
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
                                                                                [A 50% Adding...|█████     | lorem-subrepo1 |1/2 [00:01<00:01,  1.11s/file]
![A
Building data objects from dvc-subrepo1          |0.00 [00:00,      ?obj/s][A
                                                                           [A
![A
Building data objects from dvc-subrepo1          |0.00 [00:00,      ?obj/s][A
                                                                           [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  8.56file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  8.56file/s][A

![A[A

  0%|          |memory://.Kt4MkP5rm9diHJYVSgFm4S.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.Kt4MkP5rm9diHJYVSgFm4S0.00/74.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  5.49file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dvc-subrepo1          |0.00 [00:00,      ?obj/s][A
                                                                           [A100% Adding...|██████████| dvc-subrepo1 |2/2 [00:03<00:00,  1.67s/file]  100% Adding...|██████████|2/2 [00:03,  1.60s/file]                     
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.83file/s]Collecting targets          |2.00 [00:00,  5.35file/s]                                                      !  0% Adding...|          |0/2 [00:00<?,     ?file/s]
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
                                                                                [A 50% Adding...|█████     | lorem-subrepo2 |1/2 [00:01<00:01,  1.10s/file]
![A
Building data objects from dvc-subrepo2          |0.00 [00:00,      ?obj/s][A
                                                                           [A
![A
Building data objects from dvc-subrepo2          |0.00 [00:00,      ?obj/s][A
                                                                           [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.57file/s][A

![A[A

  0%|          |memory://.5N8TgjDcSqLPzdiJCXZpj7.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.5N8TgjDcSqLPzdiJCXZpj70.00/74.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  7.40file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dvc-subrepo2          |0.00 [00:00,      ?obj/s][A
                                                                           [A100% Adding...|██████████| dvc-subrepo2 |2/2 [00:03<00:00,  1.66s/file]  100% Adding...|██████████|2/2 [00:03,  1.59s/file]                     
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  4.12file/s]Collecting targets          |2.00 [00:00,  5.66file/s]                                                      !  0% Adding...|          |0/2 [00:00<?,     ?file/s]
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
                                                                                [A 50% Adding...|█████     | lorem-subrepo3 |1/2 [00:01<00:01,  1.12s/file]
![A
Building data objects from dvc-subrepo3          |0.00 [00:00,      ?obj/s][A
                                                                           [A
![A
Building data objects from dvc-subrepo3          |0.00 [00:00,      ?obj/s][A
                                                                           [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00, 10.06file/s][A

![A[A

  0%|          |memory://.2iBYVoTGVyGQ3qP6r7Z7ik.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.2iBYVoTGVyGQ3qP6r7Z7ik0.00/74.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  7.66file/s][A

                                                                                [A[A
                                                                                [A
![A
Building data objects from dvc-subrepo3          |0.00 [00:00,      ?obj/s][A
                                                                           [A100% Adding...|██████████| dvc-subrepo3 |2/2 [00:03<00:00,  1.88s/file]  100% Adding...|██████████|2/2 [00:03,  1.78s/file]                     
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.63file/s]Collecting targets          |2.00 [00:00,  5.24file/s]                                                      !  0% Adding...|          |0/2 [00:00<?,     ?file/s]
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
                                                                                [A 50% |█████     | lorem-test_walk_nested_subrepos_Fals0 |1/2 [00:01<00:01,  1.08s/file]
![A
          |0.00 [00:00,      ?obj/s][A
                                    [A
![A
          |0.00 [00:00,      ?obj/s][A
                                    [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
100%|██████████|Transferring                      1/1 [00:00<00:00,  9.74file/s][A

![A[A

  0%|          |memory://.ARmdMnhtb2oyiCGm5ehrUm.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.ARmdMnhtb2oyiCGm5ehrUm0.00/97.0 [00:00<?,        ?B/s][A[A
  0%|          |Transferring                      2/? [00:00<00:00,  7.39file/s][A

                                                                                [A[A
                                                                                [A
![A
          |0.00 [00:00,      ?obj/s][A
                                    [A100% |██████████| dvc-test_walk_nested_subrepos_Fals0 |2/2 [00:03<00:00,  1.64s/file]  100% Adding...|██████████|2/2 [00:03,  1.57s/file]                                   
------------------------------ Captured log call -------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/config.local' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/tmp' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/cache' to gitignore file.
DEBUG    dvc.utils.fs:fs.py:63 Removing '/var/tmp/dvc/repo/b46b29e8fada91e0da98a0abf1087ba1'
DEBUG    dvc.repo.scm_context:scm_context.py:68 Staging files: {'/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvcignore', '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/.gitignore', '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/config'}
INFO     dvc.repo.init:init.py:93 Initialized DVC repository.

INFO     dvc.repo.init:init.py:95 You can now commit the changes to git.

DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/config.local' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/tmp' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/cache' to gitignore file.
DEBUG    dvc.utils.fs:fs.py:63 Removing '/var/tmp/dvc/repo/fcab36b5e492fa2689edfcb8526200fb'
DEBUG    dvc.repo.scm_context:scm_context.py:68 Staging files: {'/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/config', '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvcignore', '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/.gitignore'}
INFO     dvc.repo.init:init.py:93 Initialized DVC repository.

INFO     dvc.repo.init:init.py:95 You can now commit the changes to git.

DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/config.local' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/tmp' to gitignore file.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/cache' to gitignore file.
DEBUG    dvc.utils.fs:fs.py:63 Removing '/var/tmp/dvc/repo/218ff1d63f7bf2968e73db422ee3d055'
DEBUG    dvc.repo.scm_context:scm_context.py:68 Staging files: {'/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/.gitignore', '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvcignore', '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/config'}
INFO     dvc.repo.init:init.py:93 Initialized DVC repository.

INFO     dvc.repo.init:init.py:95 You can now commit the changes to git.

DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/lorem-subrepo1' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'lorem-subrepo1.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/473ee20a845e798915dfd23ecbb4e8421f0cea64d5d62bc0006a9dfac9683dbc' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/473ee20a845e798915dfd23ecbb4e8421f0cea64d5d62bc0006a9dfac9683dbc'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.CgsDuSjfD37p3wkKR8ro7L.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.CgsDuSjfD37p3wkKR8ro7L.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/cache/.bHCy9VuZG7K4gAWAMxgeFX.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/lorem-subrepo1'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'lorem-subrepo1.dvc'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/dvc-subrepo1' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 18c6b0f1355b604822890e9d9f7c4fad.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dvc-subrepo1.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 18c6b0f1355b604822890e9d9f7c4fad.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/473ee20a845e798915dfd23ecbb4e8421f0cea64d5d62bc0006a9dfac9683dbc' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/473ee20a845e798915dfd23ecbb4e8421f0cea64d5d62bc0006a9dfac9683dbc'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 18c6b0f1355b604822890e9d9f7c4fad.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.CWsZnPzgHtuc8VEJHfymnp.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.CWsZnPzgHtuc8VEJHfymnp.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/.dvc/cache/.N5uAccbxNxjcapjfTQfPCN.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/dvc-subrepo1/ipsum-subrepo1'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dvc-subrepo1.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore lorem-subrepo1.dvc dvc-subrepo1.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/lorem-subrepo2' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'lorem-subrepo2.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/feb2958c03ec4ddce04cc42a48c7e71078da4e138027fbf734ca2025945cc2b3' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/feb2958c03ec4ddce04cc42a48c7e71078da4e138027fbf734ca2025945cc2b3'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.bQx8gyGouitc6JeueAYR8B.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.bQx8gyGouitc6JeueAYR8B.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/cache/.QRiirhAmkwjWTYmWZCSS5M.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/lorem-subrepo2'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'lorem-subrepo2.dvc'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/dvc-subrepo2' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object d57fb6e19d2ac1a2c135329778adaeed.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dvc-subrepo2.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object d57fb6e19d2ac1a2c135329778adaeed.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/feb2958c03ec4ddce04cc42a48c7e71078da4e138027fbf734ca2025945cc2b3' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/feb2958c03ec4ddce04cc42a48c7e71078da4e138027fbf734ca2025945cc2b3'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object d57fb6e19d2ac1a2c135329778adaeed.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.mZbYiHks3RRJdNPtHSbQ3y.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.mZbYiHks3RRJdNPtHSbQ3y.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/.dvc/cache/.ETyC5aEJEQX7hgfRq8BX43.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo2/dvc-subrepo2/ipsum-subrepo2'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dvc-subrepo2.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dvc-subrepo2.dvc lorem-subrepo2.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/lorem-subrepo3' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'lorem-subrepo3.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/6e8004a8c80b059883fa94a9ad21e0bc3e6c67f53640b3b482f6654db2cc97ce' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/6e8004a8c80b059883fa94a9ad21e0bc3e6c67f53640b3b482f6654db2cc97ce'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.DGytdFAzmizEoJFtx4wdQY.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.DGytdFAzmizEoJFtx4wdQY.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/cache/.imDz8nzdZZJ7ZdiXorndYG.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/lorem-subrepo3'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'lorem-subrepo3.dvc'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/dvc-subrepo3' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object f45ad0ac42134c36aea67c91c12a8067.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dvc-subrepo3.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object f45ad0ac42134c36aea67c91c12a8067.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/6e8004a8c80b059883fa94a9ad21e0bc3e6c67f53640b3b482f6654db2cc97ce' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/6e8004a8c80b059883fa94a9ad21e0bc3e6c67f53640b3b482f6654db2cc97ce'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object f45ad0ac42134c36aea67c91c12a8067.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.URWcWyGnLQzU6cQXpxompa.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.URWcWyGnLQzU6cQXpxompa.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/.dvc/cache/.fjrpzDz8kr5aMbmYYzR6cb.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/subrepo1/subrepo3/dvc-subrepo3/ipsum-subrepo3'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dvc-subrepo3.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dvc-subrepo3.dvc lorem-subrepo3.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/lorem-test_walk_nested_subrepos_Fals0' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'lorem-test_walk_nested_subrepos_Fals0.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/9f653e280fd7f577509c99dec9e25f152a3c0513103a05d604645d1a28aa6459' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/9f653e280fd7f577509c99dec9e25f152a3c0513103a05d604645d1a28aa6459'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/.LKyJSFb7BM6QRVKfcBQaQD.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/.LKyJSFb7BM6QRVKfcBQaQD.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/.dvc/cache/.ceFMRfjXmDCM3SKwqKbrf2.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/lorem-test_walk_nested_subrepos_Fals0'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'lorem-test_walk_nested_subrepos_Fals0.dvc'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/dvc-test_walk_nested_subrepos_Fals0' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object d5b81865df474e8f6151b41a8570624b.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'dvc-test_walk_nested_subrepos_Fals0.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object d5b81865df474e8f6151b41a8570624b.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/9f653e280fd7f577509c99dec9e25f152a3c0513103a05d604645d1a28aa6459' to '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/9f653e280fd7f577509c99dec9e25f152a3c0513103a05d604645d1a28aa6459'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object d5b81865df474e8f6151b41a8570624b.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/.NSRxUcZtY78p2uEBBRh5dF.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/.NSRxUcZtY78p2uEBBRh5dF.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/.dvc/cache/.Cum4wn2W7Bnqi3LHnZhHxY.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_walk_nested_subrepos_Fals0/dvc-test_walk_nested_subrepos_Fals0/ipsum-test_walk_nested_subrepos_Fals0'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'dvc-test_walk_nested_subrepos_Fals0.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore dvc-test_walk_nested_subrepos_Fals0.dvc lorem-test_walk_nested_subrepos_Fals0.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
________________ test_info_dvc_tracked_file[data/raw/raw-1.csv] ________________

dvcfs = <dvc.fs.dvc.DVCFileSystem object at 0x14a9a32e7640>
path = 'data/raw/raw-1.csv'

    @pytest.mark.parametrize(
        "path",
        [
            "data/raw/raw-1.csv",
            "data/raw/raw-2.csv",
            "data/processed/processed-1.csv",
            "data/processed/processed-2.csv",
            "models/transform.pickle",
        ],
    )
    def test_info_dvc_tracked_file(dvcfs, path):
>       info = dvcfs.info(path)

/home/user/dvc/tests/unit/fs/test_dvc_info.py:79: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:467: in info
    return self.fs.info(path, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:330: in info
    return self._info(key, path, ignore_subrepos=ignore_subrepos)
/home/user/dvc/dvc/fs/dvc.py:340: in _info
    dvc_info = dvc_fs.fs.index.info(subkey)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:413: in info
    entry = self[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:464: in __getitem__
    self._load(dir_key, dir_entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14aa8f70bbe0>
key = ('data',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
---------------------------- Captured stdout setup -----------------------------
2023-05-16 00:54:34,201 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/data' to gitignore file.
2023-05-16 00:54:34,771 DEBUG: built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
2023-05-16 00:54:34,789 DEBUG: Computed stage: 'data.dvc' md5: 'None'
2023-05-16 00:54:35,242 DEBUG: built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
2023-05-16 00:54:35,260 DEBUG: Preparing to transfer data from 'memory://dvc-staging/451b3b948541f7265e2c31435cf1673bfeceb18e073030cd34a8b9cfa34565a3' to '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/.dvc/cache'
2023-05-16 00:54:35,274 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/.dvc/cache'
2023-05-16 00:54:35,318 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/.dvc/cache'
2023-05-16 00:54:35,591 DEBUG: Preparing to collect status from 'memory://dvc-staging/451b3b948541f7265e2c31435cf1673bfeceb18e073030cd34a8b9cfa34565a3'
2023-05-16 00:54:36,547 DEBUG: built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
2023-05-16 00:54:36,608 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:54:36,623 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/.JihWMGwqwFjLQyovgoGZso.tmp'
2023-05-16 00:54:36,670 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/.JihWMGwqwFjLQyovgoGZso.tmp'
2023-05-16 00:54:36,686 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/.dvc/cache/.VTMoU5meirEpsxjoKTf8ie.tmp'
2023-05-16 00:54:36,707 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/data/processed/processed-2.csv'
2023-05-16 00:54:36,785 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/data/processed/processed-1.csv'
2023-05-16 00:54:36,869 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/data/raw/raw-2.csv'
2023-05-16 00:54:36,950 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/data/raw/raw-1.csv'
2023-05-16 00:54:37,230 DEBUG: Saving information to 'data.dvc'.
2023-05-16 00:54:37,473 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/models/transform.pickle' to gitignore file.
2023-05-16 00:54:37,585 DEBUG: Computed stage: 'models/transform.pickle.dvc' md5: 'None'
2023-05-16 00:54:37,760 DEBUG: Preparing to transfer data from 'memory://dvc-staging/451b3b948541f7265e2c31435cf1673bfeceb18e073030cd34a8b9cfa34565a3' to '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/.dvc/cache'
2023-05-16 00:54:37,774 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/.dvc/cache'
2023-05-16 00:54:37,786 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/.dvc/cache'
2023-05-16 00:54:37,900 DEBUG: Preparing to collect status from 'memory://dvc-staging/451b3b948541f7265e2c31435cf1673bfeceb18e073030cd34a8b9cfa34565a3'
2023-05-16 00:54:38,153 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:54:38,167 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/models/.AfWG3mGCEMRLknb4mLaNcY.tmp'
2023-05-16 00:54:38,213 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/models/.AfWG3mGCEMRLknb4mLaNcY.tmp'
2023-05-16 00:54:38,230 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/.dvc/cache/.SryToE5tsdGCocdq4W5ujn.tmp'
2023-05-16 00:54:38,250 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/models/transform.pickle'
2023-05-16 00:54:38,435 DEBUG: Saving information to 'models/transform.pickle.dvc'.

To track the changes with git, run:

	git add .gitignore models/.gitignore data.dvc models/transform.pickle.dvc

To enable auto staging, run:

	dvc config core.autostage true
---------------------------- Captured stderr setup -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.66file/s]Collecting targets          |2.00 [00:00,  4.37file/s]                                                      !  0% Adding...|          |0/2 [00:00<?,     ?file/s]
![A
Building data objects from data          |0.00 [00:00,      ?obj/s][A
Building data objects from data          |2.00 [00:00,   17.1obj/s][A
Building data objects from data          |4.00 [00:00,   14.3obj/s][A
                                                                   [A
![A
Building data objects from data          |0.00 [00:00,      ?obj/s][A
Building data objects from data          |4.00 [00:00,   35.4obj/s][A
                                                                   [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
100% |██████████|5/5 [00:00<00:00, 45.63files/s][A
                                                [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/4 [00:00<?,     ?file/s][A
  0%|          |Transferring                      4/? [00:00<00:00, 21.74file/s][A
  0%|          |Transferring                      4/? [00:00<00:00, 21.74file/s][A

![A[A

  0%|          |memory://.FLFNPxCLQQf2Lj648jPEU6.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.FLFNPxCLQQf2Lj648jPEU6.0.00/316 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from data          |0.00 [00:00,      ?obj/s][A
Building data objects from data          |4.00 [00:00,   36.8obj/s][A
                                                                   [A 50% Adding...|█████     | data |1/2 [00:03<00:03,  3.28s/file]
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
                                                                                [A100% |██████████| models/transform.pickle |2/2 [00:04<00:00,  2.05s/file]100% Adding...|██████████|2/2 [00:04,  2.25s/file]                       
------------------------------ Captured log setup ------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/data' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'data.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/451b3b948541f7265e2c31435cf1673bfeceb18e073030cd34a8b9cfa34565a3' to '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/451b3b948541f7265e2c31435cf1673bfeceb18e073030cd34a8b9cfa34565a3'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/.JihWMGwqwFjLQyovgoGZso.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/.JihWMGwqwFjLQyovgoGZso.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/.dvc/cache/.VTMoU5meirEpsxjoKTf8ie.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/data/processed/processed-2.csv'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/data/processed/processed-1.csv'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/data/raw/raw-2.csv'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/data/raw/raw-1.csv'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'data.dvc'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/models/transform.pickle' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'models/transform.pickle.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/451b3b948541f7265e2c31435cf1673bfeceb18e073030cd34a8b9cfa34565a3' to '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/451b3b948541f7265e2c31435cf1673bfeceb18e073030cd34a8b9cfa34565a3'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/models/.AfWG3mGCEMRLknb4mLaNcY.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/models/.AfWG3mGCEMRLknb4mLaNcY.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/.dvc/cache/.SryToE5tsdGCocdq4W5ujn.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat0/models/transform.pickle'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'models/transform.pickle.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore models/.gitignore data.dvc models/transform.pickle.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
________________ test_info_dvc_tracked_file[data/raw/raw-2.csv] ________________

dvcfs = <dvc.fs.dvc.DVCFileSystem object at 0x14a988ba8b40>
path = 'data/raw/raw-2.csv'

    @pytest.mark.parametrize(
        "path",
        [
            "data/raw/raw-1.csv",
            "data/raw/raw-2.csv",
            "data/processed/processed-1.csv",
            "data/processed/processed-2.csv",
            "models/transform.pickle",
        ],
    )
    def test_info_dvc_tracked_file(dvcfs, path):
>       info = dvcfs.info(path)

/home/user/dvc/tests/unit/fs/test_dvc_info.py:79: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:467: in info
    return self.fs.info(path, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:330: in info
    return self._info(key, path, ignore_subrepos=ignore_subrepos)
/home/user/dvc/dvc/fs/dvc.py:340: in _info
    dvc_info = dvc_fs.fs.index.info(subkey)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:413: in info
    entry = self[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:464: in __getitem__
    self._load(dir_key, dir_entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14a9a60ec2d0>
key = ('data',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
---------------------------- Captured stdout setup -----------------------------
2023-05-16 00:54:52,371 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/data' to gitignore file.
2023-05-16 00:54:52,941 DEBUG: built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
2023-05-16 00:54:52,959 DEBUG: Computed stage: 'data.dvc' md5: 'None'
2023-05-16 00:54:53,427 DEBUG: built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
2023-05-16 00:54:53,445 DEBUG: Preparing to transfer data from 'memory://dvc-staging/b7c9a7352fba1c14a1f9cb772118b9b75cf708c116a0619b462d5877b12228b5' to '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/.dvc/cache'
2023-05-16 00:54:53,457 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/.dvc/cache'
2023-05-16 00:54:53,495 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/.dvc/cache'
2023-05-16 00:54:53,703 DEBUG: Preparing to collect status from 'memory://dvc-staging/b7c9a7352fba1c14a1f9cb772118b9b75cf708c116a0619b462d5877b12228b5'
2023-05-16 00:54:54,670 DEBUG: built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
2023-05-16 00:54:54,730 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:54:54,748 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/.7AmiCp5fxXF79VvKZhVPUz.tmp'
2023-05-16 00:54:54,796 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/.7AmiCp5fxXF79VvKZhVPUz.tmp'
2023-05-16 00:54:54,814 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/.dvc/cache/.jpwtywY2FfhaSucXgZL2d9.tmp'
2023-05-16 00:54:54,835 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/data/processed/processed-2.csv'
2023-05-16 00:54:54,920 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/data/processed/processed-1.csv'
2023-05-16 00:54:55,005 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/data/raw/raw-2.csv'
2023-05-16 00:54:55,088 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/data/raw/raw-1.csv'
2023-05-16 00:54:55,375 DEBUG: Saving information to 'data.dvc'.
2023-05-16 00:54:55,625 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/models/transform.pickle' to gitignore file.
2023-05-16 00:54:55,736 DEBUG: Computed stage: 'models/transform.pickle.dvc' md5: 'None'
2023-05-16 00:54:55,885 DEBUG: Preparing to transfer data from 'memory://dvc-staging/b7c9a7352fba1c14a1f9cb772118b9b75cf708c116a0619b462d5877b12228b5' to '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/.dvc/cache'
2023-05-16 00:54:55,903 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/.dvc/cache'
2023-05-16 00:54:55,916 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/.dvc/cache'
2023-05-16 00:54:56,026 DEBUG: Preparing to collect status from 'memory://dvc-staging/b7c9a7352fba1c14a1f9cb772118b9b75cf708c116a0619b462d5877b12228b5'
2023-05-16 00:54:56,278 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:54:56,291 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/models/.aE7BbZhttFqGG8oU6CKP5B.tmp'
2023-05-16 00:54:56,362 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/models/.aE7BbZhttFqGG8oU6CKP5B.tmp'
2023-05-16 00:54:56,377 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/.dvc/cache/.6eZyDp9EkYqykNKtzBHKEo.tmp'
2023-05-16 00:54:56,398 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/models/transform.pickle'
2023-05-16 00:54:56,575 DEBUG: Saving information to 'models/transform.pickle.dvc'.

To track the changes with git, run:

	git add .gitignore models/.gitignore data.dvc models/transform.pickle.dvc

To enable auto staging, run:

	dvc config core.autostage true
---------------------------- Captured stderr setup -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.47file/s]Collecting targets          |2.00 [00:00,  4.67file/s]                                                      !  0% Adding...|          |0/2 [00:00<?,     ?file/s]
![A
Building data objects from data          |0.00 [00:00,      ?obj/s][A
Building data objects from data          |2.00 [00:00,   17.5obj/s][A
Building data objects from data          |4.00 [00:00,   14.6obj/s][A
                                                                   [A
![A
Building data objects from data          |0.00 [00:00,      ?obj/s][A
Building data objects from data          |4.00 [00:00,   37.9obj/s][A
                                                                   [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
100% |██████████|5/5 [00:00<00:00, 44.08files/s][A
                                                [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/4 [00:00<?,     ?file/s][A
  0%|          |Transferring                      4/? [00:00<00:00, 22.04file/s][A
  0%|          |Transferring                      4/? [00:00<00:00, 22.04file/s][A

![A[A

  0%|          |memory://.bvMytdqCXMMhSwAZbWg4AS.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.bvMytdqCXMMhSwAZbWg4AS.0.00/316 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from data          |0.00 [00:00,      ?obj/s][A
Building data objects from data          |4.00 [00:00,   36.0obj/s][A
                                                                   [A 50% Adding...|█████     | data |1/2 [00:03<00:03,  3.26s/file]
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
                                                                                [A100% |██████████| models/transform.pickle |2/2 [00:04<00:00,  2.04s/file]100% Adding...|██████████|2/2 [00:04,  2.24s/file]                       
------------------------------ Captured log setup ------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/data' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'data.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/b7c9a7352fba1c14a1f9cb772118b9b75cf708c116a0619b462d5877b12228b5' to '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/b7c9a7352fba1c14a1f9cb772118b9b75cf708c116a0619b462d5877b12228b5'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/.7AmiCp5fxXF79VvKZhVPUz.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/.7AmiCp5fxXF79VvKZhVPUz.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/.dvc/cache/.jpwtywY2FfhaSucXgZL2d9.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/data/processed/processed-2.csv'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/data/processed/processed-1.csv'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/data/raw/raw-2.csv'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/data/raw/raw-1.csv'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'data.dvc'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/models/transform.pickle' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'models/transform.pickle.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/b7c9a7352fba1c14a1f9cb772118b9b75cf708c116a0619b462d5877b12228b5' to '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/b7c9a7352fba1c14a1f9cb772118b9b75cf708c116a0619b462d5877b12228b5'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/models/.aE7BbZhttFqGG8oU6CKP5B.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/models/.aE7BbZhttFqGG8oU6CKP5B.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/.dvc/cache/.6eZyDp9EkYqykNKtzBHKEo.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat1/models/transform.pickle'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'models/transform.pickle.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore models/.gitignore data.dvc models/transform.pickle.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
__________ test_info_dvc_tracked_file[data/processed/processed-1.csv] __________

dvcfs = <dvc.fs.dvc.DVCFileSystem object at 0x14aa924fc230>
path = 'data/processed/processed-1.csv'

    @pytest.mark.parametrize(
        "path",
        [
            "data/raw/raw-1.csv",
            "data/raw/raw-2.csv",
            "data/processed/processed-1.csv",
            "data/processed/processed-2.csv",
            "models/transform.pickle",
        ],
    )
    def test_info_dvc_tracked_file(dvcfs, path):
>       info = dvcfs.info(path)

/home/user/dvc/tests/unit/fs/test_dvc_info.py:79: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:467: in info
    return self.fs.info(path, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:330: in info
    return self._info(key, path, ignore_subrepos=ignore_subrepos)
/home/user/dvc/dvc/fs/dvc.py:340: in _info
    dvc_info = dvc_fs.fs.index.info(subkey)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:413: in info
    entry = self[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:464: in __getitem__
    self._load(dir_key, dir_entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14aa85ceefa0>
key = ('data',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
---------------------------- Captured stdout setup -----------------------------
2023-05-16 00:55:10,383 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/data' to gitignore file.
2023-05-16 00:55:10,967 DEBUG: built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
2023-05-16 00:55:10,981 DEBUG: Computed stage: 'data.dvc' md5: 'None'
2023-05-16 00:55:11,426 DEBUG: built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
2023-05-16 00:55:11,444 DEBUG: Preparing to transfer data from 'memory://dvc-staging/9a2825b4ff74efbd3b30ab41a34ca6d6f8a5e003a4e6fdad1b772d82f6d61a98' to '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/.dvc/cache'
2023-05-16 00:55:11,458 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/.dvc/cache'
2023-05-16 00:55:11,501 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/.dvc/cache'
2023-05-16 00:55:11,712 DEBUG: Preparing to collect status from 'memory://dvc-staging/9a2825b4ff74efbd3b30ab41a34ca6d6f8a5e003a4e6fdad1b772d82f6d61a98'
2023-05-16 00:55:12,670 DEBUG: built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
2023-05-16 00:55:12,730 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:55:12,744 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/.Uh9ab4mxJhxn5ZxJTBkX6X.tmp'
2023-05-16 00:55:12,794 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/.Uh9ab4mxJhxn5ZxJTBkX6X.tmp'
2023-05-16 00:55:12,810 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/.dvc/cache/.kcUqSqSD4BiqmUUCHzRh82.tmp'
2023-05-16 00:55:12,831 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/data/processed/processed-2.csv'
2023-05-16 00:55:12,909 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/data/processed/processed-1.csv'
2023-05-16 00:55:12,989 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/data/raw/raw-2.csv'
2023-05-16 00:55:13,069 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/data/raw/raw-1.csv'
2023-05-16 00:55:13,333 DEBUG: Saving information to 'data.dvc'.
2023-05-16 00:55:13,577 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/models/transform.pickle' to gitignore file.
2023-05-16 00:55:13,691 DEBUG: Computed stage: 'models/transform.pickle.dvc' md5: 'None'
2023-05-16 00:55:13,842 DEBUG: Preparing to transfer data from 'memory://dvc-staging/9a2825b4ff74efbd3b30ab41a34ca6d6f8a5e003a4e6fdad1b772d82f6d61a98' to '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/.dvc/cache'
2023-05-16 00:55:13,868 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/.dvc/cache'
2023-05-16 00:55:13,883 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/.dvc/cache'
2023-05-16 00:55:14,007 DEBUG: Preparing to collect status from 'memory://dvc-staging/9a2825b4ff74efbd3b30ab41a34ca6d6f8a5e003a4e6fdad1b772d82f6d61a98'
2023-05-16 00:55:14,270 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:55:14,318 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/models/.fhFXwuVaSeF5n3vjbLQGNZ.tmp'
2023-05-16 00:55:14,366 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/models/.fhFXwuVaSeF5n3vjbLQGNZ.tmp'
2023-05-16 00:55:14,381 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/.dvc/cache/.fCSfdKXeJ3nDgJVSbwoNZ4.tmp'
2023-05-16 00:55:14,401 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/models/transform.pickle'
2023-05-16 00:55:14,585 DEBUG: Saving information to 'models/transform.pickle.dvc'.

To track the changes with git, run:

	git add .gitignore models/.gitignore data.dvc models/transform.pickle.dvc

To enable auto staging, run:

	dvc config core.autostage true
---------------------------- Captured stderr setup -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.51file/s]Collecting targets          |2.00 [00:00,  4.67file/s]                                                      !  0% Adding...|          |0/2 [00:00<?,     ?file/s]
![A
Building data objects from data          |0.00 [00:00,      ?obj/s][A
Building data objects from data          |2.00 [00:00,   17.2obj/s][A
Building data objects from data          |4.00 [00:00,   13.0obj/s][A
                                                                   [A
![A
Building data objects from data          |0.00 [00:00,      ?obj/s][A
Building data objects from data          |4.00 [00:00,   34.2obj/s][A
                                                                   [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
100% |██████████|5/5 [00:00<00:00, 45.03files/s][A
                                                [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/4 [00:00<?,     ?file/s][A
  0%|          |Transferring                      4/? [00:00<00:00, 21.85file/s][A
  0%|          |Transferring                      4/? [00:00<00:00, 21.85file/s][A

![A[A

  0%|          |memory://.9RNBgwYF5CZpDRGJ5FRrjm.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.9RNBgwYF5CZpDRGJ5FRrjm.0.00/316 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from data          |0.00 [00:00,      ?obj/s][A
Building data objects from data          |4.00 [00:00,   36.8obj/s][A
                                                                   [A 50% Adding...|█████     | data |1/2 [00:03<00:03,  3.21s/file]
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
                                                                                [A100% |██████████| models/transform.pickle |2/2 [00:04<00:00,  2.05s/file]100% Adding...|██████████|2/2 [00:04,  2.24s/file]                       
------------------------------ Captured log setup ------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/data' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'data.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/9a2825b4ff74efbd3b30ab41a34ca6d6f8a5e003a4e6fdad1b772d82f6d61a98' to '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/9a2825b4ff74efbd3b30ab41a34ca6d6f8a5e003a4e6fdad1b772d82f6d61a98'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/.Uh9ab4mxJhxn5ZxJTBkX6X.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/.Uh9ab4mxJhxn5ZxJTBkX6X.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/.dvc/cache/.kcUqSqSD4BiqmUUCHzRh82.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/data/processed/processed-2.csv'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/data/processed/processed-1.csv'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/data/raw/raw-2.csv'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/data/raw/raw-1.csv'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'data.dvc'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/models/transform.pickle' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'models/transform.pickle.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/9a2825b4ff74efbd3b30ab41a34ca6d6f8a5e003a4e6fdad1b772d82f6d61a98' to '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/9a2825b4ff74efbd3b30ab41a34ca6d6f8a5e003a4e6fdad1b772d82f6d61a98'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/models/.fhFXwuVaSeF5n3vjbLQGNZ.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/models/.fhFXwuVaSeF5n3vjbLQGNZ.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/.dvc/cache/.fCSfdKXeJ3nDgJVSbwoNZ4.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat2/models/transform.pickle'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'models/transform.pickle.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore models/.gitignore data.dvc models/transform.pickle.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
__________ test_info_dvc_tracked_file[data/processed/processed-2.csv] __________

dvcfs = <dvc.fs.dvc.DVCFileSystem object at 0x14a9f3460460>
path = 'data/processed/processed-2.csv'

    @pytest.mark.parametrize(
        "path",
        [
            "data/raw/raw-1.csv",
            "data/raw/raw-2.csv",
            "data/processed/processed-1.csv",
            "data/processed/processed-2.csv",
            "models/transform.pickle",
        ],
    )
    def test_info_dvc_tracked_file(dvcfs, path):
>       info = dvcfs.info(path)

/home/user/dvc/tests/unit/fs/test_dvc_info.py:79: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:467: in info
    return self.fs.info(path, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:330: in info
    return self._info(key, path, ignore_subrepos=ignore_subrepos)
/home/user/dvc/dvc/fs/dvc.py:340: in _info
    dvc_info = dvc_fs.fs.index.info(subkey)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:413: in info
    entry = self[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:464: in __getitem__
    self._load(dir_key, dir_entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14a9e4b75500>
key = ('data',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
---------------------------- Captured stdout setup -----------------------------
2023-05-16 00:55:30,653 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/data' to gitignore file.
2023-05-16 00:55:31,210 DEBUG: built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
2023-05-16 00:55:31,226 DEBUG: Computed stage: 'data.dvc' md5: 'None'
2023-05-16 00:55:31,665 DEBUG: built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
2023-05-16 00:55:31,684 DEBUG: Preparing to transfer data from 'memory://dvc-staging/1373045ed0fb9322b26c640c7847a1b7d74672d22ce23b471f7b5c4ae6f260a5' to '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/.dvc/cache'
2023-05-16 00:55:31,698 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/.dvc/cache'
2023-05-16 00:55:31,741 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/.dvc/cache'
2023-05-16 00:55:31,955 DEBUG: Preparing to collect status from 'memory://dvc-staging/1373045ed0fb9322b26c640c7847a1b7d74672d22ce23b471f7b5c4ae6f260a5'
2023-05-16 00:55:32,939 DEBUG: built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
2023-05-16 00:55:33,003 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:55:33,016 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/.MNS7KaF4NNvhAPkMs5FADt.tmp'
2023-05-16 00:55:33,063 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/.MNS7KaF4NNvhAPkMs5FADt.tmp'
2023-05-16 00:55:33,079 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/.dvc/cache/.iKNpqHJAuXdgucEQpc7yUu.tmp'
2023-05-16 00:55:33,099 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/data/processed/processed-2.csv'
2023-05-16 00:55:33,178 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/data/processed/processed-1.csv'
2023-05-16 00:55:33,258 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/data/raw/raw-2.csv'
2023-05-16 00:55:33,338 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/data/raw/raw-1.csv'
2023-05-16 00:55:33,605 DEBUG: Saving information to 'data.dvc'.
2023-05-16 00:55:33,841 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/models/transform.pickle' to gitignore file.
2023-05-16 00:55:33,950 DEBUG: Computed stage: 'models/transform.pickle.dvc' md5: 'None'
2023-05-16 00:55:34,100 DEBUG: Preparing to transfer data from 'memory://dvc-staging/1373045ed0fb9322b26c640c7847a1b7d74672d22ce23b471f7b5c4ae6f260a5' to '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/.dvc/cache'
2023-05-16 00:55:34,113 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/.dvc/cache'
2023-05-16 00:55:34,126 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/.dvc/cache'
2023-05-16 00:55:34,240 DEBUG: Preparing to collect status from 'memory://dvc-staging/1373045ed0fb9322b26c640c7847a1b7d74672d22ce23b471f7b5c4ae6f260a5'
2023-05-16 00:55:34,504 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:55:34,518 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/models/.en6NuMYagupDe8XK9QEMfz.tmp'
2023-05-16 00:55:34,563 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/models/.en6NuMYagupDe8XK9QEMfz.tmp'
2023-05-16 00:55:34,583 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/.dvc/cache/.WGBZj34MFM9sSxd8PEbFK8.tmp'
2023-05-16 00:55:34,603 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/models/transform.pickle'
2023-05-16 00:55:34,787 DEBUG: Saving information to 'models/transform.pickle.dvc'.

To track the changes with git, run:

	git add .gitignore models/.gitignore data.dvc models/transform.pickle.dvc

To enable auto staging, run:

	dvc config core.autostage true
---------------------------- Captured stderr setup -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.57file/s]Collecting targets          |2.00 [00:00,  4.65file/s]                                                      !  0% Adding...|          |0/2 [00:00<?,     ?file/s]
![A
Building data objects from data          |0.00 [00:00,      ?obj/s][A
Building data objects from data          |2.00 [00:00,   17.6obj/s][A
Building data objects from data          |4.00 [00:00,   14.8obj/s][A
                                                                   [A
![A
Building data objects from data          |0.00 [00:00,      ?obj/s][A
Building data objects from data          |4.00 [00:00,   34.8obj/s][A
                                                                   [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
100% |██████████|5/5 [00:00<00:00, 44.40files/s][A
                                                [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/4 [00:00<?,     ?file/s][A
  0%|          |Transferring                      4/? [00:00<00:00, 19.05file/s][A
  0%|          |Transferring                      4/? [00:00<00:00, 19.05file/s][A

![A[A

  0%|          |memory://.WpNnur9mciwaxzSPFUKDHj.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.WpNnur9mciwaxzSPFUKDHj.0.00/316 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from data          |0.00 [00:00,      ?obj/s][A
Building data objects from data          |4.00 [00:00,   36.7obj/s][A
                                                                   [A 50% Adding...|█████     | data |1/2 [00:03<00:03,  3.20s/file]
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
                                                                                [A100% |██████████| models/transform.pickle |2/2 [00:04<00:00,  2.01s/file]100% Adding...|██████████|2/2 [00:04,  2.20s/file]                       
------------------------------ Captured log setup ------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/data' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'data.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/1373045ed0fb9322b26c640c7847a1b7d74672d22ce23b471f7b5c4ae6f260a5' to '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/1373045ed0fb9322b26c640c7847a1b7d74672d22ce23b471f7b5c4ae6f260a5'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/.MNS7KaF4NNvhAPkMs5FADt.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/.MNS7KaF4NNvhAPkMs5FADt.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/.dvc/cache/.iKNpqHJAuXdgucEQpc7yUu.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/data/processed/processed-2.csv'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/data/processed/processed-1.csv'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/data/raw/raw-2.csv'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/data/raw/raw-1.csv'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'data.dvc'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/models/transform.pickle' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'models/transform.pickle.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/1373045ed0fb9322b26c640c7847a1b7d74672d22ce23b471f7b5c4ae6f260a5' to '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/1373045ed0fb9322b26c640c7847a1b7d74672d22ce23b471f7b5c4ae6f260a5'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/models/.en6NuMYagupDe8XK9QEMfz.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/models/.en6NuMYagupDe8XK9QEMfz.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/.dvc/cache/.WGBZj34MFM9sSxd8PEbFK8.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_tracked_file_dat3/models/transform.pickle'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'models/transform.pickle.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore models/.gitignore data.dvc models/transform.pickle.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
______________________ test_info_dvc_only_dirs[data/raw] _______________________

dvcfs = <dvc.fs.dvc.DVCFileSystem object at 0x14a9a9bb9b40>, path = 'data/raw'

    @pytest.mark.parametrize(
        "path",
        [
            "data",
            "data/raw",
            "data/processed",
        ],
    )
    def test_info_dvc_only_dirs(dvcfs, path):
>       info = dvcfs.info(path)

/home/user/dvc/tests/unit/fs/test_dvc_info.py:116: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:467: in info
    return self.fs.info(path, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:330: in info
    return self._info(key, path, ignore_subrepos=ignore_subrepos)
/home/user/dvc/dvc/fs/dvc.py:340: in _info
    dvc_info = dvc_fs.fs.index.info(subkey)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:413: in info
    entry = self[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:464: in __getitem__
    self._load(dir_key, dir_entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14a940c8abe0>
key = ('data',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
---------------------------- Captured stdout setup -----------------------------
2023-05-16 00:57:27,609 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/data' to gitignore file.
2023-05-16 00:57:28,134 DEBUG: built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
2023-05-16 00:57:28,149 DEBUG: Computed stage: 'data.dvc' md5: 'None'
2023-05-16 00:57:28,560 DEBUG: built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
2023-05-16 00:57:28,577 DEBUG: Preparing to transfer data from 'memory://dvc-staging/6090f4e75cc5df96095d6f9aed57577ee89c1915dbe8f8195b177e0040398c41' to '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/.dvc/cache'
2023-05-16 00:57:28,589 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/.dvc/cache'
2023-05-16 00:57:28,629 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/.dvc/cache'
2023-05-16 00:57:28,788 DEBUG: Preparing to collect status from 'memory://dvc-staging/6090f4e75cc5df96095d6f9aed57577ee89c1915dbe8f8195b177e0040398c41'
2023-05-16 00:57:29,695 DEBUG: built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
2023-05-16 00:57:29,754 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:57:29,766 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/.cCbikQUPSikJG6xdvM49JC.tmp'
2023-05-16 00:57:29,810 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/.cCbikQUPSikJG6xdvM49JC.tmp'
2023-05-16 00:57:29,825 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/.dvc/cache/.6rEGX5caXKH6tm9LQMDhsZ.tmp'
2023-05-16 00:57:29,845 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/data/processed/processed-2.csv'
2023-05-16 00:57:29,917 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/data/processed/processed-1.csv'
2023-05-16 00:57:29,991 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/data/raw/raw-2.csv'
2023-05-16 00:57:30,064 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/data/raw/raw-1.csv'
2023-05-16 00:57:30,310 DEBUG: Saving information to 'data.dvc'.
2023-05-16 00:57:30,538 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/models/transform.pickle' to gitignore file.
2023-05-16 00:57:30,641 DEBUG: Computed stage: 'models/transform.pickle.dvc' md5: 'None'
2023-05-16 00:57:30,781 DEBUG: Preparing to transfer data from 'memory://dvc-staging/6090f4e75cc5df96095d6f9aed57577ee89c1915dbe8f8195b177e0040398c41' to '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/.dvc/cache'
2023-05-16 00:57:30,793 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/.dvc/cache'
2023-05-16 00:57:30,805 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/.dvc/cache'
2023-05-16 00:57:30,904 DEBUG: Preparing to collect status from 'memory://dvc-staging/6090f4e75cc5df96095d6f9aed57577ee89c1915dbe8f8195b177e0040398c41'
2023-05-16 00:57:31,131 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:57:31,173 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/models/.6vVTcLmC6brrKwc8RbWueh.tmp'
2023-05-16 00:57:31,216 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/models/.6vVTcLmC6brrKwc8RbWueh.tmp'
2023-05-16 00:57:31,231 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/.dvc/cache/.Ks4mDS6hUFxQwtrMpNxqEQ.tmp'
2023-05-16 00:57:31,250 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/models/transform.pickle'
2023-05-16 00:57:31,415 DEBUG: Saving information to 'models/transform.pickle.dvc'.

To track the changes with git, run:

	git add .gitignore models/.gitignore data.dvc models/transform.pickle.dvc

To enable auto staging, run:

	dvc config core.autostage true
---------------------------- Captured stderr setup -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  2.30file/s]Collecting targets          |2.00 [00:00,  3.23file/s]                                                      !  0% Adding...|          |0/2 [00:00<?,     ?file/s]
![A
Building data objects from data          |0.00 [00:00,      ?obj/s][A
Building data objects from data          |2.00 [00:00,   18.7obj/s][A
Building data objects from data          |4.00 [00:00,   14.5obj/s][A
                                                                   [A
![A
Building data objects from data          |0.00 [00:00,      ?obj/s][A
Building data objects from data          |4.00 [00:00,   35.5obj/s][A
                                                                   [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/4 [00:00<?,     ?file/s][A
  0%|          |Transferring                      4/? [00:00<00:00, 23.19file/s][A
  0%|          |Transferring                      4/? [00:00<00:00, 23.19file/s][A

![A[A

  0%|          |memory://.FPRAJm6HUQVWXDqoH6MhHS.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.FPRAJm6HUQVWXDqoH6MhHS.0.00/316 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from data          |0.00 [00:00,      ?obj/s][A
Building data objects from data          |4.00 [00:00,   38.9obj/s][A
                                                                   [A 50% Adding...|█████     | data |1/2 [00:02<00:02,  2.94s/file]
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
                                                                                [A100% |██████████| models/transform.pickle |2/2 [00:04<00:00,  1.85s/file]100% Adding...|██████████|2/2 [00:04,  2.03s/file]                       
------------------------------ Captured log setup ------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/data' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'data.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/6090f4e75cc5df96095d6f9aed57577ee89c1915dbe8f8195b177e0040398c41' to '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/6090f4e75cc5df96095d6f9aed57577ee89c1915dbe8f8195b177e0040398c41'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/.cCbikQUPSikJG6xdvM49JC.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/.cCbikQUPSikJG6xdvM49JC.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/.dvc/cache/.6rEGX5caXKH6tm9LQMDhsZ.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/data/processed/processed-2.csv'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/data/processed/processed-1.csv'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/data/raw/raw-2.csv'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/data/raw/raw-1.csv'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'data.dvc'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/models/transform.pickle' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'models/transform.pickle.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/6090f4e75cc5df96095d6f9aed57577ee89c1915dbe8f8195b177e0040398c41' to '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/6090f4e75cc5df96095d6f9aed57577ee89c1915dbe8f8195b177e0040398c41'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/models/.6vVTcLmC6brrKwc8RbWueh.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/models/.6vVTcLmC6brrKwc8RbWueh.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/.dvc/cache/.Ks4mDS6hUFxQwtrMpNxqEQ.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_r0/models/transform.pickle'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'models/transform.pickle.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore models/.gitignore data.dvc models/transform.pickle.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
___________________ test_info_dvc_only_dirs[data/processed] ____________________

dvcfs = <dvc.fs.dvc.DVCFileSystem object at 0x14a940c8a780>
path = 'data/processed'

    @pytest.mark.parametrize(
        "path",
        [
            "data",
            "data/raw",
            "data/processed",
        ],
    )
    def test_info_dvc_only_dirs(dvcfs, path):
>       info = dvcfs.info(path)

/home/user/dvc/tests/unit/fs/test_dvc_info.py:116: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_objects/fs/base.py:467: in info
    return self.fs.info(path, **kwargs)
/home/user/dvc/dvc/fs/dvc.py:330: in info
    return self._info(key, path, ignore_subrepos=ignore_subrepos)
/home/user/dvc/dvc/fs/dvc.py:340: in _info
    dvc_info = dvc_fs.fs.index.info(subkey)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:413: in info
    entry = self[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:464: in __getitem__
    self._load(dir_key, dir_entry)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:525: in _load
    del self._trie[key]
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/dvc_data/index/index.py:109: in __delitem__
    super().__delitem__(key)
/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/serialized.py:62: in __delitem__
    del self._trie[key]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <sqltrie.sqlite.sqlite.SQLiteTrie object at 0x14a93eaa8820>
key = ('data',)

    def __delitem__(self, key):
        node = self._get_node(key)
>       self._conn.execute(
            """
            UPDATE nodes SET has_value = False, value = NULL WHERE id == ?
            """,
            (node["id"],),
        )
E       sqlite3.OperationalError: no such column: False

/home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/sqltrie/sqlite/sqlite.py:214: OperationalError
---------------------------- Captured stdout setup -----------------------------
2023-05-16 00:57:45,216 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/data' to gitignore file.
2023-05-16 00:57:45,750 DEBUG: built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
2023-05-16 00:57:45,765 DEBUG: Computed stage: 'data.dvc' md5: 'None'
2023-05-16 00:57:46,163 DEBUG: built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
2023-05-16 00:57:46,181 DEBUG: Preparing to transfer data from 'memory://dvc-staging/37c1d8a2e0982867d6bf43c9baa2135626ffa9bcd4508388f5a83c4b2ffe1ac5' to '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/.dvc/cache'
2023-05-16 00:57:46,193 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/.dvc/cache'
2023-05-16 00:57:46,232 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/.dvc/cache'
2023-05-16 00:57:46,425 DEBUG: Preparing to collect status from 'memory://dvc-staging/37c1d8a2e0982867d6bf43c9baa2135626ffa9bcd4508388f5a83c4b2ffe1ac5'
2023-05-16 00:57:47,275 DEBUG: built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
2023-05-16 00:57:47,335 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:57:47,350 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/.LhZkz4cQFEfE6e8hKbDRL4.tmp'
2023-05-16 00:57:47,398 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/.LhZkz4cQFEfE6e8hKbDRL4.tmp'
2023-05-16 00:57:47,414 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/.dvc/cache/.HZhmugCSoSZ2Hi4qGuf8d4.tmp'
2023-05-16 00:57:47,436 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/data/processed/processed-2.csv'
2023-05-16 00:57:47,515 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/data/processed/processed-1.csv'
2023-05-16 00:57:47,593 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/data/raw/raw-2.csv'
2023-05-16 00:57:47,659 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/data/raw/raw-1.csv'
2023-05-16 00:57:47,901 DEBUG: Saving information to 'data.dvc'.
2023-05-16 00:57:48,105 DEBUG: Added '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/models/transform.pickle' to gitignore file.
2023-05-16 00:57:48,209 DEBUG: Computed stage: 'models/transform.pickle.dvc' md5: 'None'
2023-05-16 00:57:48,355 DEBUG: Preparing to transfer data from 'memory://dvc-staging/37c1d8a2e0982867d6bf43c9baa2135626ffa9bcd4508388f5a83c4b2ffe1ac5' to '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/.dvc/cache'
2023-05-16 00:57:48,367 DEBUG: Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/.dvc/cache'
2023-05-16 00:57:48,388 DEBUG: Collecting status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/.dvc/cache'
2023-05-16 00:57:48,487 DEBUG: Preparing to collect status from 'memory://dvc-staging/37c1d8a2e0982867d6bf43c9baa2135626ffa9bcd4508388f5a83c4b2ffe1ac5'
2023-05-16 00:57:48,707 DEBUG: link type reflink is not available ([Errno 95] no more link types left to try out)
2023-05-16 00:57:48,749 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/models/.4Cc7msP6uxedsW66WuDetS.tmp'
2023-05-16 00:57:48,792 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/models/.4Cc7msP6uxedsW66WuDetS.tmp'
2023-05-16 00:57:48,806 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/.dvc/cache/.mvm7AMBYvCR9s5iZFFYZpA.tmp'
2023-05-16 00:57:48,828 DEBUG: Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/models/transform.pickle'
2023-05-16 00:57:48,994 DEBUG: Saving information to 'models/transform.pickle.dvc'.

To track the changes with git, run:

	git add .gitignore models/.gitignore data.dvc models/transform.pickle.dvc

To enable auto staging, run:

	dvc config core.autostage true
---------------------------- Captured stderr setup -----------------------------
!If DVC froze, see `hardlink_lock` in <[36mhttps://man.dvc.org/config#core[39m>                                                                      !Collecting targets          |0.00 [00:00,     ?file/s]Collecting targets          |1.00 [00:00,  3.90file/s]Collecting targets          |2.00 [00:00,  4.58file/s]                                                      !  0% Adding...|          |0/2 [00:00<?,     ?file/s]
![A
Building data objects from data          |0.00 [00:00,      ?obj/s][A
Building data objects from data          |2.00 [00:00,   18.2obj/s][A
Building data objects from data          |4.00 [00:00,   16.0obj/s][A
                                                                   [A
![A
Building data objects from data          |0.00 [00:00,      ?obj/s][A
Building data objects from data          |4.00 [00:00,   37.8obj/s][A
                                                                   [A
![A
  0% |          |0/? [00:00<?,    ?files/s][A
100% |██████████|5/5 [00:00<00:00, 49.38files/s][A
                                                [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/4 [00:00<?,     ?file/s][A
  0%|          |Transferring                      4/? [00:00<00:00, 24.14file/s][A
  0%|          |Transferring                      4/? [00:00<00:00, 24.14file/s][A

  0%|          |memory://.n4w7nMAUzh9mMgtXLzmPwd.tm0.00/? [00:00<?,        ?B/s][A[A

  0%|          |memory://.n4w7nMAUzh9mMgtXLzmPwd.0.00/316 [00:00<?,        ?B/s][A[A

                                                                                [A[A
                                                                                [A
![A
Building data objects from data          |0.00 [00:00,      ?obj/s][A
                                                                   [A 50% Adding...|█████     | data |1/2 [00:02<00:02,  2.90s/file]
![A
  0% |          |0/? [00:00<?,    ?files/s][A
                                           [A
![A
  0%|          |Transferring                          0/? [00:00<?,     ?file/s][A
  0%|          |Transferring                          0/1 [00:00<?,     ?file/s][A
                                                                                [A100% |██████████| models/transform.pickle |2/2 [00:03<00:00,  1.84s/file]100% Adding...|██████████|2/2 [00:04,  2.01s/file]                       
------------------------------ Captured log setup ------------------------------
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/data' to gitignore file.
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'data.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/37c1d8a2e0982867d6bf43c9baa2135626ffa9bcd4508388f5a83c4b2ffe1ac5' to '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/37c1d8a2e0982867d6bf43c9baa2135626ffa9bcd4508388f5a83c4b2ffe1ac5'
DEBUG    dvc_data.hashfile.build:build.py:254 built tree 'object 696a6604edf05d5fe125bfbd9af52e8e.dir'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/.LhZkz4cQFEfE6e8hKbDRL4.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/.LhZkz4cQFEfE6e8hKbDRL4.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/.dvc/cache/.HZhmugCSoSZ2Hi4qGuf8d4.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/data/processed/processed-2.csv'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/data/processed/processed-1.csv'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/data/raw/raw-2.csv'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/data/raw/raw-1.csv'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'data.dvc'.
DEBUG    dvc.repo.scm_context:scm_context.py:82 Added '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/models/transform.pickle' to gitignore file.
DEBUG    dvc.stage:__init__.py:475 Computed stage: 'models/transform.pickle.dvc' md5: 'None'
DEBUG    dvc_data.hashfile.transfer:transfer.py:195 Preparing to transfer data from 'memory://dvc-staging/37c1d8a2e0982867d6bf43c9baa2135626ffa9bcd4508388f5a83c4b2ffe1ac5' to '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:131 Collecting status from '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/.dvc/cache'
DEBUG    dvc_data.hashfile.status:status.py:101 Preparing to collect status from 'memory://dvc-staging/37c1d8a2e0982867d6bf43c9baa2135626ffa9bcd4508388f5a83c4b2ffe1ac5'
DEBUG    dvc_objects.fs.generic:generic.py:352 link type reflink is not available ([Errno 95] no more link types left to try out)
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/models/.4Cc7msP6uxedsW66WuDetS.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/models/.4Cc7msP6uxedsW66WuDetS.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/.dvc/cache/.mvm7AMBYvCR9s5iZFFYZpA.tmp'
DEBUG    dvc_objects.fs.utils:utils.py:95 Removing '/tmp/pytest-of-user/pytest-384/test_info_dvc_only_dirs_data_p0/models/transform.pickle'
DEBUG    dvc.dvcfile:dvcfile.py:213 Saving information to 'models/transform.pickle.dvc'.
INFO     dvc.repo.scm_context:scm_context.py:131 
To track the changes with git, run:

	git add .gitignore models/.gitignore data.dvc models/transform.pickle.dvc
INFO     dvc.repo.scm_context:scm_context.py:132 
To enable auto staging, run:

	dvc config core.autostage true
=============================== warnings summary ===============================
tests/func/test_remove.py::test_cmd_remove_gitignore_multistage
tests/unit/fs/test_dvc_info.py::test_info_dvc_only_dirs[data/processed]
  /home/user/purepython/cpython-3.9/Lib/threading.py:980: TqdmSynchronisationWarning: Set changed size during iteration (see https://github.com/tqdm/tqdm/issues/481)
    self.run()

tests/unit/command/test_dag.py::test_dag[--dot-_show_dot]
tests/unit/command/test_dag.py::test_show_dot
tests/unit/command/test_dag.py::test_show_dot_properly_escapes
  <class 'networkx.utils.decorators.argmap'> compilation 13:5: PendingDeprecationWarning: nx.nx_pydot.write_dot depends on the pydot package, which hasknown issues and is not actively maintained. Consider usingnx.nx_agraph.write_dot instead.
  
  See https://github.com/networkx/networkx/issues/5723

tests/unit/command/test_dag.py::test_dag[--dot-_show_dot]
tests/unit/command/test_dag.py::test_show_dot
tests/unit/command/test_dag.py::test_show_dot_properly_escapes
  /home/user/purepython/cpython-3.9/my_purepy/lib/python3.9/site-packages/networkx/drawing/nx_pydot.py:51: PendingDeprecationWarning: nx.nx_pydot.to_pydot depends on the pydot package, which hasknown issues and is not actively maintained.
  
  See https://github.com/networkx/networkx/issues/5723
    P = to_pydot(G)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
===Flaky Test Report===

test_pull_git_imports[git_dir] passed 1 out of the required 1 times. Success!
test_pull_git_imports[erepo_dir] passed 1 out of the required 1 times. Success!

===End Flaky Test Report===
=========================== short test summary info ============================
SKIPPED [2] dvc/testing/workspace_tests.py:157: Skipped
SKIPPED [1] tests/func/test_add.py:588: Windows specific
SKIPPED [4] tests/func/utils/test_hydra.py:100: TOML dumper breaks when overriding a list/dict with other type or when handling `null` values.
SKIPPED [1] tests/unit/utils/test_fs.py:76: Windows specific
SKIPPED [1] tests/unit/utils/test_fs.py:135: Windows specific
SKIPPED [1] tests/unit/utils/test_utils.py:42: Windows specific
XFAIL tests/func/test_add.py::test_add_from_data_dir - error message relpath
XFAIL tests/func/test_checkout.py::test_checkout_stats_on_failure - values relpath
XPASS tests/func/test_data_cloud.py::TestRemote::test_stage_cache_push_pull 
XPASS tests/func/test_data_cloud.py::TestRemote::test_pull_00_prefix 
XPASS tests/func/test_data_cloud.py::TestRemote::test_pull_no_00_prefix 
FAILED tests/func/test_data_cloud.py::test_pull_external_dvc_imports - sqlite...
FAILED tests/func/test_data_status.py::test_directory - sqlite3.OperationalEr...
FAILED tests/func/test_data_status.py::test_tracked_directory_deep - sqlite3....
FAILED tests/func/test_data_status.py::test_unchanged - sqlite3.OperationalEr...
FAILED tests/func/test_data_status.py::test_subdir - sqlite3.OperationalError...
FAILED tests/func/test_data_status.py::test_partial_missing_cache - sqlite3.O...
FAILED tests/func/test_data_status.py::test_missing_dir_object_from_head - sq...
FAILED tests/func/test_data_status.py::test_missing_dir_object_from_index - s...
FAILED tests/func/test_data_status.py::test_missing_remote_cache - sqlite3.Op...
FAILED tests/func/test_data_status.py::test_root_from_dir_to_file - sqlite3.O...
FAILED tests/func/test_diff.py::test_directories - sqlite3.OperationalError: ...
FAILED tests/func/test_diff.py::test_diff_dirty - sqlite3.OperationalError: n...
FAILED tests/func/test_diff.py::test_diff_rename_folder[True] - sqlite3.Opera...
FAILED tests/func/test_diff.py::test_diff_rename_folder[False] - sqlite3.Oper...
FAILED tests/func/test_diff.py::test_diff_rename_file[True] - sqlite3.Operati...
FAILED tests/func/test_diff.py::test_diff_rename_file[False] - sqlite3.Operat...
FAILED tests/func/test_diff.py::test_rename_multiple_files_same_hashes - sqli...
FAILED tests/func/test_get.py::test_get_repo_dir - sqlite3.OperationalError: ...
FAILED tests/func/test_get.py::test_get_file_from_dir - sqlite3.OperationalEr...
FAILED tests/func/test_get.py::test_get_from_subrepos[files1-True] - sqlite3....
FAILED tests/func/test_get.py::test_granular_get_from_subrepos - sqlite3.Oper...
FAILED tests/func/test_get.py::test_get_complete_repo - sqlite3.OperationalEr...
FAILED tests/func/test_import.py::test_import_dir - sqlite3.OperationalError:...
FAILED tests/func/test_import.py::test_import_file_from_dir - sqlite3.Operati...
FAILED tests/func/test_import.py::test_import_file_from_dir_to_dir - sqlite3....
FAILED tests/func/test_import.py::test_pull_imported_directory_stage - sqlite...
FAILED tests/func/test_import.py::test_pull_wildcard_imported_directory_stage
FAILED tests/func/test_import.py::test_push_wildcard_from_bare_git_repo - sql...
FAILED tests/func/test_import.py::test_import_subrepos[files1-True] - sqlite3...
FAILED tests/func/test_import.py::test_granular_import_from_subrepos - sqlite...
FAILED tests/func/test_import.py::test_pull_imported_stage_from_subrepos[files1-True]
FAILED tests/func/test_import.py::test_import_complete_repo - sqlite3.Operati...
FAILED tests/func/test_import.py::test_import_with_jobs - sqlite3.Operational...
FAILED tests/func/test_import.py::test_chained_import - sqlite3.OperationalEr...
FAILED tests/func/test_import.py::test_circular_import - sqlite3.OperationalE...
FAILED tests/func/test_ls.py::test_ls_repo_with_new_path_dir - sqlite3.Operat...
FAILED tests/func/test_ls.py::test_ls_repo_with_path_dir_dvc_only_empty - sql...
FAILED tests/func/test_ls.py::test_ls_granular - sqlite3.OperationalError: no...
FAILED tests/func/test_ls.py::test_ls_target[False] - sqlite3.OperationalErro...
FAILED tests/func/test_ls.py::test_subrepo[True-erepo_dir] - sqlite3.Operatio...
FAILED tests/func/test_ls.py::test_subrepo[False-git_dir] - sqlite3.Operation...
FAILED tests/func/test_repo_index.py::test_view_granular_dir - sqlite3.Operat...
FAILED tests/func/test_update.py::test_update_import[True] - sqlite3.Operatio...
FAILED tests/func/plots/test_modify.py::test_dir_plots - KeyError: ['workspac...
FAILED tests/func/plots/test_show.py::test_dir_plots - AssertionError: assert...
FAILED tests/unit/fs/test_data.py::test_walk_dir - sqlite3.OperationalError: ...
FAILED tests/unit/fs/test_data.py::test_get_hash_granular - sqlite3.Operation...
FAILED tests/unit/fs/test_data.py::test_get_hash_dirty_dir - sqlite3.Operatio...
FAILED tests/unit/fs/test_dvc.py::test_exists_isdir_isfile_dirty - AssertionE...
FAILED tests/unit/fs/test_dvc.py::test_walk_dirty - sqlite3.OperationalError:...
FAILED tests/unit/fs/test_dvc.py::test_walk_dirty_cached_dir - sqlite3.Operat...
FAILED tests/unit/fs/test_dvc.py::test_isdvc - sqlite3.OperationalError: no s...
FAILED tests/unit/fs/test_dvc.py::test_subrepos - AssertionError: assert Fals...
FAILED tests/unit/fs/test_dvc.py::test_get_hash_cached_dir - sqlite3.Operatio...
FAILED tests/unit/fs/test_dvc.py::test_get_hash_cached_granular - sqlite3.Ope...
FAILED tests/unit/fs/test_dvc.py::test_get_hash_dirty_dir - sqlite3.Operation...
FAILED tests/unit/fs/test_dvc.py::test_walk_nested_subrepos[True] - sqlite3.O...
FAILED tests/unit/fs/test_dvc.py::test_walk_nested_subrepos[False] - sqlite3....
FAILED tests/unit/fs/test_dvc_info.py::test_info_dvc_tracked_file[data/raw/raw-1.csv]
FAILED tests/unit/fs/test_dvc_info.py::test_info_dvc_tracked_file[data/raw/raw-2.csv]
FAILED tests/unit/fs/test_dvc_info.py::test_info_dvc_tracked_file[data/processed/processed-1.csv]
FAILED tests/unit/fs/test_dvc_info.py::test_info_dvc_tracked_file[data/processed/processed-2.csv]
FAILED tests/unit/fs/test_dvc_info.py::test_info_dvc_only_dirs[data/raw] - sq...
FAILED tests/unit/fs/test_dvc_info.py::test_info_dvc_only_dirs[data/processed]
= 64 failed, 2294 passed, 10 skipped, 2 xfailed, 3 xpassed, 8 warnings in 13697.46s (3:48:17) =
Traceback (most recent call last):
  File "/home/user/thefuck-master/pre_run_biend.py", line 102, in <module>
    from lark import Lark
ModuleNotFoundError: No module named 'lark'
